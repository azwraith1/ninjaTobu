var __reflect=this&&this.__reflect||function(e,t,i){e.__class__=t,i?i.push(t):i=[t],e.__types__=e.__types__?i.concat(e.__types__):i},__extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);i.prototype=t.prototype,e.prototype=new i},__awaiter=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{l(n.next(e))}catch(t){o(t)}}function s(e){try{l(n["throw"](e))}catch(t){o(t)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(a,s)}l((n=n.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,o&&(a=o[2&i[0]?"return":i[0]?"throw":"next"])&&!(a=a.call(o,i[1])).done)return a;switch(o=0,a&&(i=[0,a.value]),i[0]){case 0:case 1:a=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!(a=a.length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){l.label=i[1];break}if(6===i[0]&&l.label<a[1]){l.label=a[1],a=i;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(i);break}a[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(n){i=[6,n],o=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,a,s,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},Mediator=function(){function e(){this.bInitView=!1,this.gameEventListenerMap=null}return e.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enterParameters=e,this.bInitView||this.initView(),this.bInitView=!0,this.onEnter.apply(this,this.enterParameters),this.gameEventListenerMap||(this.gameEventListenerMap={},this.addGameEventListener())},e.prototype.close=function(){for(var e in this.gameEventListenerMap){var t=this.gameEventListenerMap[e].type,i=this.gameEventListenerMap[e].listener,n=this.gameEventListenerMap[e].thisObject;ObserverManager.instance.removeEventListener(t,i,n)}this.gameEventListenerMap=null,this.onExit()},e.prototype.addEventListener=function(e,t,i){ObserverManager.instance.addEventListener(e,t,i),this.gameEventListenerMap[e]=new GameEventListenerData(e,t,i)},e.prototype.register=function(){this.gameEventListenerMap||(this.gameEventListenerMap={},this.addGameEventListener())},e.prototype.initView=function(){},e.prototype.onEnter=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},e.prototype.onExit=function(){},e.prototype.addGameEventListener=function(){},e}();__reflect(Mediator.prototype,"Mediator");var GameEventListenerData=function(){function e(e,t,i){this.type=e,this.listener=t,this.thisObject=i}return e}();__reflect(GameEventListenerData.prototype,"GameEventListenerData");var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.touchEnabled=!0,t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAdded,t),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.onRemoved,t),t}return __extends(t,e),t.prototype.onAdded=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},t.prototype.onRemoved=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this.destroy()},t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.parseGame=function(){this.execAllPauseFn(),this.execAllAutoTimeout()},t.prototype.remuseGame=function(){},t.prototype.onEnterFrame=function(e){},t.prototype.onTouchTap=function(e){e.stopPropagation()},t.prototype.changeLanguageUI=function(){},t.prototype.destroy=function(){},t.prototype.addPauseFn=function(e,t){},t.prototype.removePauseFn=function(e,t){},t.prototype.execAllPauseFn=function(){},t.prototype.onPause=function(){},t.prototype.setAutoTimeout=function(e,t,i){},t.prototype.clearAutoTimeout=function(e){},t.prototype.execAutoTimeout=function(e){},t.prototype.execAllAutoTimeout=function(){},t.prototype.clearAllAutoTimeout=function(){},t}(eui.Component);e.BaseUI=t,__reflect(t.prototype,"game.BaseUI")}(game||(game={}));var HashMap=function(){function e(){this.data={}}return e.prototype.set=function(e,t){this.data[e]=t},e.prototype.put=function(e,t){this.set(e,t)},e.prototype.get=function(e,t){return 1==arguments.length?this.data[e]:this.has(e)?this.data[e]:t},e.prototype.add=function(e,t){},e.prototype.has=function(e){return this.data.hasOwnProperty(e)},e.prototype.remove=function(e){this.data[e]=void 0,delete this.data[e]},e.prototype.clear=function(){this.data={}},e.prototype.keys=function(){var e=[];for(var t in this.data)e.push(t);return e},e.prototype.values=function(){var e=[];for(var t in this.data)e.push(this.data[t]);return e},e.prototype.reset=function(e){e&&(this.data=e.data||e)},e.prototype.parse=function(e){if(e){var t=JSON.parse(e);this.data=t}},e.prototype.toString=function(){return JSON.stringify(this.data)},e}();__reflect(HashMap.prototype,"HashMap");var ResetButtonUI=function(e){function t(t,i){var n=e.call(this)||this;return n.skinName="ResetButtonSkin",n.ima.source=t,n.text.text=i,n}return __extends(t,e),t}(eui.Component);__reflect(ResetButtonUI.prototype,"ResetButtonUI");var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,i,n){function r(e){t.call(n,e)}function o(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),i.call(n))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(e,r,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var Game=function(){function e(){}return e.prototype.initGameModule=function(){GlobalProxy.globalProxy=new GlobalProxy},e.prototype.initGameView=function(e){ViewManager.instance.init(e),ViewManager.instance.showLoading(1,100)},e.prototype.startGame=function(){ConfigManager.instance.load(),this.languageDict=RES.getRes("language_json"),RES.destroyRes("language_json"),ViewManager.instance.OPEN_WINDOW(SceneMediator),ViewManager.instance.OPEN_WINDOW(SelectMediator,!0),ViewManager.instance.hideLoading()},e.getLanguage=function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];if(!e.instance.languageDict)return t;for(var r="common",o=e.instance.languageDict[r]&&e.instance.languageDict[r][t]?e.instance.languageDict[r][t]:t,a=0,s=i.length;s>a;a++)o=o.replace(new RegExp("\\{"+a+"\\}","g"),i[a]);return o},e.getLoadingLanguage=function(e){return e+="_zh",window.loadingLanguage[e]},Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e}();__reflect(Game.prototype,"Game");var ObserverManager=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t.sendNotification=function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];t.instance.dispatchEventWith(e,!1,i)},t.registerMediator=function(e){var i=t.getMediator(e);if(!i){var n=egret.getQualifiedClassName(e),r=new e;r.register(),t._mediators[n]=r,i=r}return i},t.getMediator=function(e){var i=egret.getQualifiedClassName(e);return t._mediators.hasOwnProperty(i)?t._mediators[i]:null},t.registerCommand=function(e,i){return t._commands.hasOwnProperty(e)?void egret.error("registerCommand failed, "+e+" is exist! commandClass ="+i):void(t._commands[e]=new i)},t.getCommand=function(e){return t._commands.hasOwnProperty(e)?t._commands[e]:null},t._mediators={},t._commands={},t}(egret.EventDispatcher);__reflect(ObserverManager.prototype,"ObserverManager");var Main=function(e){function t(){var t=e.call(this)||this;return t.isThemeLoadEnd=!1,t.isResourceLoadEnd=!1,t.defaultResVersion=window.default_res,t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){this.runGame()["catch"](function(e){console.log(e)})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(i){switch(i.label){case 0:return[4,platform.login()];case 1:return i.sent(),[4,platform.getUserInfo()];case 2:return e=i.sent(),console.log(e),t=new AssetAdapter,egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json?"+this.defaultResVersion,"resource/"),Game.instance.initGameView(this),Game.instance.initGameModule(),[2]}})})},t.prototype.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/default.thm.json?"+this.defaultResVersion,this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},t.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},t.prototype.onResourceLoadComplete=function(e){"preload"==e.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},t.prototype.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&Game.instance.startGame()},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},t.prototype.onResourceProgress=function(e){"preload"==e.groupName&&ViewManager.instance.showLoading(e.itemsLoaded,e.itemsTotal)},t}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var SHCircle=function(){function e(e,t,i){this.x=e,this.y=t,this.r=i,this.vector=new SHVector(e,t);var n=new egret.Shape;n.graphics.beginFill(16711680,.2),n.graphics.drawCircle(0,0,i),n.graphics.endFill(),n.x=e,n.y=t,this.circle=n}return e}();__reflect(SHCircle.prototype,"SHCircle");var DBComponent=function(e){function t(t,i){void 0===i&&(i=!0);var n=e.call(this)||this;return n.autoPos=!0,n.autoPos=i,n.dnName=t,n.createDb(),n}return __extends(t,e),t.prototype.resetPosition=function(){this.armature&&(this.armature.x=this.width/2,this.armature.y=this.height/2)},t.prototype.onAddedCall=function(){this.autoPos&&this.armature&&(this.width=this.armature.width,this.height=this.armature.height)},t.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.onAddedCall()},t.prototype.createDb=function(){var e=DBFactory.instance.getDBAsync1(this.dnName);e&&(this.armature=e,this.addChild(e),this.armature.touchEnabled=!1,this.armature.addEventListener(egret.Event.COMPLETE,this.completeCall,this))},t.prototype.completeCall=function(){return this.callback?void this.callback():(this.stop(),void GameUtil.removeSelf(this))},t.prototype.play=function(e,t){void 0===e&&(e="default");try{this.currentName=e,this.visible=!0,this.armature.animation.play(e,t)}catch(i){}},t.prototype.play1=function(e,t){void 0===e&&(e="default"),this.armature&&(this.currentName=e,this.visible=!0,this.armature.animation.play(e,t))},t.prototype.gotoAndStop=function(e,t){void 0===e&&(e="default"),this.armature&&(this.currentName=e,this.visible=!0,this.armature.animation.gotoAndStop(e,1))},t.prototype.playByFilename=function(e){this.armature&&(this.currentName=this.dnName,this.visible=!0,this.armature.animation.play(this.currentName,e))},t.prototype.stop=function(){},t.prototype.dbDispose=function(){this.armature&&(this.currentName=this.dnName,this.armature.dispose())},t.prototype.playDefault=function(e){this.armature&&(this.currentName="default",this.visible=!0,this.armature.animation.gotoAndPlayByFrame("default",0,e))},t.prototype.playNamesAndLoop=function(e){},t.prototype.playNamesAndLoop1=function(e){},t.prototype.playByNames=function(e){},t.create=function(e,i){var n=GameCacheManager.instance.getCache(e);return n||(n=new t(i),GameCacheManager.instance.setCache(e,n)),n},t.clearCache=function(e){GameCacheManager.instance.clearCache(e)},t.prototype.playByTime=function(e,t){this.armature&&(this.currentName=e,this.visible=!0,this.armature.animation.gotoAndPlayByFrame(e,1,t))},t.prototype.play_first=function(e,t){this.armature&&(this.currentName=e,this.armature.animation.gotoAndPlayByFrame(e,1,t))},t.dbMovie=function(e,t){var i=RES.getRes(e+"_ske_json"),n=RES.getRes(e+"_tex_png"),r=RES.getRes(e+"_tex_json"),o=new dragonBones.EgretFactory;o.addSkeletonData(dragonBones.DataParser.parseDragonBonesData(i)),o.addTextureAtlas(new dragonBones.EgretTextureAtlas(n,r));var a=o.buildArmatureDisplay(t);return a},t.prototype.realease=function(){GameUtil.removeSelf(this),GameCacheManager.instance.setCache(this.dnName,this)},t}(game.BaseUI);__reflect(DBComponent.prototype,"DBComponent");var DBFactory=function(){function e(){this.m_factorys=new HashMap}return e.prototype.getDB=function(e){if(void 0===e&&(e=""),this.m_factorys.get(e)){var t=this.m_factorys.get(e);return t.buildArmatureDisplay(e)}var i=e+"_ske_json",n=e+"_tex_json",r=e+"_tex_png",o=RES.getRes(i),a=RES.getRes(n),s=RES.getRes(r);if(o&&a&&s){var l=new dragonBones.EgretFactory;return l.parseDragonBonesData(o),l.parseTextureAtlasData(a,s),this.m_factorys.put(e,l),l.buildArmatureDisplay(e)}},Object.defineProperty(e,"instance",{get:function(){return null==e.s_instance&&(e.s_instance=new e),e.s_instance},enumerable:!0,configurable:!0}),e.prototype.getDBAsync1=function(e){var t=e+"_ske_json",i=e+"_tex_json",n=e+"_tex_png",r=RES.getRes(t),o=RES.getRes(i),a=RES.getRes(n);if(r&&o&&a){var s=new dragonBones.EgretFactory;return s.parseDragonBonesData(r),s.parseTextureAtlasData(o,a),s.buildArmatureDisplay(e)}},e.prototype.setCache=function(e,t){this.m_factorys.has[e]?this.m_factorys[e]=t:this.m_factorys.put(e,t)},e.prototype.removeCache=function(){this.m_factorys.clear(),this.m_factorys=new HashMap},e.prototype.getDBAsync=function(e,t){var i=this;if(void 0===e&&(e=""),this.m_factorys.get(e)){var n=this.m_factorys.get(e);return t(n.buildArmatureDisplay(e))}var r=e+"_ske_json",o=e+"_tex_json",a=e+"_tex_png",s=RES.getRes(r),l=RES.getRes(o),c=RES.getRes(a);if(!s||!l||!c)return void RES.getResAsync(r,function(n){s=n,RES.getResAsync(o,function(n){l=n,RES.getResAsync(a,function(n){c=n;var r=new dragonBones.EgretFactory;i.m_factorys.put(e,r),r.parseDragonBonesData(s),r.parseTextureAtlasData(l,c),t(r.buildArmatureDisplay(e))},i)},i)},this);var h=new dragonBones.EgretFactory;return h.parseDragonBonesData(s),h.parseTextureAtlasData(l,c),this.m_factorys.put(e,h),t(h.buildArmatureDisplay(e))},e}();__reflect(DBFactory.prototype,"DBFactory");var SHRect=function(e){function t(t,i,n,r,o,a,s,l){var c=e.call(this)||this;return c.vx1=t,c.vy1=i,c.vx2=n,c.vy2=r,c.vx3=o,c.vy3=a,c.vx4=s,c.vy4=l,c.vector1=new SHVector(t,i),c.vector2=new SHVector(n,r),c.vector3=new SHVector(o,a),c.vector4=new SHVector(s,l),c.x=t,c.y=i,c}return __extends(t,e),t}(egret.Shape);__reflect(SHRect.prototype,"SHRect");var SHVector=function(){function e(e,t,i){void 0===i&&(i=0),this.x=e,this.y=t,this.z=i}return e.prototype.model=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y,this.z+t.z)},e.prototype.sub=function(t,i){return void 0===i&&(i=!1),i?new e(t.x-this.x,t.y-this.y,t.z-this.z):new e(this.x-t.x,this.y-t.y,this.z-t.z)},e.prototype.dot=function(e){return this.x*e.x+this.y*e.y+this.z*e.z},e.prototype.cross=function(t){var i=new e(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x);return i},e.prototype.angle=function(e){return 0==this.model()||0==e.model()?0:Math.acos(this.dot(e)/(this.model()*e.model()))},e.prototype.toString=function(){return"x:"+this.x+",y:"+this.y+",z:"+this.z+",model:"+this.model()},e}();__reflect(SHVector.prototype,"SHVector");var BezierDisplayObject=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startPointX=0,t.startPointY=0,t.endPointX=0,t.endPointY=0,t.bezierPointX=0,t.bezierPointY=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"factor",{get:function(){return 0},set:function(e){this.x=(1-e)*(1-e)*this.startPointX+2*e*(1-e)*this.bezierPointX+e*e*this.endPointX,this.y=(1-e)*(1-e)*this.startPointY+2*e*(1-e)*this.bezierPointY+e*e*this.endPointY},enumerable:!0,configurable:!0}),t.prototype.setBezierPoint=function(e,t,i){this.startPointX=e.x,this.startPointY=e.y,this.bezierPointX=t.x,this.bezierPointY=t.y,this.endPointX=i.x,this.endPointY=i.y},t}(eui.Group);__reflect(BezierDisplayObject.prototype,"BezierDisplayObject");var Config=function(){function e(){}return e.totalLen=3e3,e}();__reflect(Config.prototype,"Config");var TableNinjaLevel=function(){function e(){this.id=0,this.type="",this.source="",this.rotation_angle=0,this.width=0,this.height=0,this.radius=0,this.rotation=0,this.velocity=0,this.degree=0,this.radius1=0,this.cycle=0,this.cycle_point=0,this.scale=0}return e.Table=function(){return null==e.table&&null==e.table&&(e.table={}),e.table},e.Item=function(t){if(void 0==t||null==t)return null;var i=e.Table()[t.toString()];return void 0==i?null:i},e.table=null,e}();__reflect(TableNinjaLevel.prototype,"TableNinjaLevel"),window.TableNinjaLevel=TableNinjaLevel;var CommonConst=function(){function e(){}return e.STAGE_WIDTH=750,e.STAGE_HEIGHT=1334,e.GAME_ID="ninjaTobu",e.RES_GROUP_PRELOAD="preload",e.RES_GROUP_PLAYER="player",e.RES_GROUP_SCENE="scene",e.RES_GROUP_SELECT="select",e.RES_GROUP_ORDER=[e.RES_GROUP_PRELOAD],e.RES_GROUP_MEDIATOR={LobbyMediator:e.RES_GROUP_PRELOAD,PlayerMediator:e.RES_GROUP_PLAYER,SceneMediator:e.RES_GROUP_SCENE,SelectMediator:e.RES_GROUP_SELECT},e}();__reflect(CommonConst.prototype,"CommonConst");var GameConst=function(){function e(){}return e.BG_SPEED=2,e.SCREEN_WIDTH=750,e.SCREEN_HEIGHT=1334,e.BASE_SPEED=0,e.SLIDE_SPEED=e.BASE_SPEED,e.IS_SLIDE=!1,e.ACC_SPEED=.2,e.JUMP_TIME=3,e.totalLen=4002,e.INIT_HP=100,e.CURRENT_HP=e.INIT_HP,e.INVICIBLE="NONE",e.CLIP_NUM=0,e.SNIPER_HP=100,e.SWORD_HP=100,e.WEAPON="",e.WEAPON_LIBRARY=6,e.ATTACK_SPEED=100,e.RELOAD_INTERVAL=20,e.WEAPON_POWER=1,e.WEAPON_SPEED=15,e.ENENY_TYPE="",e.TALENT_TYPE=0,e.TALENT_NUMBER=3,e.OWN_TALENT=[],e.CURRENT_BULLET=0,e.POISON_NUMBER=0,e.CROSS_WALL=!1,e}();__reflect(GameConst.prototype,"GameConst");var Layer=function(){function e(){}return e.topside=999,e}();__reflect(Layer.prototype,"Layer");var TALENT_ARRAY=["ninja_weapon1_png","ninja_weapon2_png","ninja_weapon3_png"],TALENT_NAME=["多重射击","淬毒","巨型飞镖"],GameEvent=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.START="START",t.HIT_LEFT_RECT="HIT_LEFT_RECT",t.HIT_RIGHT_RECT="HIT_RIGHT_RECT",t.HIT_TOP_RECT="HIT_TOP_RECT",t.HIT_BOTTOM_RECT="HIT_BOTTOM_RECT",t.ROLE_DEAD="ROLE_DEAD",t.ARRIVE_END="ARRIVE_END",t.WALL_STAND="WALL_STAND",t.ARRIVE_SWORD_ENEMY="ARRIVE_SWORD_ENEMY",t.ENEMY_DEAD="ENEMY_DEAD",t.ROLE_ATTCKED="ROLE_ATTCKED",t.SHOW_MUNE="SHOW_MUNE",t.ATTCK_BOX="ATTCK_BOX",t.BROKEN_BOX="BROKEN_BOX",t.CLOSE_SELECT="CLOSE_SELECT",t}(egret.Event);__reflect(GameEvent.prototype,"GameEvent");var SoundConst=function(){function e(){}return e.mainMusic_mp3="game_bg0_mp3",e.OnclickEffect_mp3="click_mp3",e.buyItemEffect_mp3="buy_item_mp3",e.fightMusic_mp3="game_bg2_mp3",e.alert_big="alert_big_mp3",e.meteor="meteor_mp3",e.get_bs="get_bs_mp3",e.get_coin="get_coin_mp3",e.get_item="get_item_mp3",e.firework="dead1_mp3",e.shield="shield_mp3",e.mon_die="mon_die_mp3",e.box_dead="box_dead_mp3",e.bombEnemy_dead="yunshi_dead_mp3",e.followEnemy_dead="yunshi_dead_mp3",e.boss_dead="yunshi_dead_mp3",e.yunshi_dead="yunshi_dead_mp3",e.cc_ready="trans4_mp3",e.useBomb="cc_sound0_mp3",e.levelUpReady="trans1_mp3",e.levelUpIng="b2_mp3",e.followEnemy_follow="magnet_end_mp3",e}();__reflect(SoundConst.prototype,"SoundConst");var BlockObject=function(e){function t(t){var i=e.call(this)||this;return i.skinName="BlockSkin",i.textrue=t,i}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.block.source=this.textrue},t.produce=function(e){var i="string"==typeof e?e:e.source;null==t.cacheDict[i]&&(t.cacheDict[i]=[]);var n,r=t.cacheDict[i];return r.length>0?(n=r.pop(),"string"!=typeof e&&n.setData(e)):(n=new t(RES.getRes(i)),"string"!=typeof e&&n.setData(e)),n},t.reclaim=function(e){var i=e.textrue;null==t.cacheDict[i]&&(t.cacheDict[i]=[]);var n=t.cacheDict[i];-1==n.indexOf(e)&&n.push(e),t.spikesReclaim(e)},t.spikesReclaim=function(e){for(var t=0;t<e.numChildren;t++){var i=e.getChildAt(t);if(i instanceof Spikes)for(var n=0;n<Scene.trapsArray.length;n++)Scene.trapsArray[n].$hashCode==i.$hashCode&&(Scene.trapsArray.splice(n,1),e.removeChild(i),t--)}},t.prototype.setData=function(e){this._data=e;var t=e.distance;this.x=t[0][0],this.y=t[0][1],this.width=e.width,this.height=e.height,this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,this.rotation=e.rotation_angle;var i=t[0][0],n=t[0][1];this.x=i,this.y=n;var r,o;if(t.length>1&&(r=Math.sqrt(Math.pow(t[1][0]-t[0][0],2)+Math.pow(t[1][1]-t[0][1],2)),o=r/e.velocity*60),2==t.length){var a=egret.Tween.get(this,{loop:!0});a.to({x:t[1][0],y:t[1][1]},o).to({x:i,y:n},o)}else if(3==t.length){r=Math.sqrt(Math.pow(t[2][0]-t[1][0],2)+Math.pow(t[2][1]-t[1][1],2));var s=r/e.velocity*60,a=egret.Tween.get(this,{loop:!0});a.to({x:t[1][0],y:t[1][1]},o).to({x:t[2][0],y:t[2][1]},s).to({x:i,y:n},o)}else if(4==t.length){r=Math.sqrt(Math.pow(t[2][0]-t[1][0],2)+Math.pow(t[2][1]-t[1][1],2));var s=r/e.velocity*60;r=Math.sqrt(Math.pow(t[3][0]-t[2][0],2)+Math.pow(t[3][1]-t[2][1],2));var l=r/e.velocity*60,a=egret.Tween.get(this,{loop:!0});a.to({x:t[1][0],y:t[1][1]},o).to({x:t[2][0],y:t[2][1]},s).to({x:t[3][0],y:t[3][1]},l).to({x:i,y:n},o)}e.rotation&&(this.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrameRotation,this),this.onEnterFrameRotation()),this.creatSpikes(e.hastrap,e.scale),0==e.hastrap[0]&&this.createtopRect(),0==e.hastrap[1]&&this.createbottomRect(),0==e.hastrap[2]&&this.createleftRect(),0==e.hastrap[3]&&this.createrightRect()},t.prototype.onEnterFrameRotation=function(){this.anchorOffsetY=this.height>>1,this.anchorOffsetX=this.width>>1,this.rotation+=this._data.rotation*Scene.factor},t.prototype.creatSpikes=function(e,t){if(e[0]){var i=SpikesManage.instance.creatSpikes(this.block.x+10,-20,Dir.TOP,this.width,!1,t);DisplayerToCanvas.add.apply(DisplayerToCanvas,[this,0].concat(i))}if(e[1]){var i=SpikesManage.instance.creatSpikes(this.block.x+10,this.height-10,Dir.BOTTOM,this.width,!1,t);DisplayerToCanvas.add.apply(DisplayerToCanvas,[this,0].concat(i))}if(e[2]){var i=SpikesManage.instance.creatSpikes(this.block.x-20,20,Dir.LEFT,this.height,!1,t);DisplayerToCanvas.add.apply(DisplayerToCanvas,[this,0].concat(i))}if(e[3]){var i=SpikesManage.instance.creatSpikes(this.width-10,10,Dir.RIGHT,this.height,!1,t);DisplayerToCanvas.add.apply(DisplayerToCanvas,[this,0].concat(i))}},t.prototype.createleftRect=function(){this.leftRect=new eui.Rect,this.leftRect.fillAlpha=0,this.leftRect.width=5,this.leftRect.left=5,this.leftRect.verticalCenter=0,this.leftRect.height=this.height-20,this.addChild(this.leftRect)},t.prototype.createrightRect=function(){this.rightRect=new eui.Rect,this.rightRect.fillAlpha=0,this.rightRect.width=5,this.rightRect.right=5,this.rightRect.verticalCenter=0,this.rightRect.height=this.height-20,this.addChild(this.rightRect)},t.prototype.createtopRect=function(){this.topRect=new eui.Rect,this.topRect.fillAlpha=0,this.topRect.width=this.width-30,this.topRect.top=5,this.topRect.horizontalCenter=0,this.topRect.height=5,this.addChild(this.topRect)},t.prototype.createbottomRect=function(){this.bottomRect=new eui.Rect,this.bottomRect.fillAlpha=0,this.bottomRect.width=this.width-30,this.bottomRect.bottom=5,this.bottomRect.horizontalCenter=0,this.bottomRect.height=5,this.addChild(this.bottomRect)},t.cacheDict={},t}(eui.Component);__reflect(BlockObject.prototype,"BlockObject");var RoteBlockObject=function(e){function t(t){var i=e.call(this)||this;return i.isRote=!0,i.skinName="BlockSkin",i.textrue=t,i}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.block.source=this.textrue},t.produce=function(e){var i="string"==typeof e?e:e.source;null==t.cacheDict[i]&&(t.cacheDict[i]=[]);var n,r=t.cacheDict[i];return r.length>0?n=r.pop():(n=new t(RES.getRes(i)),"string"!=typeof e&&n.setData(e)),n},t.reclaim=function(e){var i=e.textrue;null==t.cacheDict[i]&&(t.cacheDict[i]=[]);var n=t.cacheDict[i];-1==n.indexOf(e)&&n.push(e)},t.prototype.setData=function(e){this._data=e;var t=e.distance;if(this.x=t[0][0],this.y=t[0][1],e.rotation||(this.isRote=!1),this.width=e.width,this.height=e.height,this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,this.rotation=e.rotation_angle,this.initWidth=this.width,this.initHeight=this.height,t.length>1){var i=Math.sqrt(Math.pow(t[1][0]-t[0][0],2)+Math.pow(t[1][1]-t[0][1],2)),n=i/e.velocity*60,r=egret.Tween.get(this,{loop:!0});r.to({x:t[1][0],y:GameConst.totalLen-t[1][1]},n,egret.Ease.sineInOut).to({x:t[0][0],y:GameConst.totalLen-t[0][1]},n,egret.Ease.sineInOut)}e.rotation&&(this.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrameRotation,this),this.onEnterFrameRotation()),this.creatSpikes(e.hastrap,e.scale)},t.prototype.onEnterFrameRotation=function(){this.anchorOffsetY=this.height>>1,this.anchorOffsetX=this.width>>1,this.rotation+=this._data.rotation*Scene.factor},t.prototype.creatSpikes=function(e,t){if(e[0]){var i=SpikesManage.instance.creatSpikes(this.block.x+10,-20,Dir.TOP,this.width,!0,t);DisplayerToCanvas.add.apply(DisplayerToCanvas,[this,0].concat(i))}if(e[1]){var i=SpikesManage.instance.creatSpikes(this.block.x+10,this.height-10,Dir.BOTTOM,this.width,!0,t);DisplayerToCanvas.add.apply(DisplayerToCanvas,[this,0].concat(i))}if(e[2]){var i=SpikesManage.instance.creatSpikes(this.block.x-20,20,Dir.LEFT,this.height,!0,t);DisplayerToCanvas.add.apply(DisplayerToCanvas,[this,0].concat(i))}if(e[3]){var i=SpikesManage.instance.creatSpikes(this.width-10,10,Dir.RIGHT,this.height,!0,t);DisplayerToCanvas.add.apply(DisplayerToCanvas,[this,0].concat(i))}},t.prototype.createtopRect=function(){this.topRect=this.rect2,this.addChild(this.topRect)},t.prototype.createbottomRect=function(){this.bottomRect=this.rect4,this.addChild(this.bottomRect)},t.prototype.createleftRect=function(){this.leftRect=this.rect3,this.addChild(this.leftRect)},t.prototype.createrightRect=function(){this.rightRect=this.rect1,this.addChild(this.rightRect)},t.cacheDict={},t}(eui.Component);__reflect(RoteBlockObject.prototype,"RoteBlockObject");var Brick=function(e){function t(t){var i=e.call(this)||this;return i._img=new eui.Image(t),i.addChild(i._img),i}return __extends(t,e),t}(eui.Component);__reflect(Brick.prototype,"Brick");var BrickGroup=function(){function e(){this._wallLen=1200,this._lArr=[],this._rArr=[]}return Object.defineProperty(e,"instance",{get:function(){return this._instance=this._instance||new e},enumerable:!0,configurable:!0}),e.prototype.initWall=function(){for(var e=3,t=115,i=0;e>i;i++)this.creatUnit(-t,this._lArr,i),this.creatUnit(GameConst.SCREEN_WIDTH-210+t,this._rArr,i)},Object.defineProperty(e.prototype,"lArr",{get:function(){return this._lArr},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rArr",{get:function(){return this._rArr},enumerable:!0,configurable:!0}),e.prototype.creatUnit=function(e,t,i){var n=t[i]?t[i]:new Brick("wall_png");n.x=e,t[i-1]?n.y=t[i-1].y-this._wallLen+30*Math.random():n.y=GameConst.totalLen-this._wallLen+100*Math.random(),t[i]=n},e.prototype.updateWall=function(){this.updateUnitWall(this._lArr),this.updateUnitWall(this._rArr)},e.prototype.updateUnitWall=function(e){var t=e[0].localToGlobal();t.y>GameConst.SCREEN_HEIGHT&&(e.push(e[0]),e.shift(),e[2].y=e[1].y-this._wallLen+30*Math.random())},e}();__reflect(BrickGroup.prototype,"BrickGroup");var HitTestHandle=function(){function e(){}return e.addTicket=function(e){egret.Ticker.getInstance().register(this.update,e)},e.update=function(){e.hitTest()},e.hitTest=function(){},e.hitBlock=function(e){},e.hitTrap=function(){},e.hitEnemy=function(e){var t=e;t.destory()},e.arriveEnd=function(){},e.checkRolePosition=function(e){var t,i,n=i.x-t.x,r=i.y-t.y;Math.sqrt(n*n+r*r),Math.sqrt(Math.pow(t.height/4,2)+Math.pow(t.width/2,2)),Math.sqrt(Math.pow(t.width/4,2)+Math.pow(t.height/2,2)),Math.sqrt(t.width*t.width+t.height*t.height)/2},e}();__reflect(HitTestHandle.prototype,"HitTestHandle");var HitTestMediator=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.addGameEventListener=function(){},t}(Mediator);__reflect(HitTestMediator.prototype,"HitTestMediator");var Blade=function(e){function t(t){var i=e.call(this)||this;return i.scale=1,i.skinName="BladeSkin",i.textrue=t,i}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.icon.source=this.textrue},t.creat=function(e){var i=e.source,n=new t(i);return n.setData(e),Scene.trapsArray.push(n),n},t.prototype.setData=function(e){this._data=e;var t=e.distance;this.icon.scaleX=this.icon.scaleY=e.scale,this.scale=e.scale;var i=this._data.width/2,n=this._data.height/2;this.icon.anchorOffsetX=i,this.icon.anchorOffsetY=n;var r=t[0][0],o=t[0][1];this.x=r,this.y=o;var a,s;if(t.length>1&&(a=Math.sqrt(Math.pow(t[1][0]-t[0][0],2)+Math.pow(t[1][1]-t[0][1],2)),s=a/e.velocity*60),2==t.length){var l=egret.Tween.get(this,{loop:!0});l.to({x:t[1][0],y:t[1][1]},s).to({x:r,y:o},s)}else if(3==t.length){a=Math.sqrt(Math.pow(t[2][0]-t[1][0],2)+Math.pow(t[2][1]-t[1][1],2));var c=a/e.velocity*60;a=Math.sqrt(Math.pow(t[0][0]-t[2][0],2)+Math.pow(t[0][1]-t[2][1],2));var h=a/e.velocity*60,l=egret.Tween.get(this,{loop:!0});l.to({x:t[1][0],y:t[1][1]},s).to({x:t[2][0],y:t[2][1]},c).to({x:r,y:o},h)}else if(4==t.length){a=Math.sqrt(Math.pow(t[2][0]-t[1][0],2)+Math.pow(t[2][1]-t[1][1],2));var c=a/e.velocity*60;a=Math.sqrt(Math.pow(t[3][0]-t[2][0],2)+Math.pow(t[3][1]-t[2][1],2));var h=a/e.velocity*60,l=egret.Tween.get(this,{loop:!0});l.to({x:t[1][0],y:t[1][1]},s).to({x:t[2][0],y:t[2][1]},c).to({x:t[3][0],y:t[3][1]},h).to({x:r,y:o},c)}e.rotation&&this.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrameRotaion,this)},t.produce=function(e){var i=e;null==t.cacheDict[i]&&(t.cacheDict[i]=[]);var n,r=t.cacheDict[i];return n=r.length>0?r.pop():new t(i)},t.reclaim=function(e){var i=e.textrue;null==t.cacheDict[i]&&(t.cacheDict[i]=[]);var n=t.cacheDict[i];-1==n.indexOf(e)&&n.push(e)},t.prototype.onEnterFrameRotaion=function(){this.icon.rotation+=this._data.rotation*Scene.factor},t.cacheDict={},t}(eui.Component);__reflect(Blade.prototype,"Blade");var Boss=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(eui.Component);__reflect(Boss.prototype,"Boss");var Coin=function(e){function t(t){var i=e.call(this)||this;return i.skinName="CoinSkin",i.texture=t,i.coin.source=i.texture,i}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.produce=function(e){var i=e;null==t.cacheDict[i]&&(t.cacheDict[i]=[]);
var n,r=t.cacheDict[i];return n=r.length>0?r.pop():new t(RES.getRes(i))},t.reclain=function(e){var i=e.texture;null==t.cacheDict[i]&&(t.cacheDict[i]=[]);var n=t.cacheDict[i];-1==n.indexOf(e)&&n.push(e)},t.cacheDict={},t}(eui.Component);__reflect(Coin.prototype,"Coin");var EndPoint=function(e){function t(t){var i=e.call(this,t)||this;return i.scale=1,i.init(),i}return __extends(t,e),t.prototype.init=function(){this.anchorOffsetX=32,this.anchorOffsetY=32;var e=egret.Tween.get(this,{loop:!0});e.to({scaleX:1.2,scaleY:1.2},500,egret.Ease.cubicInOut).to({scaleX:1,scaleY:1},500,egret.Ease.cubicInOut)},t}(eui.Image);__reflect(EndPoint.prototype,"EndPoint");var EndPointManage=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){return this._instance=this._instance||new e},enumerable:!0,configurable:!0}),e.prototype.creat=function(){},e}();__reflect(EndPointManage.prototype,"EndPointManage");var GoldBox=function(e){function t(){var t=e.call(this)||this;return t.time=1,t.shakeTime=200,t.skinName="GoldBoxSkin",ObserverManager.instance.addEventListener(GameEvent.ATTCK_BOX,t.shake,t),t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.init()},t.prototype.init=function(){this.leftBox.visible=this.rightBox.visible=!1,this.leftBox.horizontalCenter=this.rightBox.horizontalCenter=0,this.leftBox.rotation=this.rightBox.rotation=0,this.box.visible=this.lock.visible=!0,this.box.verticalCenter=this.lock.verticalCenter=0,this.time=0,egret.Tween.get(this.box,{loop:!0}).to({verticalCenter:3},400).to({verticalCenter:-3},200),egret.Tween.get(this.lock,{loop:!0}).to({verticalCenter:3},400).to({verticalCenter:-3},200)},t.prototype.shake=function(){this.box.visible&&(egret.Tween.get(this.box).to({rotation:-10},200).to({rotation:10},200).to({rotation:-5},50).to({rotation:5},50).to({rotation:0},20),this.time++,this.time>=4&&this["break"]())},t.prototype["break"]=function(){var e=this;this.leftBox.visible=this.rightBox.visible=!0,this.box.visible=this.lock.visible=!1,egret.Tween.get(this.leftBox).to({rotation:-25,horizontalCenter:-15},800,egret.Ease.backOut).call(function(){e.leftBox.visible=!1,ObserverManager.instance.dispatchEventWith(GameEvent.BROKEN_BOX),e.reclaim()}),egret.Tween.get(this.rightBox).to({rotation:25,horizontalCenter:15},800,egret.Ease.backOut).call(function(){e.rightBox.visible=!1})},t.prototype.reclaim=function(){this&&this.parent&&this.parent.removeChild(this),t.goldBoxArray=[]},t.goldBoxArray=[],t}(eui.Component);__reflect(GoldBox.prototype,"GoldBox");var Pole=function(e){function t(t){var i=e.call(this)||this;i.skinName="PoleSkin",i._data=t,i.anchorOffsetY=i.height>>1;var n=t.distance,r=Math.sqrt(Math.pow(n[1][0]-n[0][0],2)+Math.pow(n[1][1]-n[0][1],2));i.width=r;var o=180*Math.atan2(n[1][1]-n[0][1],n[1][0]-n[0][0])/Math.PI;return i.rotation=Math.abs(o),i}return __extends(t,e),t}(eui.Component);__reflect(Pole.prototype,"Pole");var Soldiers=function(e){function t(t){var i=e.call(this)||this;return i.sowrdttckTimes=2,i.poisonNum=0,i.canAttack=!0,i.hasShut=!1,i.skinName="SoldierSkin",i.textrue=t,i.enemy.source=i.textrue,"ranged_enemy_idle_png"==i.textrue?(i.enemyhp=GameConst.SNIPER_HP,i.hp.updateBar(i.enemyhp,GameConst.SNIPER_HP)):(i.textrue="attacking_enemy_0_png")&&(i.enemyhp=GameConst.SWORD_HP,i.hp.updateBar(i.enemyhp,GameConst.SWORD_HP)),i}return __extends(t,e),t.prototype.initHp=function(){"ranged_enemy_idle_png"==this.textrue?(this.enemyhp=GameConst.SNIPER_HP,this.hp.updateBar(this.enemyhp,GameConst.SNIPER_HP)):(this.textrue="attacking_enemy_0_png")&&(this.enemyhp=GameConst.SWORD_HP,this.hp.updateBar(this.enemyhp,GameConst.SWORD_HP))},t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.init(),ObserverManager.instance.addEventListener(GameEvent.ARRIVE_SWORD_ENEMY,this.enemyAttack,this),this.poisonInterval()},t.prototype.enemyAttack=function(e){var t=e.data;if("sniper"==t.rangeType&&"ranged_enemy_idle_png"==this.enemy.source,"sowrd"==t.rangeType&&"attacking_enemy_0_png"==this.enemy.source){var i=t.dir,n=t.scale;if(this.canAttack&&this.sowrdttckTimes>0)if("scale1"==n&&"right"==i){if("INVICIBLE"==GameConst.INVICIBLE)return;this.canAttack=!1,this.enemy.visible=!1,this.attackAni.visible=!0,this.attackAni.x=40,this.attackAni.y=45,this.attackAni.visible=!0,this.attackAni.animation.play("enemy_cut",1),this.attackAni.scaleX=1,this.addChild(this.attackAni),ObserverManager.instance.dispatchEventWith(GameEvent.ROLE_ATTCKED,!1,{dir:i})}else if("scale2"==n&&"left"==i){if("INVICIBLE"==GameConst.INVICIBLE)return;this.canAttack=!1,this.enemy.visible=!1,this.attackAni.visible=!0,this.attackAni.x=40,this.attackAni.y=45,this.attackAni.visible=!0,this.attackAni.animation.play("enemy_cut",1),this.attackAni.scaleX=-1,this.addChild(this.attackAni),ObserverManager.instance.dispatchEventWith(GameEvent.ROLE_ATTCKED,!1,{dir:i})}}},t.prototype.enemyDead=function(e){this.canAttack&&(this.canAttack=!1,this.deadParticle=new particle.GravityParticleSystem(RES.getRes("deadParticle_png"),RES.getRes("deadParticle_json")),this.deadParticle.start(),this.deadParticle.x=this.deadParticle.y=-450,this.deadParticle.emissionTime=500,this.currentState="scale1",this.validateNow(),egret.clearInterval(this.changeInterval),this.addChild(this.deadParticle),e&&e.parent&&e.parent.removeChild(e),this.showDamage(this.enemyhp),this.sniperbody.visible=this.sniperHead.visible=!1,egret.Tween.removeTweens(this.lightImg2),this.lightImg2.scaleY=1)},t.prototype.sniperAttack=function(e,t){var i=this;if(e.enemyPoint.y>=e.playerPoint.y){if(0==this.sniperbody.visible&&0==this.enemy.visible)return;var n=e.dir,r=(e.scale,e.playerPoint),o=e.enemyPoint;this.lightImg2.visible=!0,"left"==n&&(this.currentState="scale2",this.validateNow()),"right"==n&&(this.currentState="scale1",this.validateNow()),this.exclamImg.visible=!0,egret.clearInterval(this.changeInterval),this.hasShut||this.shut(),this.angle=CommonUtil.getAngle(r.x,r.y,o.x,o.y)%360,"scale2"==this.currentState&&r.y<=o.y?(this.angle=this.angle-90,this.headGroup.rotation=this.angle,this.lightGroup.rotation=this.angle,this.angle=this.angle+180,this.hasShut||egret.Tween.get(this.lightImg2).to({scaleY:0},2e3).call(function(){i.fire(i.angle,t)})):"scale1"==this.currentState&&r.y<=o.y&&(this.angle=this.angle-270,this.headGroup.rotation=this.angle,this.lightGroup.rotation=this.angle,this.hasShut||egret.Tween.get(this.lightImg2).to({scaleY:0},2e3).call(function(){i.fire(i.angle,t)})),this.hasShut=!0}else e.enemyPoint.y<e.playerPoint.y&&this.pause()},t.prototype.shut=function(){this.sniperbody.visible||(this.enemy.visible=this.exclamImg.visible=!1,this.sniperbody.visible=this.sniperHead.visible=this.lightImg2.visible=!0)},t.prototype.pause=function(){egret.Tween.removeTweens(this.lightImg2),this.exclamImg.visible=!1,this.lightImg2.visible=!1,this.lightImg2.scaleY=1},t.prototype.fire=function(e,i){if(0!=this.sniperbody.visible){this.lightImg2.scaleY=1;var n=Bullet.produce("sniper_bullet_png");i.addChildAt(n,i.numChildren-1),n.bullet.rotation=this.angle,n.x=this.x,n.y=this.y+this.width/2;var r=Math.PI*(this.angle/180),o=40*Math.cos(r),a=40*Math.sin(r);n.shut(o,a),t.bulletArray.push(n),this.hasShut=!1}},t.produce=function(e){var i=e;null==t.cacheDict[i]&&(t.cacheDict[i]=[]);var n,r=t.cacheDict[i];return n=r.length>0?r.pop():new t(i)},t.reclaim=function(e){var i=e.textrue;e.poisonText.visible=!1,e.poisonNum=0,null==t.cacheDict[i]&&(t.cacheDict[i]=[]);var n=t.cacheDict[i];-1==n.indexOf(e)&&n.push(e)},t.prototype.init=function(){this.attackAni=CommonUtil.createAnimation("enemy_cut",function(){this.enemy.visible=!0,this.attackAni.visible=!1,this.canAttack=!0,0==this.sowrdttckTimes&&(this.enemy.source="ashigaru_yield_png",egret.clearInterval(this.changeInterval),this.lightImg.visible=!1,this.enemy.scaleX=this.attackAni.scaleX)},this),this.enemy.source=this.textrue,this.enemy.visible=!0,this.canAttack=!0,this.sowrdttckTimes=2,this.enemy.anchorOffsetX=this.enemy.width/2,this.enemy.anchorOffsetY=this.enemy.height/2,this.lightImg.anchorOffsetX=this.lightImg.width/2,this.lightImg.anchorOffsetY=this.lightImg.height/2,this.lightImg2.scaleY=1,egret.clearInterval(this.changeInterval),this.hasShut=!1,this.sniperbody.visible=this.sniperHead.visible=this.lightImg2.visible=this.exclamImg.visible=!1,this.swordmanMove()},t.prototype.swordmanMove=function(){var e=this;if("attacking_enemy_0_png"==this.textrue){this.lightImg.visible=!0;var t=1;this.changeInterval=egret.setInterval(function(){t%2>0?e.setState(2):e.setState(1),t++},this,5e3)}else if(this.lightImg.visible=!1,"ranged_enemy_idle_png"==this.textrue){var i=1;this.changeInterval=egret.setInterval(function(){i%2>0?e.setState(2):e.setState(1),i++},this,5e3)}else this.changeInterval=egret.setInterval(function(){e.enemy.scaleX=-e.enemy.scaleX},this,5e3)},t.prototype.setState=function(e){this.currentState="scale"+e,this.validateNow()},t.prototype.enemyHurt=function(){"attacking_enemy_0_png"==this.textrue?(this.enemyhp-=GameConst.WEAPON_POWER+1*this.poisonNum,this.hp.updateBar(this.enemyhp,GameConst.SWORD_HP)):"ranged_enemy_idle_png"==this.textrue&&(this.enemyhp-=GameConst.WEAPON_POWER+1*this.poisonNum,this.hp.updateBar(this.enemyhp,GameConst.SNIPER_HP)),-1!=GameConst.OWN_TALENT.indexOf(2)&&(this.poisonNum++,this.poisonNum>=5&&(this.poisonNum=5),this.poisonText.visible=!0),this.showDamage(GameConst.WEAPON_POWER+1*this.poisonNum)},t.prototype.poisonInterval=function(){var e=this;egret.setInterval(function(){e.poisonNum>=1&&e.poisonNum--,e.poisonNum<=0&&(e.poisonText.visible=!1)},this,5e3)},t.prototype.showDamage=function(e){var t;t=e?new DamageItem(e):new DamageItem,t.horizontalCenter=0,t.y=-22,egret.Tween.get(t).to({y:-66,alpha:0},300,egret.Ease.sineIn).call(function(){GameUtil.removeSelf(t)}),this.addChild(t)},t.enemyArray=[],t.bulletArray=[],t.cacheDict={},t}(eui.Component);__reflect(Soldiers.prototype,"Soldiers");var Bullet=function(e){function t(t){var i=e.call(this)||this;return i.velocity=[],i.scale=1,i.skinName="BulletSkin",i.texture=t,i.bullet.source=i.texture,i}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.bullet.anchorOffsetX=this.bullet.width/2,this.bullet.anchorOffsetY=this.bullet.height/2},t.prototype.shut=function(e,t){var i=this;egret.Ticker.getInstance().register(function(){i.x+=e*Scene.factor,i.y+=t*Scene.factor},this)},t.produce=function(e){var i=e;null==t.cacheDict[i]&&(t.cacheDict[i]=[]);var n,r=t.cacheDict[i];return n=r.length>0?r.pop():new t(e)},t.reclaim=function(e){var i=e.texture;e.scaleX=e.scaleY=1,null==t.cacheDict[i]&&(t.cacheDict[i]=[]);var n=t.cacheDict[i];-1==n.indexOf(e)&&n.push(e)},t.cacheDict={},t}(eui.Component);__reflect(Bullet.prototype,"Bullet");var Spikes=function(e){function t(t){var i=e.call(this)||this;return i.skinName="SpikesSkin",i.texture=t,i.traps.source=i.texture,i}return __extends(t,e),t.produce=function(e){var i=e;null==t.cacheDict[i]&&(t.cacheDict[i]=[]);var n,r=t.cacheDict[i];return n=r.length>0?r.pop():new t(i)},t.reclaim=function(e){var i=e.texture;null==t.cacheDict[i]&&(t.cacheDict[i]=[]);var n=t.cacheDict[i];-1==n.indexOf(e)&&(e.skewX=0,e.rotation=0,n.push(e))},t.cacheDict={},t}(eui.Component);__reflect(Spikes.prototype,"Spikes");var Dir;!function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT"}(Dir||(Dir={}));var SpikesManage=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){return this._instance=this._instance||new e},enumerable:!0,configurable:!0}),e.prototype.creatSpikes=function(e,t,i,n,r,o,a){for(var s=[],l=90,c=Math.floor(n/100),h=0;c>h;h++){var p=new Spikes("spikes_png");s.push(p),p.scale=o,r||Scene.trapsArray.push(p),i==Dir.TOP?(p.x=0==h?e:e+l*h,p.y=t):i==Dir.BOTTOM?(p.traps.skewX=180,p.x=0==h?e:e+l*h,p.y=t):i==Dir.LEFT?(p.traps.skewX=180,p.traps.rotation=90,p.x=e,p.y=0==h?t:t+l*h):i==Dir.RIGHT&&(p.traps.rotation=90,p.x=e,p.y=0==h?t:t+l*h)}return s},e.prototype.creatSpikes2=function(e,t,i,n,r,o,a){for(var s=[],l=90,c=Math.floor(n/100),h=0;c>h;h++){var p=Spikes.produce("spikes_png");s.push(p),p.scale=o,r||Scene.trapsArray.push(p),i==Dir.TOP?(p.x=0==h?e:e+l*h,p.y=t+5):i==Dir.BOTTOM?(p.traps.skewX=180,p.x=0==h?e-l*o:e-l*o+l*o*h,p.y=t-30*o):i==Dir.LEFT?(p.traps.skewX=180,p.traps.rotation=90,p.x=e,p.y=0==h?t-l*o:t-l*o+l*o*h):i==Dir.RIGHT&&(p.traps.rotation=90,p.x=e-30*o,p.y=0==h?t:t+l*o*h)}return s},e}();__reflect(SpikesManage.prototype,"SpikesManage");var SwingBlade=function(e){function t(t){var i=e.call(this)||this;return i.skinName="SwingBladeSkin",i._data=t,i.anchorOffsetX=25.5,i.anchorOffsetY=25.5,i.addEventListener(egret.Event.ENTER_FRAME,i.update,i),i}return __extends(t,e),t.creat=function(e){var i=new t(e);return i.setData(e),i},t.reclaim=function(e){for(var t=0;t<e.numChildren;t++){var i=e.getChildAt(t);if(i instanceof Blade)for(var n=0;n<Scene.trapsArray.length;n++)Scene.trapsArray[n].$hashCode!=i.$hashCode||(Scene.trapsArray.splice(n,1),e.removeChild(i))}},t.prototype.setData=function(e){var t=e.distance;this._blade=Blade.creat(this._data),this.addChild(this._blade),this.x=t[0][0],this.y=t[0][1],t.length<=1,this.pole.width=e.radius1,this._blade.anchorOffsetX=e.radius,this._blade.anchorOffsetY=e.radius,this._blade.x=this.pole.width+this.pole.x,this._blade.y=this.pole.y,this.rotation=e.rotation_angle;var i=Math.abs(5e3*e.cycle/360);if(e.rotation_angle!=e.cycle&&e.cycle%360==0){var n=egret.Tween.get(this,{loop:!0});n.to({rotation:e.cycle},i)}else if(e.rotation_angle!=e.cycle&&e.cycle%360!=0){var n=egret.Tween.get(this,{loop:!0});n.to({rotation:e.cycle},i).to({rotation:e.rotation_angle},i)}},t.prototype.update=function(){this._blade.rotation=-this.rotation},t.cacheDict={},t}(eui.Component);__reflect(SwingBlade.prototype,"SwingBlade");var DamageItem=function(e){function t(t){var i=e.call(this)||this;return i.skinName="DamageSkin",t&&(i.num=t,i.damageLabel.text="-"+i.num),i}return __extends(t,e),Object.defineProperty(t,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t}(eui.Component);__reflect(DamageItem.prototype,"DamageItem");var PlayerDarts=function(e){function t(t){var i=e.call(this)||this;return i.skinName="PlayerBulletSkin",t&&(i.num=t),i}return __extends(t,e),t.getInstance=function(e){return t._instance||(t._instance=new t(e)),t._instance},t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.initDarts()},t.prototype.initDarts=function(){for(var e=0;e<this.num;e++){var t=new eui.Image(GameConst.WEAPON);this.bulletGroup.addChild(t)}this.dartlabel.text="X"+GameConst.CLIP_NUM},t.prototype.addDarts=function(){var e=this.bulletGroup.numChildren;if(!(e>=GameConst.CLIP_NUM)){var t=new eui.Image(GameConst.WEAPON);this.bulletGroup.addChild(t),this.dartlabel.text="X"+this.bulletGroup.numChildren}},t.prototype.subDarts=function(){var e=this.bulletGroup.numChildren;if(!(0>=e)){var t=this.bulletGroup.getChildAt(e-1);GameUtil.removeSelf(t),this.dartlabel.text="X"+this.bulletGroup.numChildren}},t}(eui.Component);__reflect(PlayerDarts.prototype,"PlayerDarts");var PlayerHp=function(e){function t(){var t=e.call(this)||this;return t.skinName="PlayerHpSkin",t}return __extends(t,e),t.prototype.updateBar=function(e,t){var i=e/t;this.hpBar.width=50*i,.5>=i?this.hpBar.fillColor=16711680:this.hpBar.fillColor=8978183},t}(eui.Component);__reflect(PlayerHp.prototype,"PlayerHp");var PlayerIcon=function(e){function t(){var t=e.call(this)||this;return t.clipNum=GameConst.CLIP_NUM,t.velocity=[0,0],t.roleAy=GameConst.ACC_SPEED,t.state=GameConst.INVICIBLE,t.roleHp=GameConst.INIT_HP,t.skinName="PlayerIconSkin",t}return __extends(t,e),Object.defineProperty(t,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.role.anchorOffsetX=this.role.width/2,this.role.anchorOffsetY=this.role.height/2,this.attackani=CommonUtil.createAnimation("cut_light",function(){this.attackani.visible=!1},this),egret.Ticker.getInstance().register(this.update,this),GameConst.CURRENT_BULLET=0},t.prototype.changeSource=function(e){this.role.source=e,this.addChild(this.role),this.setPosition()},t.prototype.setPosition=function(){this.role.anchorOffsetX=this.role.width/2,this.role.anchorOffsetY=this.role.height/2},t.prototype.playAttackAni=function(){this.attackani.visible=!0,this.attackani.x=40,this.attackani.y=20,this.attackani.animation.play("cut_light",1),this.addChild(this.attackani)},t.prototype.updateHp=function(){this.hp.updateBar(this.roleHp,GameConst.INIT_HP)},t.prototype.showDamage=function(e){var t=new DamageItem(e);t.y=-22,t.horizontalCenter=0,egret.Tween.get(t).to({y:-66,alpha:0},300,egret.Ease.sineIn).call(function(){GameUtil.removeSelf(t)}),this.addChild(t)},t.prototype.playerShut=function(e,i){if(!(this.clipNum<=0)){var n=Bullet.produce(GameConst.WEAPON);i.addChildAt(n,i.numChildren-1),n.bullet.rotation=e+90,n.x=this.x+this.width/2,n.y=this.y+this.height/2,GameConst.CURRENT_BULLET++,-1!=GameConst.OWN_TALENT.indexOf(3)&&GameConst.CURRENT_BULLET%3==0&&this.clipNum>=3&&(n.scaleX=n.scaleY=2);var r=Math.PI*(e/180);n.vx=GameConst.WEAPON_SPEED*Math.cos(r),n.vy=GameConst.WEAPON_SPEED*Math.sin(r),this.clipNum--,t.dartsArray.push(n)}},t.prototype.update=function(){for(var e=0;e<t.dartsArray.length;e++){var i=t.dartsArray[e];i.x+=i.vx*Scene.factor,i.y+=i.vy*Scene.factor}},t.prototype.resetDarts=function(){this.clipNum>=GameConst.CLIP_NUM||this.clipNum++},t.dartsArray=[],t}(eui.Component);__reflect(PlayerIcon.prototype,"PlayerIcon");var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,i){function n(n){t.call(i,n,e)}if(RES.hasRes(e)){var r=RES.getRes(e);r?n(r):RES.getResAsync(e,n,this)}else RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var RestartGameMediator=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.addGameEventListener=function(){},t.prototype.initView=function(){this.restartGameUI=new RestartGameUI(""),this.restartGameUI.initUI()},t.prototype.onEnter=function(){ViewManager.instance.addElement(this.restartGameUI),this.restartGameUI.enter()},t.prototype.onExit=function(){this.restartGameUI.exit(),ViewManager.instance.removeElement(this.restartGameUI)},t}(Mediator);__reflect(RestartGameMediator.prototype,"RestartGameMediator");var RestartGameUI=function(e){function t(t){var i=e.call(this)||this;return i.skinName=RestartGameSkin,i.currentState=t,i.validateNow(),i.initUI(),i}return __extends(t,e),t.prototype.initUI=function(){this.restartBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.restartGame,this),this.homeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showMenu,this),this.restart.addEventListener(egret.TouchEvent.TOUCH_TAP,this.restartGame,this),this.nextBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.nextGame,this),this.home.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showMenu,this)},t.prototype.enter=function(){},t.prototype.exit=function(){},t.prototype.restartGame=function(){var e=this;egret.Tween.get(this.maskRect).to({alpha:1},1e3).call(function(){var t=ObserverManager.getMediator(SceneMediator);t.resetView(),e.maskRect.alpha=0,e.parent&&e.parent.removeChild(e)})},t.prototype.nextGame=function(){},t.prototype.showMenu=function(){ObserverManager.instance.dispatchEventWith(GameEvent.SHOW_MUNE),this.parent&&this.parent.removeChild(this)},t.prototype.quitGame=function(){},t}(eui.Component);__reflect(RestartGameUI.prototype,"RestartGameUI");var CoinGroup=function(e){function t(){var t=e.call(this)||this;return t.goldDownGroup=new eui.Group,t.coinNum=0,ObserverManager.instance.addEventListener(GameEvent.BROKEN_BOX,t.goldenRain,t),t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.initGroup()},t.prototype.initGroup=function(){ConfigManager.instance.load("ninja_coin_json");for(var e=ConfigManager.instance.datas,t=Object.keys(e),i=0;i<t.length;i++){var n=e[t[i]],r=n.type,o=void 0,a=n.distance[0][0],s=n.distance[0][1];if(r==ObstacleType.block)n.rotation||n.rotation_angle?(o=RoteBlockObject.produce(n),this.addChild(o),Scene.roteBlockArray.push(o)):(o=BlockObject.produce(n),this.addChild(o),Scene.blockArray.push(o));else if(r===ObstacleType.pole)o=new Pole(n),this.addChild(o);else if(r===ObstacleType.blade)o=Blade.creat(n),this.addChild(o);else if(r===ObstacleType.swingBlade)o=SwingBlade.creat(n),this.addChild(o);else if(r===ObstacleType.spikes){var l=SpikesManage.instance.creatSpikes(a,s,Dir.RIGHT,n.width,!1,n.scale);DisplayerToCanvas.add.apply(DisplayerToCanvas,[this,null].concat(l))}else if(r===ObstacleType.endPoint)this.endPoint=new EndPoint("goalmarker_png"),this.endPoint.x=a,this.endPoint.y=s,this.addChild(this.endPoint);else if(r===ObstacleType.door)o=new eui.Image("gate_png"),o.x=a,o.y=s,o.rotation=n.rotation,this.addChild(o);else if(r==ObstacleType.enemy){var c=Soldiers.produce(n.source);c.x=a,c.y=s,this.addChild(c),Soldiers.enemyArray.push(c)}else if(r==ObstacleType.coin){var h=Coin.produce(n.source);h.x=a,h.y=s,this.addChild(h),Scene.coinArray.push(h)}else if(r==ObstacleType.coinBox){var p=new GoldBox;p.init(),p.x=a,p.y=s,this.addChild(p),GoldBox.goldBoxArray.push(p),GameConst.BASE_SPEED=0}}},t.prototype.clear=function(){for(var e=0;e<this.numChildren;e++){var t=this.getChildAt(e);t instanceof Coin&&(t.visible=!1)}},t.prototype.show=function(){for(var e=0;e<this.numChildren;e++){var t=this.getChildAt(e);t instanceof Coin&&(t.visible=!0)}},t.prototype.goldenRain=function(){var e=this;this.timer=egret.setInterval(function(){if(e.coinNum<100){var t=e.createGold("coin_png");e.goldDownGroup.addChild(t),e.coinNum++,Scene.coinArray.push(t)}},this,100),egret.setTimeout(function(){egret.clearInterval(e.timer)},this,5e3)},t.prototype.createGold=function(e){var t=this,i=Coin.produce(e);return i||(i=new Coin(e),i.scaleY=1,i.scaleX=1),i.x=Math.ceil(500*Math.random())+105,i.y=-200,egret.Tween.get(i).to({y:GameConst.totalLen},1e4,egret.Ease.cubicIn).call(function(){Coin.reclain(i),i.parent.removeChild(i),t.coinNum--,Scene.coinArray.shift()}),i},t}(eui.Group);__reflect(CoinGroup.prototype,"CoinGroup");var EndlessItemGroup=function(e){function t(t){var i=e.call(this)||this;return i.height=1334,i.width=750,i.config=t,i}return __extends(t,e),t.prototype.addConfig=function(e){ConfigManager.instance.load(e?e:this.config);for(var t=ConfigManager.instance.datas,i=Object.keys(t),n=0;n<i.length;n++){var r=t[i[n]],o=r.type,a=void 0,s=r.distance[0][0],l=r.distance[0][1];if(o==ObstacleType.block)r.rotation||r.rotation_angle?(a=RoteBlockObject.produce(r),this.addChild(a),Scene.roteBlockArray.push(a)):(a=BlockObject.produce(r),this.addChild(a),Scene.blockArray.push(a));else if(o===ObstacleType.pole)a=new Pole(r),this.addChild(a);else if(o===ObstacleType.blade)a=Blade.creat(r),this.addChild(a);else if(o===ObstacleType.swingBlade)a=SwingBlade.creat(r),this.addChild(a);else if(o===ObstacleType.spikes){var c=void 0;switch(r.rotation_angle){case 0:c=0;break;case 90:c=3;break;case 180:c=1;break;case 270:c=2}var h=SpikesManage.instance.creatSpikes2(s,l,c,r.width,!1,r.scale);DisplayerToCanvas.add.apply(DisplayerToCanvas,[this,null].concat(h))}else if(o===ObstacleType.door)a=new eui.Image("gate_png"),a.x=s,a.y=l,a.rotation=r.rotation,this.addChild(a);else if(o==ObstacleType.enemy){var p=Soldiers.produce(r.source);p.initHp(),p.x=s-40,p.y=l-48,this.addChild(p),Soldiers.enemyArray.push(p)}}},t.reclaim=function(e){for(var t=0;t<e.numChildren;t++){var i=e.getChildAt(t);if(i instanceof Spikes)for(var n=0;n<Scene.trapsArray.length;n++)Scene.trapsArray[n].$hashCode!=i.$hashCode||(Scene.trapsArray.splice(n,1),Spikes.reclaim(i));else if(i instanceof Blade)for(var n=0;n<Scene.trapsArray.length;n++)Scene.trapsArray[n].$hashCode!=i.$hashCode||(Scene.trapsArray.splice(n,1),Blade.reclaim(i));else{if(i instanceof SwingBlade){SwingBlade.reclaim(i),e.removeChild(i),t--;continue}if(i instanceof RoteBlockObject)for(var n=0;n<Scene.roteBlockArray.length;n++)Scene.roteBlockArray[n].$hashCode!=i.$hashCode||(Scene.roteBlockArray.splice(n,1),RoteBlockObject.reclaim(i));else if(i instanceof Soldiers)for(var n=0;n<Soldiers.enemyArray.length;n++)Soldiers.enemyArray[n].$hashCode!=i.$hashCode||(i.pause(),Soldiers.enemyArray.splice(n,1),Soldiers.reclaim(i));else if(i instanceof Coin)for(var n=0;n<Scene.coinArray.length;n++)Scene.coinArray[n].$hashCode!=i.$hashCode||(Scene.coinArray.splice(n,1),Coin.reclain(i));else if(i instanceof BlockObject)for(var n=0;n<Scene.blockArray.length;n++)Scene.blockArray[n].$hashCode!=i.$hashCode||(Scene.blockArray.splice(n,1),BlockObject.reclaim(i))}}e.removeChildren()},t}(eui.Group);__reflect(EndlessItemGroup.prototype,"EndlessItemGroup");var EndlessLevel=function(e){function t(){var t=e.call(this)||this;return t.list=[],t.listLength=3,t.stop=!1,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.height=4002,this.init(),this.addEventListener(egret.Event.ENTER_FRAME,this.update,this),ObserverManager.instance.addEventListener(GameEvent.ROLE_DEAD,this.stopSlide,this)},t.prototype.init=function(){this.stop=!1;for(var e=0;e<this.listLength;e++){var t=new EndlessItemGroup("ninja_endless0"+(e+1)+"_json");t.y=0-1334*e,this.addChild(t),this.list.push(t)}},t.prototype.update=function(){if(!this.stop)for(var e=0;e<this.list.length;e++){var t=this.list[e],i=t.localToGlobal().y;if(i>1334){var n=this.findFirst();return t.y=n.y-1334,EndlessItemGroup.reclaim(t),void t.addConfig("ninja_endless0"+(e+1)+"_json")}var r=ObserverManager.getMediator(SceneMediator),o=r.getScene().playerIcon;GameConst.IS_SLIDE&&(o.localToGlobal().y<=GameConst.SCREEN_HEIGHT/4?o.velocity[1]>=0?GameConst.SLIDE_SPEED=GameConst.BASE_SPEED:GameConst.SLIDE_SPEED=-o.velocity[1]:GameConst.SLIDE_SPEED=GameConst.BASE_SPEED,this.y+=GameConst.SLIDE_SPEED*Scene.factor,o.y+=GameConst.SLIDE_SPEED*Scene.factor)}},t.prototype.findFirst=function(){for(var e=this.list[0],t=0;t<this.list.length;t++){var i=this.list[t];i.y<e.y&&(e=i)}return e},t.prototype.stopSlide=function(){this.stop=!0},t}(eui.Group);__reflect(EndlessLevel.prototype,"EndlessLevel");var LevelGroup=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.initGroup()},t.prototype.initGroup=function(){this.height=GameConst.totalLen,ConfigManager.instance.load("ninja_cofig02_json");for(var e=ConfigManager.instance.datas,i=Object.keys(e),n=0;n<i.length;n++){var r=e[i[n]],o=r.type,a=void 0,s=r.distance[0][0],l=r.distance[0][1];if(o==ObstacleType.block)r.rotation||r.rotation_angle?(a=RoteBlockObject.produce(r),this.addChild(a),Scene.roteBlockArray.push(a)):(a=BlockObject.produce(r),this.addChild(a),Scene.blockArray.push(a));else if(o===ObstacleType.pole)a=new Pole(r),this.addChild(a);else if(o===ObstacleType.blade)a=Blade.creat(r),this.addChild(a),a.anchorOffsetX=a.width/2,a.anchorOffsetY=a.height/2;else if(o===ObstacleType.swingBlade)a=SwingBlade.creat(r),this.addChild(a);else if(o===ObstacleType.spikes){var c=void 0;switch(r.rotation_angle){case 0:c=0;break;case 90:c=3;break;case 180:c=1;break;case 270:c=2}var h=SpikesManage.instance.creatSpikes2(s,l,c,r.width,!1,r.scale);DisplayerToCanvas.add.apply(DisplayerToCanvas,[this,null].concat(h))}else if(o===ObstacleType.endPoint)t.endPoint=new EndPoint("goalmarker_png"),t.endPoint.x=s,t.endPoint.y=l,this.addChild(t.endPoint);else if(o===ObstacleType.door)a=new eui.Image("gate_png"),a.x=s,a.y=l,a.rotation=r.rotation,this.addChild(a);else if(o==ObstacleType.enemy){var p=Soldiers.produce(r.source);p.x=s,p.y=l,this.addChild(p),Soldiers.enemyArray.push(p)}else if(o==ObstacleType.coin){var u=Coin.produce(r.source);u.x=s-40,u.y=l-40,this.addChild(u),Scene.coinArray.push(u)}}},t.prototype.clear=function(){for(var e=0;e<this.numChildren;e++){var i=this.getChildAt(e);(i instanceof Spikes||i instanceof Soldiers||i instanceof BlockObject||i instanceof RoteBlockObject||i instanceof Blade||i instanceof SwingBlade)&&(i.visible=!1)}t.endPoint&&(t.endPoint.visible=!1)},t.prototype.disponse=function(){for(var e=0;e<Scene.coinArray.length;e++){var t=Scene.coinArray[e];t.parent.removeChild(t),Coin.reclain(t),Scene.coinArray.splice(e,1)}},t.prototype.show=function(){for(var e=0;e<this.numChildren;e++){var i=this.getChildAt(e);(i instanceof Spikes||i instanceof Soldiers||i instanceof BlockObject||i instanceof RoteBlockObject||i instanceof Blade||i instanceof SwingBlade)&&(i.visible=!0)}t.endPoint&&(t.endPoint.visible=!0)},t}(eui.Group);__reflect(LevelGroup.prototype,"LevelGroup");var PlayerAction;!function(e){e.STAND="playerActionStand_png",e.SQUAT="playerActionSquat_png",e.JUMP="playerActionJump_png",e.HAND_WALL="playerActionHand_wall_png",e.HANG_CEILING="playerActionHang_ceiling_png"}(PlayerAction||(PlayerAction={}));var GAME_MODEL="",Scene=function(e){function t(){var i=e.call(this)||this;return i.start=!1,i.jumani=!1,i.jumpDuration=0,i.jumpCount=0,i.touchBeginX=0,i.touchBeginY=0,i.bulletTimeIcon=new eui.Image,i.arrowIcon=new eui.Image,i.aniGroup=new eui.Group,i._isStart=!1,i.velocity=[0,0],i.line=new egret.Shape,i.score=0,i.maxh=GameConst.totalLen,i.isAttackbox=!1,i.killScore=0,i.list=[],i.listLength=3,i.skinName=scene,i.touchEnabled=!1,t.blockArray=[],t.roteBlockArray=[],t.trapsArray=[],Soldiers.enemyArray=[],i}return __extends(t,e),t.prototype.showAdd=function(){Adevertisement.showAdd(this)},t.prototype.restScene=function(){"coin"==GAME_MODEL&&this.coin.show(),"level"==GAME_MODEL&&this.level.show(),this.group.height=GameConst.totalLen,this.group.y=GameConst.SCREEN_HEIGHT-GameConst.totalLen,GameConst.IS_SLIDE=!1,this.playerIcon.x=400,this.playerIcon.y=GameConst.totalLen-GameConst.SCREEN_HEIGHT+1110,this.playerIcon.visible=!0,this.playerIcon.role.source="playerActionStand_png",this.jumpCount=0,this.start=!1,this.arrowIcon.scaleY=0,this.bulletTimeIcon.visible=!1,BrickGroup.instance.initWall(),this.score=0,this.scoreLable.text=this.score+"",this.maxh=GameConst.totalLen,this.killScore=0},t.prototype.initUI=function(){GameConst.totalLen=8e3,this.goldmodel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.goldGame,this),this.levelmodel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.levelGame,this),this.killmodel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.endlessGame,this),BrickGroup.instance.initWall(),DisplayerToCanvas.add.apply(DisplayerToCanvas,[this.group,null].concat(BrickGroup.instance.lArr)),DisplayerToCanvas.add.apply(DisplayerToCanvas,[this.group,null].concat(BrickGroup.instance.rArr)),this.group.y=GameConst.SCREEN_HEIGHT-GameConst.totalLen;for(var e=ConfigManager.instance.datas,i=Object.keys(e),n=0;n<i.length;n++){var r=e[i[n]],o=r.type,a=void 0,s=r.distance[0][0],l=r.distance[0][1];o==ObstacleType.block?r.rotation||r.rotation_angle?(a=RoteBlockObject.produce(r),this.group.addChild(a),t.roteBlockArray.push(a)):(a=BlockObject.produce(r),this.group.addChild(a),a.y=GameConst.totalLen-40,t.blockArray.push(a)):o===ObstacleType.door&&(a=new eui.Image("gate_png"),a.x=s,a.y=GameConst.totalLen-l,a.rotation=r.rotation,this.group.addChild(a))}this.creatTimer(),GameUtil.playerMaxScore=GameUtil.getPlayerScore(),GameUtil.playerMaxScore||(GameUtil.playerMaxScore=0),this.maxScore.text=Math.floor(GameUtil.playerMaxScore)+"",this.addChild(this.scoreGroup),this.sunRise()},t.prototype.sunRise=function(e){if(!e&&0!=e){var t=new Date;e=t.getHours()}17>=e&&e>=6?(this.sun.source="sun_png",this.maskRect1.fillColor=16053214):(this.sun.source="moon_png",this.maskRect1.fillColor=2106206),this.sun.x=GameUtil.retSunPos(e).x,this.sun.y=GameUtil.retSunPos(e).y,this.maskRect1.fillAlpha=GameUtil.retAlpha(e)},t.prototype.goldGame=function(){var e=this;this.menuGroup.visible=!1,GAME_MODEL="coin",egret.Tween.get(this.maskRect).to({fillAlpha:1},600).call(function(){e.initConfig(),e.coin=new CoinGroup,e.group.addChild(e.coin),e.group.addChild(e.coin.goldDownGroup),e.group.addChild(e.playerIcon)
}).to({fillAlpha:0},600).call(function(){e.addEventListener(egret.Event.ENTER_FRAME,e.onEnterFrame,e),e.group.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.onTouchBegin,e),e.group.addEventListener(egret.TouchEvent.TOUCH_MOVE,e.onTouchMove,e),e.group.addEventListener(egret.TouchEvent.TOUCH_END,e.onTouchEnd,e)})},t.prototype.levelGame=function(){var e=this;this.menuGroup.visible=!1,GAME_MODEL="level",egret.Tween.get(this.maskRect).to({fillAlpha:1},600).call(function(){e.initConfig(),e.level=new LevelGroup,e.group.addChild(e.level),e.level.y=GameConst.totalLen-e.level.height,e.group.addChild(e.playerIcon)}).to({fillAlpha:0},600).call(function(){e.addEventListener(egret.Event.ENTER_FRAME,e.onEnterFrame,e),e.group.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.onTouchBegin,e),e.group.addEventListener(egret.TouchEvent.TOUCH_MOVE,e.onTouchMove,e),e.group.addEventListener(egret.TouchEvent.TOUCH_END,e.onTouchEnd,e)})},t.prototype.endlessGame=function(){var e=this;this.menuGroup.visible=!1,GAME_MODEL="endless",GameConst.totalLen=4002,BrickGroup.instance.initWall(),DisplayerToCanvas.add.apply(DisplayerToCanvas,[this.group,null].concat(BrickGroup.instance.lArr)),DisplayerToCanvas.add.apply(DisplayerToCanvas,[this.group,null].concat(BrickGroup.instance.rArr)),this.group.y=GameConst.SCREEN_HEIGHT-GameConst.totalLen,egret.Tween.get(this.maskRect).to({fillAlpha:1},600).call(function(){e.initConfig(),e.createEndlessGroup(),e.group.addChild(e.playerIcon)}).to({fillAlpha:0},600).call(function(){e.addEventListener(egret.Event.ENTER_FRAME,e.onEnterFrame,e),e.group.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.onTouchBegin,e),e.group.addEventListener(egret.TouchEvent.TOUCH_MOVE,e.onTouchMove,e),e.group.addEventListener(egret.TouchEvent.TOUCH_END,e.onTouchEnd,e)})},t.prototype.showMenu=function(){var e=this;egret.Tween.get(this.maskRect).to({fillAlpha:1},600).call(function(){e.restScene(),e.resetScene(),e.playerIcon.visible=!0,e.menuGroup.visible=!0,e.addChild(e.menuGroup)}).to({fillAlpha:0},600)},t.prototype.resetScene=function(){"coin"==GAME_MODEL?this.coin.clear():(GAME_MODEL="level")&&this.level.clear()},t.prototype.initConfig=function(){if(this.playerIcon=PlayerIcon.instance,this.playerIcon.x=400,this.playerIcon.y=GameConst.totalLen-GameConst.SCREEN_HEIGHT+1100,this.arrowIcon.source=RES.getRes("chest_swipe_png"),this.arrowIcon.scaleX=.3,this.arrowIcon.scaleY=0,this.arrowIcon.anchorOffsetY=382,this.arrowIcon.anchorOffsetX=215,this.arrowIcon.x=this.playerIcon.x+this.playerIcon.width/2,this.arrowIcon.y=this.playerIcon.y+this.playerIcon.height/2,this.bulletTimeIcon.source=RES.getRes("diamond_2_png"),this.bulletTimeIcon.anchorOffsetX=84.5,this.bulletTimeIcon.anchorOffsetY=84.5,this.bulletTimeIcon.x=this.playerIcon.x+this.playerIcon.width/2,this.bulletTimeIcon.y=this.playerIcon.y+this.playerIcon.height/2,this.bulletTimeIcon.visible=!1,this.landEffect=CommonUtil.createAnimation("landEffect",function(){this.landEffect.visible=!1},this),this.group.addChild(this.bulletTimeIcon),this.deadParticle=new particle.GravityParticleSystem(RES.getRes("deadParticle_png"),RES.getRes("deadParticle_json")),this.deadParticle.visible=!1,this.deadParticle.x=-520,this.deadParticle.y=-520,this.aniGroup.addChild(this.deadParticle),this.group.height=GameConst.totalLen,this.group.y=GameConst.SCREEN_HEIGHT-GameConst.totalLen,"endless"!=GAME_MODEL){var e=BlockObject.produce("wall_png");e.horizontalCenter=0,e.y=-120,e.rotation=90,this.group.addChild(e),t.blockArray.push(e)}var i=new eui.Group;this.addChild(i),i.y=GameConst.SCREEN_HEIGHT-23,i.horizontalCenter=0,i.width=GameConst.SCREEN_WIDTH;var n=SpikesManage.instance.creatSpikes(0,0,Dir.TOP,GameConst.SCREEN_WIDTH,!1,1);DisplayerToCanvas.add.apply(DisplayerToCanvas,[i,null].concat(n)),this.addChild(this.group),this.addChild(this.maskRect),this.group.addChild(this.aniGroup),this.group.addChild(this.arrowIcon),this.group.addChild(this.playerIcon)},t.prototype.onEnterFrame=function(){this.group.y>=0&&"endless"!=GAME_MODEL&&(GameConst.IS_SLIDE=!1),this.sunRise(),this._isStart&&(this.playerIcon.x+=(this.playerIcon.velocity[0]+this.velocity[0])*t.factor,this.playerIcon.y+=(this.playerIcon.velocity[1]+this.velocity[1])*t.factor,this.playerIcon.velocity[1]+=this.playerIcon.roleAy*t.factor,this.playerIcon.localToGlobal().y<=2*GameConst.SCREEN_HEIGHT/5?this.playerIcon.velocity[1]>=0?GameConst.SLIDE_SPEED=GameConst.BASE_SPEED:GameConst.SLIDE_SPEED=-this.playerIcon.velocity[1]:GameConst.SLIDE_SPEED=GameConst.BASE_SPEED,this.update(),"endless"==GAME_MODEL&&this.updateEndless(),this.playerIcon.x<=65&&(this.stopBulletTime(),this.standRight()),this.playerIcon.x>=630&&(this.stopBulletTime(),this.standLeft()),this.playerIcon.y<=75&&"endless"!=GAME_MODEL&&(this.stopBulletTime(),this.standBottom()),egret.Tween.TIMESCALE=t.factor,this.aniGroup.x=this.playerIcon.x+this.playerIcon.width/2,this.aniGroup.y=this.playerIcon.y+this.playerIcon.height/2,this.arrowIcon.x=this.playerIcon.x+this.playerIcon.width/2,this.arrowIcon.y=this.playerIcon.y+this.playerIcon.height/2,this.bulletTimeIcon.x=this.playerIcon.x+this.playerIcon.width/2,this.bulletTimeIcon.y=this.playerIcon.y+this.playerIcon.height/2,this.enemyAi(),this.updateScore(),GameConst.IS_SLIDE&&(this.group.y+=GameConst.SLIDE_SPEED*t.factor,BrickGroup.instance.updateWall()))},t.prototype.onTouchBegin=function(e){this.touchBeginX=e.stageX,this.touchBeginY=e.stageY,"coin"==GAME_MODEL&&(this.arrowIcon.visible=!1)},t.prototype.onTouchMove=function(e){if(!(this.jumpCount>=GameConst.JUMP_TIME)){"coin"!=GAME_MODEL&&(this.arrowIcon.visible=!0),(1==this.jumpCount||2==this.jumpCount)&&(this.bulletTimeIcon.visible=!0,t.factor=.2),egret.Tween.get(this.bulletTimeIcon,{loop:!0}).to({scaleX:.5},80).to({scaleY:.8},100);var i=(this.playerIcon.localToGlobal(),e.stageX-this.touchBeginX),n=e.stageY-this.touchBeginY,r=Math.atan2(n,i),o=Math.sqrt(Math.pow(n,2)+Math.pow(i,2)),a=n/o,s=Math.acos(a);this.angle=180/(Math.PI/s),0>i?this.angle=-this.angle:0==n&&0>i&&(this.angle=180),this.arrowIcon.rotation=180-this.angle;var l=Math.sqrt(i*i+n*n);l>200&&(l=200),this.arrowIcon.scaleY=.005*l,this.clearShape(),"coin"==GAME_MODEL&&this.drawLines(r,l)}},t.prototype.drawLines=function(e,t){for(var i,n=t*Math.cos(e)*.15*.5,r=t*Math.sin(e)*.2*.5,o=0,a=5,s=this.playerIcon.x+this.playerIcon.width/2,l=this.playerIcon.y+this.playerIcon.height/2,c=0,h=0;s>=-300&&1100>=s&&1334>h;){var p=this.playerIcon.x+n*o+this.playerIcon.width/2,u=this.playerIcon.y+r*o+.5*GameConst.ACC_SPEED*o*o+this.playerIcon.height/2;c=this.playerIcon.localToGlobal().y+.5*GameConst.ACC_SPEED*o*o+this.playerIcon.height/2,i=Math.sqrt(n*n+(r+GameConst.ACC_SPEED*o)*(r+GameConst.ACC_SPEED*o)),o+=0==i?Math.sqrt(2*a/GameConst.ACC_SPEED):a/i;var d=this.playerIcon.x+n*o+this.playerIcon.width/2,y=this.playerIcon.y+r*o+.5*GameConst.ACC_SPEED*o*o+this.playerIcon.height/2;h=this.playerIcon.localToGlobal().y+.5*GameConst.ACC_SPEED*o*o+this.playerIcon.height/2,s=d,l=y,this.line.graphics.lineStyle(2,65280),this.line.graphics.moveTo(p,u),this.line.graphics.lineTo(d,y),this.line.graphics.endFill(),i=Math.sqrt(n*n+(r+GameConst.ACC_SPEED*o)*(r+GameConst.ACC_SPEED*o)),o+=0==i?Math.sqrt(2*a/GameConst.ACC_SPEED):a/i,s+=n*o,l+=r*o+.5*GameConst.ACC_SPEED*o*o,h+=r*o+.5*GameConst.ACC_SPEED*o*o}this.line.height<3e3&&this.group.addChild(this.line)},t.prototype.clearShape=function(){this.line.graphics.clear()},t.prototype.onTouchEnd=function(e){var i=e.stageX-this.touchBeginX,n=e.stageY-this.touchBeginY,r=Math.sqrt(i*i+n*n);if(!(20>=r||(this.clearShape(),this.jumpCount>=GameConst.JUMP_TIME))){this._isStart||(this._isStart=!0),ObserverManager.sendNotification(GameEvent.START),egret.Tween.removeTweens(this.bulletTimeIcon),this.arrowIcon.scaleY=0;var o=new egret.Point(e.stageX,e.stageY);t.factor=1,this.bulletTimeIcon.visible=!1;var a=o.x-this.touchBeginX;this.jumani=!1,egret.Tween.get(this.playerIcon.role).to({rotation:360},200).to({rotation:720},200).call(function(){this.playerIcon.role.source=PlayerAction.JUMP},this),r>200&&(r=200);var s=Math.atan2(n,i),l=r*Math.cos(s)*.15*.5,c=r*Math.sin(s)*.2*.5;this.playerIcon.velocity=[l,c],this.playerIcon.roleAy=GameConst.ACC_SPEED,this.dirHandle(a)}},t.prototype.dirHandle=function(e){return this.playerIcon.role.source==PlayerAction.STAND&&this.playerIcon.velocity[1]>0?(this.playerIcon.velocity[1]=0,void this.sault()):this.playerIcon.role.source==PlayerAction.HANG_CEILING&&this.playerIcon.velocity[1]<0?(this.playerIcon.velocity[1]=0,void this.sault()):this.playerIcon.role.source==PlayerAction.HAND_WALL&&1==this.playerIcon.role.scaleX&&this.playerIcon.velocity[0]<0?(this.playerIcon.velocity[0]=0,void this.sault()):this.playerIcon.role.source==PlayerAction.HAND_WALL&&-1==this.playerIcon.role.scaleX&&this.playerIcon.velocity[0]>0?(this.playerIcon.velocity[0]=0,void this.sault()):(this.jumpCount++,this.playerIcon.roleAy=.2,this.playerIcon.role.scaleX=e>0?1:-1,void(this.playerIcon.role.source=PlayerAction.SQUAT))},t.prototype.sault=function(){var e=this;egret.Tween.get(this.playerIcon.role).to({rotation:360},200).to({rotation:720},200).call(function(){for(var i=0;i<t.blockArray.length;i++){var n=t.blockArray[i];if(GameUtil.isHit(e.playerIcon,n)||e.playerIcon.x<=65||e.playerIcon.x>=630||e.playerIcon.y<=75)return e.playerIcon.roleAy=0,void(e.playerIcon.velocity=[0,0]);e.playerIcon.roleAy=.2}})},t.prototype.updateScore=function(){this.playerIcon.y<this.maxh&&(this.score+=Math.floor(this.maxh-this.playerIcon.y+this.killScore),this.maxh=this.playerIcon.y),this.killScore=0,this.scoreLable.text=this.score+""},t.prototype.playLandEffect=function(){this.landEffect.x=0,this.landEffect.y=0,this.landEffect.visible=!0,this.landEffect.animation.play("landEffect",1),this.aniGroup.addChild(this.landEffect)},t.prototype.standLeft=function(e){this.playerIcon.x<=75||(this.jumani||this.playLandEffect(),this.playerIcon.roleAy=0,this.jumani=!0,this.playerIcon.role.rotation=0,this.playerIcon.role.source!=PlayerAction.HAND_WALL&&(egret.Tween.removeTweens(this.playerIcon.role),this.goBackTicket(this.playerIcon.velocity[0],this.playerIcon.velocity[1]),this.playerIcon.velocity=[0,0],this.playerIcon.role.source=PlayerAction.HAND_WALL),this.playerIcon.role.scaleX=-1,this.playerIcon.rotation=0,this.jumpCount=0)},t.prototype.standRight=function(e){this.playerIcon.x>=620||(this.jumani||this.playLandEffect(),this.jumani=!0,this.playerIcon.roleAy=0,this.playerIcon.role.rotation=0,this.playerIcon.role.source!=PlayerAction.HAND_WALL&&(egret.Tween.removeTweens(this.playerIcon.role),this.goBackTicket(this.playerIcon.velocity[0],this.playerIcon.velocity[1]),this.playerIcon.velocity=[0,0],this.playerIcon.role.source=PlayerAction.HAND_WALL),this.playerIcon.role.scaleX=1,this.playerIcon.rotation=0,this.jumpCount=0)},t.prototype.standTop=function(){this.jumani||this.playLandEffect(),this.jumani=!0,this.playerIcon.roleAy=0,this.playerIcon.role.rotation=0,this.playerIcon.role.source!=PlayerAction.STAND&&(egret.Tween.removeTweens(this.playerIcon.role),this.goBackTicket(this.playerIcon.velocity[0],this.playerIcon.velocity[1]),this.playerIcon.velocity=[0,0],this.playerIcon.role.source=PlayerAction.STAND),this.playerIcon.velocity[1]=0,this.playerIcon.rotation=0,this.jumpCount=0},t.prototype.standBottom=function(){this.jumani||this.playLandEffect(),this.jumani=!0,this.playerIcon.roleAy=0,this.playerIcon.role.rotation=0,this.playerIcon.role.source!=PlayerAction.HANG_CEILING&&(egret.Tween.removeTweens(this.playerIcon.role),this.goBackTicket(this.playerIcon.velocity[0],this.playerIcon.velocity[1]),this.playerIcon.velocity=[0,0],this.playerIcon.role.source=PlayerAction.HANG_CEILING),this.jumpCount=0},t.prototype.arrive=function(){var e=new RestartGameUI("pass");e.visible=!0,e.horizontalCenter=0,this.parent.addChild(e),this.start=!0,this.playerIcon.roleAy=GameConst.ACC_SPEED,GameUtil.playerMaxScore<this.score&&(GameUtil.playerMaxScore=this.score,GameUtil.setPlayerScore(this.score)),this.maxScore.text=Math.floor(GameUtil.playerMaxScore)+""},t.prototype.restart=function(){var e=new RestartGameUI("failed");e.visible=!0,t.factor=1,egret.Tween.TIMESCALE=t.factor,e.horizontalCenter=0,this.parent.addChild(e),this.start=!0,this.arrowIcon.visible=this.bulletTimeIcon.visible=!1,this.playerIcon.roleAy=GameConst.ACC_SPEED,this._isStart=!1,GameUtil.playerMaxScore<this.score&&(GameUtil.playerMaxScore=this.score,GameUtil.setPlayerScore(this.score)),this.maxScore.text=Math.floor(GameUtil.playerMaxScore)+""},t.prototype.stopBulletTime=function(){t.factor=1,this.bulletTimeIcon.visible=this.arrowIcon.visible=!1},t.prototype.goBackTicket=function(e,t){this.playerIcon.x-=e,this.playerIcon.y-=t},t.prototype.update=function(){this.trapHitTest(),this.roteBlockHitTest(),this.enemyHitTest();for(var e=0;e<t.blockArray.length;e++){var i=t.blockArray[e];GameUtil.blockhitTest(this.playerIcon,i,this)}this.coinHitTest(),"coin"!=GAME_MODEL&&LevelGroup.endPoint&&GameUtil.hitTest(this.playerIcon,LevelGroup.endPoint)&&(this.start||(this.playerIcon.velocity=[0,0],ObserverManager.instance.dispatchEventWith(GameEvent.ARRIVE_END)));for(var e=0;e<GoldBox.goldBoxArray.length;e++){var n=GoldBox.goldBoxArray[e];GameUtil.enemyHittest(this.playerIcon,n)?this.isAttackbox||(this.playerIcon.playAttackAni(),ObserverManager.instance.dispatchEventWith(GameEvent.ATTCK_BOX),this.isAttackbox=!0):this.isAttackbox=!1}for(var e=0;e<Soldiers.bulletArray.length;e++){var r=Soldiers.bulletArray[e];GameUtil.hitTest(this.playerIcon,r)&&(r&&r.parent&&r.parent.removeChild(r),Bullet.reclaim(r),Soldiers.bulletArray.splice(e,1),ObserverManager.instance.dispatchEventWith(GameEvent.ROLE_DEAD),this.goBackTicket(this.playerIcon.velocity[0],this.playerIcon.velocity[1]),this.playerIcon.velocity=[0,0],this.deadParticle.visible=!0,this.deadParticle.start(),this.deadParticle.emissionTime=500,this.playerIcon.visible=!1,egret.setTimeout(function(){this.deadParticle.visible=!1},this,2e3))}},t.prototype.trapHitTest=function(){for(var e=0;e<t.trapsArray.length;e++){var i=t.trapsArray[e];i&&GameUtil.hitTest(this.playerIcon,i,this)&&(this.start||(ObserverManager.instance.dispatchEventWith(GameEvent.ROLE_DEAD),this.goBackTicket(this.playerIcon.velocity[0],this.playerIcon.velocity[1]),this.playerIcon.velocity=[0,0],this.deadParticle.visible=!0,this.deadParticle.start(),this.deadParticle.emissionTime=500,this.playerIcon.visible=!1,egret.setTimeout(function(){this.deadParticle.visible=!1},this,2e3)))}},t.prototype.roteBlockHitTest=function(){for(var e=0;e<t.roteBlockArray.length;e++){var i=t.roteBlockArray[e];i&&GameUtil.roteRectHitTest(this.playerIcon,i,this)&&(i.isRote?(ObserverManager.instance.dispatchEventWith(GameEvent.ROLE_DEAD),this.goBackTicket(this.playerIcon.velocity[0],this.playerIcon.velocity[1]),this.playerIcon.velocity=[0,0],this.deadParticle.visible=!0,this.deadParticle.start(),this.deadParticle.emissionTime=500,this.playerIcon.visible=!1,egret.setTimeout(function(){this.deadParticle.visible=!1},this,2e3)):GameUtil.blockhitTest(this.playerIcon,i,this))}},t.prototype.coinHitTest=function(){for(var e=0;e<t.coinArray.length;e++){var i=t.coinArray[e];GameUtil.enemyHittest(this.playerIcon,i)&&(i.visible=!1)}},t.prototype.enemyHitTest=function(){for(var e=function(e){var i=Soldiers.enemyArray[e];GameUtil.enemyHittest(t.playerIcon,i)&&(i.visible&&(i.enemyDead(i),Soldiers.enemyArray.splice(e,1),Soldiers.reclaim(i),t.playerIcon.playAttackAni(),t.killScore=80),egret.setTimeout(function(){i.visible=!1},t,10))},t=this,i=0;i<Soldiers.enemyArray.length;i++)e(i)},t.prototype.enemyAi=function(){for(var e=0;e<Soldiers.enemyArray.length;e++){var t=Soldiers.enemyArray[e],i=t.localToGlobal(),n=this.playerIcon.localToGlobal(),r=i.x-n.x,o=i.y-n.y,a=Math.sqrt(Math.pow(r,2)+Math.pow(o,2)),s="";if(r>0&&(s="left"),0>r&&(s="right"),"attacking_enemy_0_png"==t.enemy.source&&80>a&&i.y>=n.y)ObserverManager.instance.dispatchEventWith(GameEvent.ARRIVE_SWORD_ENEMY,!1,{rangeType:"sowrd",scale:t.currentState,dir:s});else if("ranged_enemy_idle_png"!=t.enemy.source);else{var l={dir:s,scale:t.currentState,playerPoint:n,enemyPoint:i};t.sniperAttack(l,this.group)}}},t.prototype.playerBounce=function(e){var t=e.data;this.playerIcon.velocity[0]?this.playerIcon.velocity[0]=-this.playerIcon.velocity[0]:"left"==t.dir?(this.playerIcon.velocity[0]=-2,this.playerIcon.roleAy=.2,this.playerIcon.role.source=PlayerAction.SQUAT):"right"==t.dir&&(this.playerIcon.velocity[0]=2,this.playerIcon.roleAy=.2,this.playerIcon.role.source=PlayerAction.SQUAT)},t.prototype.createEndlessGroup=function(){for(var e=0;e<this.listLength;e++){var t=new EndlessItemGroup("ninja_endless0"+(e+1)+"_json");t.addConfig(),t.y=1334*(2-e),this.group.addChild(t),this.list.push(t)}},t.prototype.updateEndless=function(){for(var e=0;e<this.list.length;e++){var t=this.list[e],i=t.localToGlobal().y;if(i>1334){var n=this.findFirst();return t.y=n.y-1334,EndlessItemGroup.reclaim(t),void t.addConfig("ninja_endless0"+(e+1)+"_json")}}},t.prototype.findFirst=function(){for(var e=this.list[0],t=0;t<this.list.length;t++){var i=this.list[t];i.y<e.y&&(e=i)}return e},t.prototype.creatSnowflake=function(){var e=this,t=new egret.Shape;t.graphics.beginFill(16777215,1);var i=10+10*Math.random(),n=400+1200*Math.random();t.graphics.drawRect(0,0,i,i),t.graphics.endFill(),t.x=750,t.y=GameConst.totalLen-n,this.group.addChild(t);var r=-45+90*Math.random();t.rotation=r;var o=egret.Tween.get(t),a=200+300*Math.random()+t.y;o.to({x:0,y:a},3e3+2e3*Math.random()).call(function(){e.group.removeChild(t),t=null});var s=egret.Tween.get(t);s.to({alpha:0},4500+500*Math.random())},t.prototype.creatTimer=function(){var e=500+500*Math.random(),t=new egret.Timer(e,1);t.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),t.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.creatTimer,this),t.start()},t.prototype.timerFunc=function(){},t.prototype.enter=function(){},t.prototype.exit=function(){},t.prototype.addHitTest=function(){},t.blockArray=[],t.roteBlockArray=[],t.coinArray=[],t.trapsArray=[],t.factor=1,t}(eui.Component);__reflect(Scene.prototype,"Scene");var SceneMediator=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.addGameEventListener=function(){this.addEventListener(GameEvent.HIT_LEFT_RECT,this.standLeft,this),this.addEventListener(GameEvent.HIT_RIGHT_RECT,this.standRight,this),this.addEventListener(GameEvent.HIT_BOTTOM_RECT,this.standBottom,this),this.addEventListener(GameEvent.HIT_TOP_RECT,this.standTop,this),this.addEventListener(GameEvent.START,this.startSlide,this),this.addEventListener(GameEvent.ROLE_DEAD,this.stopSlide,this),this.addEventListener(GameEvent.ARRIVE_END,this.arrive,this),this.addEventListener(GameEvent.ROLE_ATTCKED,this.playerBounce,this),this.addEventListener(GameEvent.SHOW_MUNE,this.showMenu,this)},t.prototype.initView=function(){this.gameScene=new TempScene,this.gameScene.initUI()},t.prototype.resetView=function(){this.gameScene.restScene()},t.prototype.startSlide=function(){GameConst.IS_SLIDE||(GameConst.IS_SLIDE=!0)},t.prototype.stopSlide=function(){GameConst.IS_SLIDE=!1,this.gameScene.restart()},t.prototype.onEnter=function(){ViewManager.instance.addElement(this.gameScene),this.gameScene.enter()},t.prototype.standLeft=function(e){this.gameScene.standLeft(e),this.gameScene.stopBulletTime()},t.prototype.standRight=function(e){this.gameScene.standRight(e),this.gameScene.stopBulletTime()},t.prototype.standTop=function(){this.gameScene.standTop(),this.gameScene.stopBulletTime()},t.prototype.standBottom=function(){this.gameScene.standBottom(),this.gameScene.stopBulletTime()},t.prototype.onExit=function(){this.gameScene.exit(),ViewManager.instance.removeElement(this.gameScene)},t.prototype.arrive=function(){this.gameScene.arrive()},t.prototype.playerBounce=function(e){"INVICIBLE"!=this.gameScene.playerIcon.state&&(GameConst.CURRENT_HP-=.2*GameConst.INIT_HP,this.gameScene.playerBounce(e))},t.prototype.showMenu=function(){this.gameScene.showMenu()},t.prototype.getScene=function(){return this.gameScene},t}(Mediator);__reflect(SceneMediator.prototype,"SceneMediator");var TempScene=function(e){function t(){var t=e.call(this)||this;return t.start=!1,t.jumani=!1,t.jumpDuration=0,t.jumpCount=0,t.touchBeginX=0,t.touchBeginY=0,t.bulletTimeIcon=new eui.Image,t.arrowIcon=new eui.Image,t.aniGroup=new eui.Group,t._isStart=!1,t.velocity=[0,0],t.line=new egret.Shape,t.isJumpFlag=!1,t.score=0,t.maxh=GameConst.totalLen,t.isAttackbox=!1,t.isdispatchFlag=!1,t.istrapBonus=!1,t.killScore=0,t.bulletFlag=!1,t.list=[],t.listLength=3,t.skinName=scene,t.touchEnabled=!1,Scene.blockArray=[],Scene.roteBlockArray=[],Scene.trapsArray=[],Soldiers.enemyArray=[],t}return __extends(t,e),t.prototype.showAdd=function(){Adevertisement.showAdd(this)},t.prototype.restScene=function(){"coin"==GAME_MODEL&&this.coin.show(),"level"==GAME_MODEL&&this.level.show(),this.group.height=GameConst.totalLen,this.group.y=GameConst.SCREEN_HEIGHT-GameConst.totalLen,GameConst.IS_SLIDE=!1,this.playerIcon.x=400,this.playerIcon.y=GameConst.totalLen-GameConst.SCREEN_HEIGHT+1110,this.playerIcon.visible=!0,this.playerIcon.role.source="playerActionStand_png",this.jumpCount=0,this.start=!1,this.arrowIcon.scaleY=0,this.bulletTimeIcon.visible=!1,BrickGroup.instance.initWall(),this.score=0,this.scoreLable.text=this.score+"",this.maxh=GameConst.totalLen,this.killScore=0,GameConst.CURRENT_HP=GameConst.INIT_HP,this.playerIcon.roleHp=GameConst.CURRENT_HP},t.prototype.initUI=function(){GameConst.totalLen=8e3,this.goldmodel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.goldGame,this),this.levelmodel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.levelGame,this),this.killmodel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.endlessGame,this),BrickGroup.instance.initWall(),DisplayerToCanvas.add.apply(DisplayerToCanvas,[this.group,null].concat(BrickGroup.instance.lArr)),DisplayerToCanvas.add.apply(DisplayerToCanvas,[this.group,null].concat(BrickGroup.instance.rArr)),this.group.y=GameConst.SCREEN_HEIGHT-GameConst.totalLen;for(var e=ConfigManager.instance.datas,t=Object.keys(e),i=0;i<t.length;i++){var n=e[t[i]],r=n.type,o=void 0,a=n.distance[0][0],s=n.distance[0][1];r==ObstacleType.block?n.rotation||n.rotation_angle?(o=RoteBlockObject.produce(n),this.group.addChild(o),Scene.roteBlockArray.push(o)):(o=BlockObject.produce(n),this.group.addChild(o),o.y=GameConst.totalLen-40,Scene.blockArray.push(o)):r===ObstacleType.door&&(o=new eui.Image("gate_png"),o.x=a,o.y=GameConst.totalLen-s,o.rotation=n.rotation,this.group.addChild(o))}this.creatTimer(),GameUtil.playerMaxScore=GameUtil.getPlayerScore(),GameUtil.playerMaxScore||(GameUtil.playerMaxScore=0),this.maxScore.text=Math.floor(GameUtil.playerMaxScore)+"",this.addChild(this.scoreGroup),this.addChild(this.playerDarts),this.sunRise()},t.prototype.sunRise=function(e){if(!e&&0!=e){var t=new Date;e=t.getHours()}17>=e&&e>=6?(this.sun.source="sun_png",this.maskRect1.fillColor=16053214):(this.sun.source="moon_png",this.maskRect1.fillColor=2106206),this.sun.x=GameUtil.retSunPos(e).x,this.sun.y=GameUtil.retSunPos(e).y,this.maskRect1.fillAlpha=GameUtil.retAlpha(e)},t.prototype.goldGame=function(){var e=this;this.menuGroup.visible=!1,GAME_MODEL="coin",egret.Tween.get(this.maskRect).to({fillAlpha:1},600).call(function(){e.initConfig(),e.coin=new CoinGroup,e.group.addChild(e.coin),e.group.addChild(e.coin.goldDownGroup),e.group.addChild(e.playerIcon)}).to({fillAlpha:0},600).call(function(){e.addEventListener(egret.Event.ENTER_FRAME,e.onEnterFrame,e),e.group.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.onTouchBegin,e),e.group.addEventListener(egret.TouchEvent.TOUCH_MOVE,e.onTouchMove,e),e.group.addEventListener(egret.TouchEvent.TOUCH_END,e.onTouchEnd,e)})},t.prototype.levelGame=function(){var e=this;this.menuGroup.visible=!1,GAME_MODEL="level",egret.Tween.get(this.maskRect).to({fillAlpha:1},600).call(function(){e.initConfig(),e.level=new LevelGroup,e.group.addChild(e.level),e.level.y=GameConst.totalLen-e.level.height,e.group.addChild(e.playerIcon)}).to({fillAlpha:0},600).call(function(){e.addEventListener(egret.Event.ENTER_FRAME,e.onEnterFrame,e),e.group.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.onTouchBegin,e),e.group.addEventListener(egret.TouchEvent.TOUCH_MOVE,e.onTouchMove,e),e.group.addEventListener(egret.TouchEvent.TOUCH_END,e.onTouchEnd,e)})},t.prototype.endlessGame=function(){var e=this;this.menuGroup.visible=!1,GAME_MODEL="endless",GameConst.totalLen=4002,BrickGroup.instance.initWall(),DisplayerToCanvas.add.apply(DisplayerToCanvas,[this.group,null].concat(BrickGroup.instance.lArr)),DisplayerToCanvas.add.apply(DisplayerToCanvas,[this.group,null].concat(BrickGroup.instance.rArr)),this.group.y=GameConst.SCREEN_HEIGHT-GameConst.totalLen,egret.Tween.get(this.maskRect).to({fillAlpha:1},600).call(function(){e.initConfig(),e.createEndlessGroup(),e.group.addChild(e.playerIcon)}).to({fillAlpha:0},600).call(function(){e.addEventListener(egret.Event.ENTER_FRAME,e.onEnterFrame,e),e.group.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.onTouchBegin,e),e.group.addEventListener(egret.TouchEvent.TOUCH_MOVE,e.onTouchMove,e),e.group.addEventListener(egret.TouchEvent.TOUCH_END,e.onTouchEnd,e)})},t.prototype.showMenu=function(){var e=this;egret.Tween.get(this.maskRect).to({fillAlpha:1},600).call(function(){e.restScene(),e.resetScene(),e.playerIcon.visible=!0,e.menuGroup.visible=!0,e.addChild(e.menuGroup)}).to({fillAlpha:0},600)},t.prototype.resetScene=function(){"coin"==GAME_MODEL?this.coin.clear():(GAME_MODEL="level")&&this.level.clear()},t.prototype.initConfig=function(){if(this.playerIcon=PlayerIcon.instance,this.playerIcon.x=400,this.playerIcon.y=GameConst.totalLen-GameConst.SCREEN_HEIGHT+1100,this.playerIcon.roleHp=GameConst.CURRENT_HP,this.arrowIcon.source=RES.getRes("chest_swipe_png"),this.arrowIcon.scaleX=.3,this.arrowIcon.scaleY=0,this.arrowIcon.anchorOffsetY=382,this.arrowIcon.anchorOffsetX=215,this.arrowIcon.x=this.playerIcon.x+this.playerIcon.width/2,this.arrowIcon.y=this.playerIcon.y+this.playerIcon.height/2,this.bulletTimeIcon.source=RES.getRes("diamond_2_png"),this.bulletTimeIcon.anchorOffsetX=84.5,this.bulletTimeIcon.anchorOffsetY=84.5,this.bulletTimeIcon.x=this.playerIcon.x+this.playerIcon.width/2,this.bulletTimeIcon.y=this.playerIcon.y+this.playerIcon.height/2,this.bulletTimeIcon.visible=!1,this.landEffect=CommonUtil.createAnimation("landEffect",function(){this.landEffect.visible=!1},this),this.group.addChild(this.bulletTimeIcon),this.deadParticle=new particle.GravityParticleSystem(RES.getRes("deadParticle_png"),RES.getRes("deadParticle_json")),this.deadParticle.visible=!1,this.deadParticle.x=-520,this.deadParticle.y=-520,this.aniGroup.addChild(this.deadParticle),this.group.height=GameConst.totalLen,this.group.y=GameConst.SCREEN_HEIGHT-GameConst.totalLen,"endless"!=GAME_MODEL){var e=BlockObject.produce("wall_png");e.horizontalCenter=0,e.y=-120,e.rotation=90,this.group.addChild(e),Scene.blockArray.push(e)}this.addChild(this.group),this.addChild(this.playerDarts),this.addChild(this.maskRect),this.group.addChild(this.aniGroup),this.group.addChild(this.arrowIcon),this.group.addChild(this.playerIcon)},t.prototype.onEnterFrame=function(){this.group.y>=0&&"endless"!=GAME_MODEL&&(GameConst.IS_SLIDE=!1),this.sunRise(),this._isStart&&(this.playerIcon.x+=(this.playerIcon.velocity[0]+this.velocity[0])*Scene.factor,this.playerIcon.y+=(this.playerIcon.velocity[1]+this.velocity[1])*Scene.factor,this.playerIcon.velocity[1]+=this.playerIcon.roleAy*Scene.factor,this.istrapBonus=!1,this.playerIcon.localToGlobal().y<=2*GameConst.SCREEN_HEIGHT/5?this.playerIcon.velocity[1]>=0?GameConst.SLIDE_SPEED=GameConst.BASE_SPEED:GameConst.SLIDE_SPEED=-this.playerIcon.velocity[1]:GameConst.SLIDE_SPEED=GameConst.BASE_SPEED,this.update(),"endless"==GAME_MODEL&&this.updateEndless(),this.playerIcon.x<=65&&(this.stopBulletTime(),this.standRight()),this.playerIcon.x>=630&&(this.stopBulletTime(),this.standLeft()),this.playerIcon.y<=75&&"endless"!=GAME_MODEL&&(this.stopBulletTime(),this.standBottom()),egret.Tween.TIMESCALE=Scene.factor,this.aniGroup.x=this.playerIcon.x+this.playerIcon.width/2,this.aniGroup.y=this.playerIcon.y+this.playerIcon.height/2,this.arrowIcon.x=this.playerIcon.x+this.playerIcon.width/2,this.arrowIcon.y=this.playerIcon.y+this.playerIcon.height/2,this.bulletTimeIcon.x=this.playerIcon.x+this.playerIcon.width/2,this.bulletTimeIcon.y=this.playerIcon.y+this.playerIcon.height/2,this.enemyAi(),this.updateScore(),GameConst.IS_SLIDE&&(this.group.y+=GameConst.SLIDE_SPEED*Scene.factor,BrickGroup.instance.updateWall()),this.playerIcon.roleHp=GameConst.CURRENT_HP,this.playerIcon.state=GameConst.INVICIBLE,this.playerIcon.updateHp(),this.playerIcon.roleHp<=0&&this.playerDead(),this.playerIcon.localToGlobal().y>GameConst.SCREEN_HEIGHT&&this.playerDead())},t.prototype.invicibleTime=function(){var e=this;"INVICIBLE"!=this.playerIcon.state&&(egret.Tween.get(this.playerIcon,{loop:!0}).to({alpha:.5},200).to({alpha:1},200),egret.setTimeout(function(){e.playerIcon.alpha=1,GameConst.INVICIBLE="NONE",egret.Tween.removeTweens(e.playerIcon)},this,2e3))},t.prototype.playerDead=function(){ObserverManager.instance.dispatchEventWith(GameEvent.ROLE_DEAD),this.goBackTicket(this.playerIcon.velocity[0],this.playerIcon.velocity[1]),this.playerIcon.velocity=[0,0],this.deadParticle.visible=!0,this.deadParticle.start(),this.deadParticle.emissionTime=500,this.playerIcon.visible=!1,egret.setTimeout(function(){this.deadParticle.visible=!1},this,2e3)},t.prototype.onTouchBegin=function(e){this.touchBeginX=e.stageX,this.touchBeginY=e.stageY,"coin"==GAME_MODEL&&(this.arrowIcon.visible=!1)},t.prototype.onTouchMove=function(e){if(!(this.jumpCount>=GameConst.JUMP_TIME)){"coin"!=GAME_MODEL&&(this.arrowIcon.visible=!0),(1==this.jumpCount||2==this.jumpCount)&&(this.bulletTimeIcon.visible=!0,Scene.factor=.2),egret.Tween.get(this.bulletTimeIcon,{loop:!0}).to({scaleX:.5},80).to({scaleY:.8},100);var t=(this.playerIcon.localToGlobal(),e.stageX-this.touchBeginX),i=e.stageY-this.touchBeginY,n=Math.atan2(i,t),r=Math.sqrt(Math.pow(i,2)+Math.pow(t,2)),o=i/r,a=Math.acos(o);this.angle=180/(Math.PI/a),0>t?this.angle=-this.angle:0==i&&0>t&&(this.angle=180),this.arrowIcon.rotation=180-this.angle;var s=Math.sqrt(t*t+i*i);s>200&&(s=200),this.arrowIcon.scaleY=.005*s,this.clearShape(),"coin"==GAME_MODEL&&this.drawLines(n,s)}},t.prototype.drawLines=function(e,t){for(var i,n=t*Math.cos(e)*.15*.5,r=t*Math.sin(e)*.2*.5,o=0,a=5,s=this.playerIcon.x+this.playerIcon.width/2,l=this.playerIcon.y+this.playerIcon.height/2,c=0,h=0;s>=-300&&1100>=s&&1334>h;){var p=this.playerIcon.x+n*o+this.playerIcon.width/2,u=this.playerIcon.y+r*o+.5*GameConst.ACC_SPEED*o*o+this.playerIcon.height/2;c=this.playerIcon.localToGlobal().y+.5*GameConst.ACC_SPEED*o*o+this.playerIcon.height/2,i=Math.sqrt(n*n+(r+GameConst.ACC_SPEED*o)*(r+GameConst.ACC_SPEED*o)),o+=0==i?Math.sqrt(2*a/GameConst.ACC_SPEED):a/i;var d=this.playerIcon.x+n*o+this.playerIcon.width/2,y=this.playerIcon.y+r*o+.5*GameConst.ACC_SPEED*o*o+this.playerIcon.height/2;h=this.playerIcon.localToGlobal().y+.5*GameConst.ACC_SPEED*o*o+this.playerIcon.height/2,s=d,l=y,this.line.graphics.lineStyle(2,65280),this.line.graphics.moveTo(p,u),this.line.graphics.lineTo(d,y),this.line.graphics.endFill(),i=Math.sqrt(n*n+(r+GameConst.ACC_SPEED*o)*(r+GameConst.ACC_SPEED*o)),o+=0==i?Math.sqrt(2*a/GameConst.ACC_SPEED):a/i,s+=n*o,l+=r*o+.5*GameConst.ACC_SPEED*o*o,h+=r*o+.5*GameConst.ACC_SPEED*o*o}this.line.height<3e3&&this.group.addChild(this.line)},t.prototype.clearShape=function(){this.line.graphics.clear()},t.prototype.onTouchEnd=function(e){var t=e.stageX-this.touchBeginX,i=e.stageY-this.touchBeginY,n=Math.sqrt(t*t+i*i);if(!(20>=n||(this.clearShape(),this.jumpCount>=GameConst.JUMP_TIME))){this._isStart||(this._isStart=!0),ObserverManager.sendNotification(GameEvent.START),egret.Tween.removeTweens(this.bulletTimeIcon),this.arrowIcon.scaleY=0;var r=new egret.Point(e.stageX,e.stageY);Scene.factor=1,this.bulletTimeIcon.visible=!1;var o=r.x-this.touchBeginX;this.jumani=!1,egret.Tween.get(this.playerIcon.role).to({rotation:360},200).to({rotation:720},200).call(function(){this.playerIcon.role.source=PlayerAction.JUMP
},this),n>200&&(n=200);var a=Math.atan2(i,t),s=n*Math.cos(a)*.15*.5,l=n*Math.sin(a)*.2*.5;this.playerIcon.velocity=[s,l],this.playerIcon.roleAy=GameConst.ACC_SPEED,this.dirHandle(o)}},t.prototype.dirHandle=function(e){return this.playerIcon.role.source==PlayerAction.STAND&&this.playerIcon.velocity[1]>0?(this.playerIcon.velocity[1]=0,void this.sault()):this.playerIcon.role.source==PlayerAction.HANG_CEILING&&this.playerIcon.velocity[1]<0?(this.playerIcon.velocity[1]=0,void this.sault()):this.playerIcon.role.source==PlayerAction.HAND_WALL&&1==this.playerIcon.role.scaleX&&this.playerIcon.velocity[0]<0?(this.playerIcon.velocity[0]=0,void this.sault()):this.playerIcon.role.source==PlayerAction.HAND_WALL&&-1==this.playerIcon.role.scaleX&&this.playerIcon.velocity[0]>0?(this.playerIcon.velocity[0]=0,void this.sault()):(this.bulletFlag=!1,this.isJumpFlag=!0,this.jumpCount++,this.playerIcon.roleAy=.2,this.playerIcon.role.scaleX=e>0?1:-1,void(this.playerIcon.role.source=PlayerAction.SQUAT))},t.prototype.sault=function(){var e=this;egret.Tween.get(this.playerIcon.role).to({rotation:360},200).to({rotation:720},200).call(function(){for(var t=0;t<Scene.blockArray.length;t++){var i=Scene.blockArray[t];if("endless"==GAME_MODEL){if(GameUtil.isHit(e.playerIcon,i)||e.playerIcon.x<=65||e.playerIcon.x>=630)return e.playerIcon.roleAy=0,void(e.playerIcon.velocity=[0,0])}else if(GameUtil.isHit(e.playerIcon,i)||e.playerIcon.x<=65||e.playerIcon.x>=630||e.playerIcon.y<=75)return e.playerIcon.roleAy=0,void(e.playerIcon.velocity=[0,0]);e.playerIcon.roleAy=.2}})},t.prototype.updateScore=function(){this.playerIcon.y<this.maxh&&(this.score+=Math.floor(this.maxh-this.playerIcon.y+this.killScore),this.maxh=this.playerIcon.y),this.killScore=0,this.scoreLable.text=this.score+""},t.prototype.playLandEffect=function(){this.landEffect.x=0,this.landEffect.y=0,this.landEffect.visible=!0,this.landEffect.animation.play("landEffect",1),this.aniGroup.addChild(this.landEffect)},t.prototype.standLeft=function(e){this.playerIcon.x<=75||(this.jumani||this.playLandEffect(),this.playerIcon.roleAy=0,this.jumani=!0,this.playerIcon.role.rotation=0,this.playerIcon.role.source!=PlayerAction.HAND_WALL&&(egret.Tween.removeTweens(this.playerIcon.role),this.goBackTicket(this.playerIcon.velocity[0],this.playerIcon.velocity[1]),this.playerIcon.velocity=[0,0],this.playerIcon.role.source=PlayerAction.HAND_WALL),this.playerIcon.role.scaleX=-1,this.playerIcon.rotation=0,this.jumpCount=0,this.resetPlayerBullet())},t.prototype.standRight=function(e){this.playerIcon.x>=620||(this.jumani||this.playLandEffect(),this.jumani=!0,this.playerIcon.roleAy=0,this.playerIcon.role.rotation=0,this.playerIcon.role.source!=PlayerAction.HAND_WALL&&(egret.Tween.removeTweens(this.playerIcon.role),this.goBackTicket(this.playerIcon.velocity[0],this.playerIcon.velocity[1]),this.playerIcon.velocity=[0,0],this.playerIcon.role.source=PlayerAction.HAND_WALL),this.playerIcon.role.scaleX=1,this.playerIcon.rotation=0,this.jumpCount=0,this.resetPlayerBullet())},t.prototype.standTop=function(){this.jumani||this.playLandEffect(),this.jumani=!0,this.playerIcon.roleAy=0,this.playerIcon.role.rotation=0,this.playerIcon.role.source!=PlayerAction.STAND&&(egret.Tween.removeTweens(this.playerIcon.role),this.goBackTicket(this.playerIcon.velocity[0],this.playerIcon.velocity[1]),this.playerIcon.velocity=[0,0],this.playerIcon.role.source=PlayerAction.STAND),this.playerIcon.velocity[1]=0,this.playerIcon.rotation=0,this.jumpCount=0,this.resetPlayerBullet()},t.prototype.standBottom=function(){this.jumani||this.playLandEffect(),this.jumani=!0,this.playerIcon.roleAy=0,this.playerIcon.role.rotation=0,this.playerIcon.role.source!=PlayerAction.HANG_CEILING&&(egret.Tween.removeTweens(this.playerIcon.role),this.goBackTicket(this.playerIcon.velocity[0],this.playerIcon.velocity[1]),this.playerIcon.velocity=[0,0],this.playerIcon.role.source=PlayerAction.HANG_CEILING),this.jumpCount=0,this.resetPlayerBullet()},t.prototype.arrive=function(){var e=new RestartGameUI("pass");e.visible=!0,e.horizontalCenter=0,this.parent.addChild(e),this.start=!0,this.playerIcon.roleAy=GameConst.ACC_SPEED,GameUtil.playerMaxScore<this.score&&(GameUtil.playerMaxScore=this.score,GameUtil.setPlayerScore(this.score)),this.maxScore.text=Math.floor(GameUtil.playerMaxScore)+""},t.prototype.restart=function(){var e=new RestartGameUI("failed");e.visible=!0,Scene.factor=1,egret.Tween.TIMESCALE=Scene.factor,e.horizontalCenter=0,this.parent.addChild(e),this.start=!0,this.arrowIcon.visible=this.bulletTimeIcon.visible=!1,this.playerIcon.roleAy=GameConst.ACC_SPEED,this._isStart=!1,GameUtil.playerMaxScore<this.score&&(GameUtil.playerMaxScore=this.score,GameUtil.setPlayerScore(this.score)),this.maxScore.text=Math.floor(GameUtil.playerMaxScore)+""},t.prototype.stopBulletTime=function(){Scene.factor=1,this.bulletTimeIcon.visible=this.arrowIcon.visible=!1},t.prototype.goBackTicket=function(e,t){this.playerIcon.x-=e,this.playerIcon.y-=t},t.prototype.update=function(){this.isJumpFlag&&!this.isdispatchFlag&&this.playerShut(),this.bulletReclaim(),this.trapHitTest(),this.roteBlockHitTest(),this.enemyHitTest();for(var e=0;e<Scene.blockArray.length;e++)if(!this.istrapBonus){var t=Scene.blockArray[e];GameUtil.blockhitTest(this.playerIcon,t,this)}this.coinHitTest(),"coin"!=GAME_MODEL&&LevelGroup.endPoint&&GameUtil.hitTest(this.playerIcon,LevelGroup.endPoint)&&(this.start||(this.playerIcon.velocity=[0,0],ObserverManager.instance.dispatchEventWith(GameEvent.ARRIVE_END)));for(var e=0;e<GoldBox.goldBoxArray.length;e++){var i=GoldBox.goldBoxArray[e];GameUtil.enemyHittest(this.playerIcon,i)?this.isAttackbox||(this.playerIcon.playAttackAni(),ObserverManager.instance.dispatchEventWith(GameEvent.ATTCK_BOX),this.isAttackbox=!0):this.isAttackbox=!1}for(var e=0;e<Soldiers.bulletArray.length;e++){if("INVICIBLE"==this.playerIcon.state)return;var n=Soldiers.bulletArray[e];GameUtil.hitTest(this.playerIcon,n)&&(n&&n.parent&&n.parent.removeChild(n),Bullet.reclaim(n),Soldiers.bulletArray.splice(e,1),GameConst.CURRENT_HP-=.5*GameConst.INIT_HP,this.playerIcon.showDamage(.5*GameConst.INIT_HP),this.invicibleTime())}this.playerbulletHit()},t.prototype.trapHitTest=function(){if("INVICIBLE"!=this.playerIcon.state)for(var e=0;e<Scene.trapsArray.length;e++){var t=Scene.trapsArray[e];t&&GameUtil.hitTest(this.playerIcon,t,this)&&(this.start||(t instanceof Spikes?(GameConst.CURRENT_HP-=.4*GameConst.INIT_HP,this.playerIcon.showDamage(.4*GameConst.INIT_HP),this.istrapBonus=!0):t instanceof Blade&&(GameConst.CURRENT_HP-=.3*GameConst.INIT_HP,this.playerIcon.showDamage(.3*GameConst.INIT_HP)),this.playerIcon.velocity[0]=-this.playerIcon.velocity[0],this.playerIcon.velocity[1]=-this.playerIcon.velocity[1],this.jumpCount=0,GameConst.INVICIBLE="INVICIBLE",this.invicibleTime()))}},t.prototype.roteBlockHitTest=function(){if("INVICIBLE"!=this.playerIcon.state)for(var e=0;e<Scene.roteBlockArray.length;e++){var t=Scene.roteBlockArray[e];t&&GameUtil.roteRectHitTest(this.playerIcon,t,this)&&(t.isRote?t instanceof RoteBlockObject&&(GameConst.CURRENT_HP-=.4*GameConst.INIT_HP,this.playerIcon.showDamage(.4*GameConst.INIT_HP),this.playerBounce(),GameConst.INVICIBLE="INVICIBLE",this.invicibleTime()):GameUtil.blockhitTest(this.playerIcon,t,this))}},t.prototype.coinHitTest=function(){for(var e=0;e<Scene.coinArray.length;e++){var t=Scene.coinArray[e];GameUtil.enemyHittest(this.playerIcon,t)&&(t.visible=!1)}},t.prototype.playerbulletHit=function(){for(var e=0;e<PlayerIcon.dartsArray.length;e++){for(var t=PlayerIcon.dartsArray[e],i=0;i<Soldiers.enemyArray.length;i++){var n=Soldiers.enemyArray[i];GameUtil.bulletHit(t,n)&&(n.enemyHurt(),t&&t.parent&&t.parent.removeChild(t),Bullet.reclaim(t),PlayerIcon.dartsArray.splice(e,1),n.enemyhp<=0&&(Soldiers.reclaim(n),Soldiers.enemyArray.splice(i,1),n&&n.parent&&n.parent.removeChild(n)))}if(!GameConst.CROSS_WALL)for(var r=0;r<Scene.blockArray.length;r++){var o=Scene.blockArray[r];GameUtil.bulletHit(t,o)&&(t&&t.parent&&t.parent.removeChild(t),Bullet.reclaim(t),PlayerIcon.dartsArray.splice(e,1))}}},t.prototype.enemyHitTest=function(){for(var e=0;e<Soldiers.enemyArray.length;e++){var t=Soldiers.enemyArray[e];GameUtil.enemyHittest(this.playerIcon,t)&&t&&(Soldiers.enemyArray.splice(e,1),t&&t.parent&&t.parent.removeChild(t),Soldiers.reclaim(t),t.enemyDead(t),this.playerIcon.playAttackAni(),this.killScore=80),t.localToGlobal().y>GameConst.SCREEN_HEIGHT&&(t.enemyDead(t),Soldiers.enemyArray.splice(e,1),Soldiers.reclaim(t))}},t.prototype.enemyAi=function(){for(var e=0;e<Soldiers.enemyArray.length;e++){var t=Soldiers.enemyArray[e],i=t.localToGlobal(),n=this.playerIcon.localToGlobal(),r=i.x-n.x,o=i.y-n.y,a=Math.sqrt(Math.pow(r,2)+Math.pow(o,2)),s="";if(r>0&&(s="left"),0>r&&(s="right"),"attacking_enemy_0_png"==t.enemy.source&&70>a&&Math.abs(i.y-n.y)<=100)ObserverManager.instance.dispatchEventWith(GameEvent.ARRIVE_SWORD_ENEMY,!1,{rangeType:"sowrd",scale:t.currentState,dir:s});else if("ranged_enemy_idle_png"!=t.enemy.source);else{var l={dir:s,scale:t.currentState,playerPoint:n,enemyPoint:i};t.sniperAttack(l,this.group)}}},t.prototype.playerBounce=function(e){if(this.playerIcon.velocity[0]=-this.playerIcon.velocity[0],this.playerIcon.velocity[1]=-this.playerIcon.velocity[1],e){var t=e.data;"left"==t.dir?(this.playerIcon.velocity[0]=-2,this.playerIcon.roleAy=.2,this.playerIcon.role.source=PlayerAction.SQUAT):"right"==t.dir&&(this.playerIcon.velocity[0]=2,this.playerIcon.roleAy=.2,this.playerIcon.role.source=PlayerAction.SQUAT),GameConst.INVICIBLE="INVICIBLE",this.invicibleTime()}},t.prototype.resetPlayerBullet=function(){var e=this;this.bulletFlag||(egret.clearInterval(this.playershutInterval),this.playershutInterval=egret.setInterval(function(){e.playerIcon.resetDarts(),e.playerDarts.addDarts()},this,GameConst.RELOAD_INTERVAL),this.bulletFlag=!0,this.isJumpFlag=!1,this.isdispatchFlag=!1)},t.prototype.shurInterver=function(){var e=this;egret.setTimeout(function(){e.isdispatchFlag=!1},this,GameConst.ATTACK_SPEED)},t.prototype.playerShut=function(){var e=this.findNearest();if(e&&e.length>0){var t=e[0].localToGlobal(),i=this.playerIcon.localToGlobal();if(-1!=GameConst.OWN_TALENT.indexOf(1)&&e.length>=2){var n=e[1].localToGlobal(),r=CommonUtil.getAngle(i.x,i.y,n.x,n.y)%360;r-=90,this.playerIcon.playerShut(r,this.group),this.playerDarts.subDarts()}var o=CommonUtil.getAngle(i.x,i.y,t.x,t.y)%360;o-=90,egret.clearInterval(this.playershutInterval),this.playerIcon.playerShut(o,this.group),this.playerDarts.subDarts(),this.isdispatchFlag=!0,this.shurInterver()}},t.prototype.findNearest=function(){for(var e,t,i=this.playerIcon.localToGlobal(),n=[],r=0;r<Soldiers.enemyArray.length;r++){var o=Soldiers.enemyArray[r];t=o.localToGlobal(),e=Math.sqrt(Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2)),o.distance=e,500>=e&&(n.push(o),n=_.sortBy(n,function(e){return e.distance}))}return n},t.prototype.bulletReclaim=function(){for(var e=0;e<PlayerIcon.dartsArray.length;e++){var t=PlayerIcon.dartsArray[e];(t.localToGlobal().x<0||t.localToGlobal().x>750||t.localToGlobal().y<0||t.localToGlobal().y>1334)&&(t&&t.parent&&t.parent.removeChild(t),Bullet.reclaim(t),PlayerIcon.dartsArray.splice(e,1))}},t.prototype.createEndlessGroup=function(){for(var e=0;e<this.listLength;e++){var t=new EndlessItemGroup("ninja_endless"+(e+1)+"_json");t.addConfig(),t.y=1334*(2-e),this.group.addChild(t),this.list.push(t)}},t.prototype.updateEndless=function(){for(var e=0;e<this.list.length;e++){var t=this.list[e],i=t.localToGlobal().y,n=Math.floor(5*Math.random()+9);if(i>1334){var r=this.findFirst();return t.y=r.y-1334,EndlessItemGroup.reclaim(t),void t.addConfig("ninja_endless"+n+"_json")}}},t.prototype.findFirst=function(){for(var e=this.list[0],t=0;t<this.list.length;t++){var i=this.list[t];i.y<e.y&&(e=i)}return e},t.prototype.creatSnowflake=function(){var e=this,t=new egret.Shape;t.graphics.beginFill(16777215,1);var i=10+10*Math.random(),n=400+1200*Math.random();t.graphics.drawRect(0,0,i,i),t.graphics.endFill(),t.x=750,t.y=GameConst.totalLen-n,this.group.addChild(t);var r=-45+90*Math.random();t.rotation=r;var o=egret.Tween.get(t),a=200+300*Math.random()+t.y;o.to({x:0,y:a},3e3+2e3*Math.random()).call(function(){e.group.removeChild(t),t=null});var s=egret.Tween.get(t);s.to({alpha:0},4500+500*Math.random())},t.prototype.creatTimer=function(){var e=500+500*Math.random(),t=new egret.Timer(e,1);t.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),t.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.creatTimer,this),t.start()},t.prototype.timerFunc=function(){this.creatSnowflake()},t.prototype.enter=function(){},t.prototype.exit=function(){},t.prototype.addHitTest=function(){},t.blockArray=[],t.roteBlockArray=[],t.coinArray=[],t.trapsArray=[],t.factor=1,t}(eui.Component);__reflect(TempScene.prototype,"TempScene");var TempSceneMediator=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.addGameEventListener=function(){this.addEventListener(GameEvent.HIT_LEFT_RECT,this.standLeft,this),this.addEventListener(GameEvent.HIT_RIGHT_RECT,this.standRight,this),this.addEventListener(GameEvent.HIT_BOTTOM_RECT,this.standBottom,this),this.addEventListener(GameEvent.HIT_TOP_RECT,this.standTop,this),this.addEventListener(GameEvent.START,this.startSlide,this),this.addEventListener(GameEvent.ROLE_DEAD,this.stopSlide,this),this.addEventListener(GameEvent.ARRIVE_END,this.arrive,this),this.addEventListener(GameEvent.ROLE_ATTCKED,this.playerBounce,this),this.addEventListener(GameEvent.SHOW_MUNE,this.showMenu,this)},t.prototype.initView=function(){this.gameScene=new TempScene,this.gameScene.initUI()},t.prototype.resetView=function(){this.gameScene.restScene()},t.prototype.startSlide=function(){GameConst.IS_SLIDE||(GameConst.IS_SLIDE=!0)},t.prototype.stopSlide=function(){GameConst.IS_SLIDE=!1,this.gameScene.restart()},t.prototype.onEnter=function(){ViewManager.instance.addElement(this.gameScene),this.gameScene.enter()},t.prototype.standLeft=function(e){this.gameScene.standLeft(e),this.gameScene.stopBulletTime()},t.prototype.standRight=function(e){this.gameScene.standRight(e),this.gameScene.stopBulletTime()},t.prototype.standTop=function(){this.gameScene.standTop(),this.gameScene.stopBulletTime()},t.prototype.standBottom=function(){this.gameScene.standBottom(),this.gameScene.stopBulletTime()},t.prototype.onExit=function(){this.gameScene.exit(),ViewManager.instance.removeElement(this.gameScene)},t.prototype.arrive=function(){this.gameScene.arrive()},t.prototype.playerBounce=function(e){"INVICIBLE"!=this.gameScene.playerIcon.state&&(GameConst.CURRENT_HP-=.2*GameConst.INIT_HP,this.gameScene.playerBounce(e),GameConst.INVICIBLE="INVICIBLE",this.gameScene.invicibleTime())},t.prototype.showMenu=function(){this.gameScene.showMenu()},t.prototype.getScene=function(){return this.gameScene},t}(Mediator);__reflect(TempSceneMediator.prototype,"TempSceneMediator");var SelectItem=function(e){function t(t){var i=e.call(this)||this;return i.skinName="SelectItemSkin",i.text=t.text,i.texture=t.source,i.addEventListener(egret.TouchEvent.TOUCH_TAP,i.selectTalent,i),i}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.txt.text=this.text,this.icon.source=this.texture},t.prototype.selectTalent=function(){switch(this.text){case"多重射击":GameConst.TALENT_TYPE=1;break;case"淬毒":GameConst.TALENT_TYPE=2;break;case"巨型飞镖":GameConst.TALENT_TYPE=3}GameConst.OWN_TALENT.push(GameConst.TALENT_TYPE),ObserverManager.instance.dispatchEventWith(GameEvent.CLOSE_SELECT)},t}(eui.Component);__reflect(SelectItem.prototype,"SelectItem");var SelectMediator=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.addGameEventListener=function(){ObserverManager.instance.addEventListener(GameEvent.CLOSE_SELECT,this.onExit,this)},t.prototype.initView=function(){this.selectScene=new SelectScene,this.selectScene.initUI()},t.prototype.onEnter=function(){ViewManager.instance.addElement(this.selectScene),this.selectScene.enter()},t.prototype.onExit=function(){this.selectScene.exit(),this.selectScene.showTalent(),ViewManager.instance.removeElement(this.selectScene)},t}(Mediator);__reflect(SelectMediator.prototype,"SelectMediator");var SelectPanel=function(e){function t(t){var i=e.call(this)||this;return i.text="",i.skinName="SelectSceneSkin",t&&(i.text=t),ObserverManager.instance.addEventListener(GameEvent.CLOSE_SELECT,i.close,i),i}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.titleText.text=this.text?this.text:"武器选择",this.initScroller()},t.prototype.initScroller=function(){for(var e=1;e<=GameConst.TALENT_NUMBER;e++){var t=new SelectItem({text:TALENT_NAME[e-1],source:TALENT_ARRAY[e-1]});this.weaponGroup.addChild(t)}},t.prototype.close=function(){GameUtil.removeSelf(this)},t}(eui.Component);__reflect(SelectPanel.prototype,"SelectPanel");var SelectScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="SelectSceneSkin",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.initUI=function(){for(var e=2;e<=GameConst.WEAPON_LIBRARY;e++){var t=new Weapon("ninja_weapon"+e+"_png");this.weaponGroup.addChild(t)}},t.prototype.showTalent=function(){var e=new SelectPanel("选择新能力");this&&this.parent&&this.parent.addChild(e)},t.prototype.enter=function(){},t.prototype.exit=function(){},t}(eui.Component);__reflect(SelectScene.prototype,"SelectScene");var Weapon=function(e){function t(t){var i=e.call(this)||this;return i.skinName="WeaponSkin",i.texture=t,i.addEventListener(egret.TouchEvent.TOUCH_TAP,i.chooseWeapon,i),i}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.weapon.source=this.texture},t.prototype.chooseWeapon=function(){switch(GameConst.WEAPON=this.texture,ObserverManager.instance.dispatchEventWith(GameEvent.CLOSE_SELECT),this.texture){case"ninja_weapon2_png":GameConst.CLIP_NUM=6,GameConst.ATTACK_SPEED=400,GameConst.RELOAD_INTERVAL=400,GameConst.WEAPON_POWER=35,GameConst.WEAPON_SPEED=12;break;case"ninja_weapon4_png":GameConst.CLIP_NUM=12,GameConst.ATTACK_SPEED=200,GameConst.RELOAD_INTERVAL=100,GameConst.WEAPON_POWER=15,GameConst.WEAPON_SPEED=15;break;case"ninja_weapon5_png":GameConst.CLIP_NUM=2,GameConst.ATTACK_SPEED=1e3,GameConst.RELOAD_INTERVAL=1e3,GameConst.WEAPON_POWER=80,GameConst.WEAPON_SPEED=8;break;case"ninja_weapon6_png":GameConst.CLIP_NUM=8,GameConst.ATTACK_SPEED=500,GameConst.RELOAD_INTERVAL=300,GameConst.WEAPON_POWER=25,GameConst.WEAPON_SPEED=10,GameConst.CROSS_WALL=!0}},t}(eui.Component);__reflect(Weapon.prototype,"Weapon");var Adevertisement=function(){function e(){}return e.showAdd=function(e){openadsdk.SplashAd(function(){},e,"")},e}();__reflect(Adevertisement.prototype,"Adevertisement");var CommonUtil=function(){function e(){}return e.valueFadeTween=function(e,t){void 0===t&&(t=!0),t&&egret.Tween.removeTweens(e),e.alpha=0,egret.Tween.get(e).to({alpha:1},1e3).call(function(){t&&egret.Tween.removeTweens(this)},e)},e.scaleFadeTween=function(e,t,i){void 0===i&&(i=!0),i&&egret.Tween.removeTweens(e);var n=e.scaleX-1,r=.68+n;e.scaleX=e.scaleY=r},e.valueFormat1000=function(e){return e>=1e6?Math.ceil(e/1e6)+"M":e>=1e3?Math.ceil(e/1e3)+"K":this.valueFormatDecimals(e,2)+""},e.valueFormatDecimals=function(e,t){if(e=+e,!e)return e;if(0==t)return+e.toFixed(0);for(var i=null,n=null,r=t;r>=0;r--)if(n=e.toFixed(r),i){if(n!=i)return+i}else i=n;return e},e.loadTextureFromUrl=function(e,t,i,n){void 0===n&&(n="");var r=new egret.URLLoader;r.tag=n,r.dataFormat=egret.URLLoaderDataFormat.TEXTURE,r.addEventListener(egret.Event.COMPLETE,t,i);var o=new egret.URLRequest(e);r.load(o)},e.getAllParam=function(e){if(void 0===e&&(e=null),egret.Capabilities.runtimeType!=egret.RuntimeType.WEB)return{};var t=location.search;t=decodeURIComponent(t);var i=new Object;if(-1!=t.indexOf("?"))for(var n=t.substr(1),r=n.split("&"),o=0;o<r.length;o++){var a=r[o].split("=");if(a.length>2){var s=r[o].split(a[0]+"=");i[a[0]]=s[1]}else i[a[0]]=a[1]}return e?i[e]:i},e.getStringUnicode=function(e){for(var t=0,i=0;i<e.length;i++)t+=e.charCodeAt(i);return t},e.randomInteger=function(e,t,i){if(void 0===i&&(i=!0),i)return parseInt(Math.random()*(t-e+1)+e);var n=t-e,r=Math.random(),o=e+r*n;return o},e.json2url=function(e){var t=[];for(var i in e)t.push(i+"="+e[i]);return t.join("&")},e.isArray=function(e){return Array.isArray(e)||"[object Array]"===Object.prototype.toString.call(e)},e.isNumber=function(e){return""===e||null==e?!1:(e+="",e.indexOf(" ")>=0||e.indexOf("+")>=0||e.indexOf("-")>=0?!1:isNaN(e)?!1:!0)},e.copy2Clipboard=function(e){var t=document.createElement("input");t.value=e,document.body.appendChild(t),t.select(),t.setSelectionRange(0,t.value.length),document.execCommand("Copy"),document.body.removeChild(t),window.alert(Game.getLanguage("copy2Clipboard succuss"))},e.log=function(e,t){if(void 0===t&&(t=!1),t){var i=(egret.getTimer()/1e3).toFixed(2);egret.log("日志时间："+i+"     "+e)}else egret.log(e)},e.createAnimation=function(t,i,n){if(void 0===i&&(i=null),void 0===n&&(n=null),!dragonBones.EgretFactory.factory.getDragonBonesData(t)){var r=RES.getRes(t+"_ske_json");if(!r)return egret.warn("createAnimation failure, dragonBonesData is null! animationName="+t),null;dragonBones.EgretFactory.factory.parseDragonBonesData(r)}if(!dragonBones.EgretFactory.factory.getTextureAtlasData(t)){var o=RES.getRes(t+"_tex_json");if(!o)return egret.warn("createAnimation failure, textureAtlasData is null! animationName="+t),null;var a=RES.getRes(t+"_tex_png");if(!a)return egret.warn("createAnimation failure, textureData is null! animationName="+t),null;dragonBones.EgretFactory.factory.parseTextureAtlasData(o,a)}var s=dragonBones.EgretFactory.factory.buildArmatureDisplay(t);if(s){i&&s.addEventListener(dragonBones.EventObject.COMPLETE,i,n);var l=t+"_"+s.hashCode;e.dynamicArmatureDisplay[l]=new DynamicArmatureInfo(s,i,n)}return s},e.disposeAnimationRes=function(t){if(t){var i=t.armature.name+"_"+t.hashCode,n=e.dynamicArmatureDisplay[i];n?(t.removeEventListener(dragonBones.EventObject.COMPLETE,n.completeFun,n.funThisObj),delete e.dynamicArmatureDisplay[i]):egret.warn("disposeAnimationRes! dynamicArmatureInfo is null, armatureName: "+i),dragonBones.EgretFactory.factory.removeDragonBonesData(t.armature.name,!1),dragonBones.EgretFactory.factory.removeTextureAtlasData(t.armature.name,!1),t.parent.removeChild(t),t.dispose()}},e.getAngle=function(e,t,i,n){var r=e-i,o=t-n;if(!r&&!o)return 0;var a=(180+180*Math.atan2(-o,-r)/Math.PI+360)%360;return a+270},e.getDistance=function(e,t,i,n){var r=e-i,o=t-n;return Math.sqrt(Math.pow(Math.abs(r),2)+Math.pow(Math.abs(o),2))},e.greyColorFilter=new egret.ColorMatrixFilter([.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0]),e.darkColorFilter=new egret.ColorMatrixFilter([.95,0,0,0,0,0,.95,0,0,0,0,0,.95,0,0,0,0,0,1,0]),e.dynamicArmatureDisplay={},e}();__reflect(CommonUtil.prototype,"CommonUtil");var DynamicArmatureInfo=function(){function e(e,t,i){this.armature=e,this.completeFun=t,this.funThisObj=i}return e}();__reflect(DynamicArmatureInfo.prototype,"DynamicArmatureInfo");var GameUtil=function(){function e(){}return e.hitTest=function(t,i,n){var r,o=t.roleRect.getBounds(),a=t.localToGlobal(),s=i.localToGlobal();if(i instanceof Blade){var l=s.x+i.width/2,c=s.y+i.height/2,h=new SHCircle(l,c,i.scale*i.width/2),p=new SHRect(a.x,a.y,a.x+o.width,a.y,a.x+o.width,a.y+o.height,a.x,a.y+o.height),u=e.detectCircleAndRectCollision(h,p);return u}return r=i.getBounds(),r.width=r.width*i.scale,r.height=r.height*i.scale,o.x=a.x,o.y=a.y,r.x=s.x,r.y=s.y,o.intersects(r)},e.blockhitTest=function(e,t,i){var n,r,o,a,s=e.roleRect.getBounds(),l=e.roleRect.localToGlobal(),c=t.localToGlobal();return s.x=l.x,s.y=l.y,t.leftRect&&(n=t.leftRect.getBounds(),n.x=c.x+5,n.y=c.y+10,s.intersects(n))?void ObserverManager.instance.dispatchEventWith(GameEvent.HIT_LEFT_RECT,!1,{rect:n}):t.rightRect&&(r=t.rightRect.getBounds(),r.x=c.x+t.width-10,r.y=c.y+10,s.intersects(r))?void ObserverManager.instance.dispatchEventWith(GameEvent.HIT_RIGHT_RECT,!1,{rect:r}):t.topRect&&(o=t.topRect.getBounds(),o.x=c.x+5,o.y=c.y+10,s.intersects(o))?void ObserverManager.instance.dispatchEventWith(GameEvent.HIT_TOP_RECT):t.bottomRect&&(a=t.bottomRect.getBounds(),a.x=c.x+5,a.y=c.y+t.height-20,s.intersects(a))?void ObserverManager.instance.dispatchEventWith(GameEvent.HIT_BOTTOM_RECT):void 0},e.isHit=function(e,t){var i,n,r,o,a=e.roleRect.getBounds(),s=e.roleRect.localToGlobal(),l=t.localToGlobal();return a.x=s.x,a.y=s.y,t.leftRect&&(i=t.leftRect.getBounds(),i.x=l.x+5,i.y=l.y+10,a.intersects(i))?!0:t.rightRect&&(n=t.rightRect.getBounds(),n.x=l.x+t.width-10,n.y=l.y+10,a.intersects(n))?!0:t.topRect&&(r=t.topRect.getBounds(),r.x=l.x+5,r.y=l.y+10,a.intersects(r))?!0:t.bottomRect&&(o=t.bottomRect.getBounds(),o.x=l.x+5,o.y=l.y+t.height-20,a.intersects(o))?!0:!1},e.computeDistanceBetweenPointAndLine=function(e,t,i,n,r,o){var a=o-n,s=i-r,l=r*n-i*o;return Math.abs(a*e+s*t+l)/Math.sqrt(a*a+s*s)},e.detectCircleAndRectCollision=function(t,i){var n=i.vector2.sub(i.vector1).model(),r=i.vector1.sub(i.vector4).model(),o=n/2,a=r/2,s=i.vector2.sub(i.vector1),l=i.vector3.sub(i.vector1),c=i.vector4.sub(i.vector1),h=i.x+l.x/2,p=i.y+l.y/2,u=i.x+s.x/2,d=i.y+s.y/2,y=i.x+c.x/2,g=i.y+c.y/2,m=e.computeDistanceBetweenPointAndLine(t.x,t.y,h,p,y,g);if(m>a+t.r)return!1;var f=e.computeDistanceBetweenPointAndLine(t.x,t.y,h,p,u,d);return f>o+t.r?!1:a>=m||o>=f?!0:t.vector.sub(i.vector1).model()<=t.r||t.vector.sub(i.vector2).model()<=t.r||t.vector.sub(i.vector3).model()<=t.r||t.vector.sub(i.vector4).model()<=t.r?!0:!1},e.roteRectHitTest=function(t,i,n){var r=i.rotation%360,o=new egret.Point,a=new egret.Point,s=new egret.Point,l=new egret.Point,c=new egret.Point,h=new egret.Point,p=new egret.Point,u=new egret.Point,d=t.localToGlobal(),y=i.localToGlobal(),g=i.initWidth,m=i.initHeight;Math.sqrt(g*g+m*m);r>=0&&90>=r?(o.x=y.x,a.x=y.x+g*Math.cos(Math.PI*r/180),s.x=a.x-m*Math.sin(Math.PI*r/180),l.x=y.x-m*Math.sin(Math.PI*r/180),o.y=y.y,a.y=y.y+g*Math.sin(Math.PI*r/180),s.y=a.y+m*Math.cos(Math.PI*r/180),l.y=y.y+m*Math.cos(Math.PI*r/180)):r>90&&180>=r?(o.x=y.x-m*Math.cos(Math.PI*(r-90)/180),a.x=y.x,s.x=y.x-g*Math.sin(Math.PI*(r-90)/180),l.x=s.x-m*Math.cos(Math.PI*(r-90)/180),o.y=y.y-g*Math.sin(Math.PI*(r-90)/180),a.y=y.y,s.y=y.y+g*Math.cos(Math.PI*(r-90)/180),l.y=s.y-m*Math.sin(Math.PI*(r-90)/180)):0>r&&r>=-90?(o.x=y.x+g*Math.sin(Math.PI*(r+90)/180),s.x=y.x+m*Math.cos(Math.PI*(r+90)/180),l.x=y.x,a.x=s.x+g*Math.sin(Math.PI*(r+90)/180),o.y=y.y-g*Math.cos(Math.PI*(r+90)/180),s.y=y.y+m*Math.sin(Math.PI*(r+90)/180),l.y=y.y,a.y=s.y-g*Math.cos(Math.PI*(r+90)/180)):-90>r&&r>=-180&&(a.x=y.x+m*Math.sin(Math.PI*(r+180)/180),s.x=y.x,l.x=y.x-g*Math.cos(Math.PI*(r+180)/180),o.x=l.x+m*Math.sin(Math.PI*(r+180)/180),a.y=y.y-m*Math.cos(Math.PI*(r+180)/180),s.y=y.y,l.y=y.y-g*Math.sin(Math.PI*(r+180)/180),o.y=l.y-m*Math.cos(Math.PI*(r+180)/180)),c.x=d.x,c.y=d.y,h.x=d.x+t.width,h.y=d.y,p.x=d.x+t.width,p.y=d.y+t.height,u.x=d.x,u.y=d.y+t.height;return e.QuickReject(o,a,c,h)&&e.Straddle(o,a,c,h)?!0:e.QuickReject(a,s,c,h)&&e.Straddle(a,s,c,h)?!0:e.QuickReject(s,l,c,h)&&e.Straddle(s,l,c,h)?!0:e.QuickReject(l,o,c,h)&&e.Straddle(l,o,c,h)?!0:e.QuickReject(o,a,h,p)&&e.Straddle(o,a,h,p)?!0:e.QuickReject(a,s,h,p)&&e.Straddle(a,s,h,p)?!0:e.QuickReject(s,l,h,p)&&e.Straddle(s,l,h,p)?!0:e.QuickReject(l,o,h,p)&&e.Straddle(l,o,h,p)?!0:e.QuickReject(o,a,p,u)&&e.Straddle(o,a,p,u)?!0:e.QuickReject(a,s,p,u)&&e.Straddle(a,s,p,u)?!0:e.QuickReject(s,l,p,u)&&e.Straddle(s,l,p,u)?!0:e.QuickReject(l,o,p,u)&&e.Straddle(l,o,p,u)?!0:e.QuickReject(o,a,u,c)&&e.Straddle(o,a,u,c)?!0:e.QuickReject(a,s,u,c)&&e.Straddle(a,s,u,c)?!0:e.QuickReject(s,l,u,c)&&e.Straddle(s,l,u,c)?!0:e.QuickReject(l,o,u,c)&&e.Straddle(l,s,u,c)?!0:!1},e.QuickReject=function(e,t,i,n){var r=Math.max(e.x,t.x),o=Math.max(e.y,t.y),a=Math.min(e.x,t.x),s=Math.min(e.y,t.y),l=Math.max(i.x,n.x),c=Math.max(i.y,n.y),h=Math.min(i.x,n.x),p=Math.min(i.y,n.y);return h>r||p>o||a>l||s>c?!1:!0},e.Straddle=function(e,t,i,n){var r=e.x,o=t.x,a=e.y,s=t.y,l=i.x,c=n.x,h=i.y,p=n.y;return((r-l)*(p-h)-(a-h)*(c-l))*((o-l)*(p-h)-(s-h)*(c-l))>0||((l-r)*(s-a)-(h-a)*(o-r))*((c-r)*(s-a)-(p-a)*(o-r))>0?!1:!0},e.enemyHittest=function(e,t){var i=e.roleRect.getBounds(),n=t.pzRect.getBounds(),r=e.localToGlobal(),o=t.localToGlobal();return i.x=r.x,i.y=r.y,n.x=o.x,n.y=o.y,i.intersects(n)},e.setPlayerScore=function(e){egret.localStorage.setItem("maxScorel",e)},e.getPlayerScore=function(){var e=parseInt(egret.localStorage.getItem("maxScorel"));return e},e.getArcX=function(e,t){return e*Math.cos(t*Math.PI/180)},e.getArcY=function(e,t){return e*Math.sin(t*Math.PI/180)},e.resetScene=function(){if("coin"==GAME_MODEL)for(var e=0;e<Scene.coinArray.length;e++){var t=Scene.coinArray[e];t&&t.parent&&t.parent.removeChild(t),Coin.reclain(t),Scene.coinArray.splice(e,1)}else if(GAME_MODEL="level"){for(var e=0;e<Scene.trapsArray.length;e++){var i=Scene.trapsArray[e];i&&i.parent&&i.parent.removeChild(i),Scene.trapsArray.splice(e,1)}for(var e=0;e<Soldiers.enemyArray.length;e++){var n=Soldiers.enemyArray[e];n&&n.parent&&n.parent.removeChild(n),Soldiers.reclaim(n),Soldiers.enemyArray.splice(e,0)}for(var e=0;e<Scene.roteBlockArray.length;e++){var r=Scene.blockArray[e];r&&r.parent&&r.parent.removeChild(r),RoteBlockObject.reclaim(r),Scene.roteBlockArray.splice(e,1)}for(var e=0;e<Scene.blockArray.length;e++){var o=Scene.blockArray[e];o&&o.parent&&o.parent.removeChild(o),BlockObject.reclaim(o),Scene.blockArray.splice(e,1)}}},e.retSunPos=function(e){var t=new egret.Point;switch(e){case 1:case 13:t.x=280,t.y=280;break;case 2:case 14:t.x=320,t.y=320;break;case 3:case 15:t.x=360,t.y=340;break;case 4:case 16:t.x=400,t.y=360;break;case 5:case 17:t.x=440,t.y=400;break;case 6:case 18:t.x=120,t.y=480;break;case 7:case 19:t.x=140,t.y=440;break;case 8:case 20:t.x=160,t.y=400;break;case 9:case 21:t.x=180,t.y=360;break;case 10:case 22:t.x=200,t.y=320;break;case 11:case 23:t.x=220,t.y=280;break;case 12:case 0:t.x=240,t.y=240}return t},e.retAlpha=function(e){var t;switch(e){case 1:t=.3;break;case 2:t=.4;break;case 3:t=.3;break;case 4:t=.25;break;case 5:t=.2;break;case 6:t=0;break;case 7:t=.05;break;case 8:t=.05;break;case 9:t=.1;break;case 10:t=.1;break;case 11:t=.1;break;case 12:t=.1;break;case 13:t=.1;break;case 14:t=.1;break;case 15:t=.1;break;case 16:t=.1;break;case 17:t=.05;break;case 18:t=0;break;case 19:t=.2;break;case 20:t=.25;break;case 21:t=.3;break;case 22:t=.3;break;case 23:t=.4;break;case 0:t=.5}return t},e.bulletHit=function(e,t){var i=e.getBounds(),n=t.getBounds(),r=e.localToGlobal(),o=t.localToGlobal();return i.x=r.x,i.y=r.y,n.x=o.x,n.y=o.y,i.intersects(n)},e.removeSelf=function(e){e&&e.parent&&e.parent.removeChild(e)},e.isshape=!0,e.playerMaxScore=0,e}();__reflect(GameUtil.prototype,"GameUtil");var ObstacleType;!function(e){e.block="block",e.spikes="trap",e.pole="pole",e.blade="blade",e.swingBlade="swingBlade",e.door="door",e.endPoint="endPoint",e.enemy="enemy",e.sniper="sniper",e.swordman="swordman",e.coin="coin",e.coinBox="coinBox"}(ObstacleType||(ObstacleType={}));var ConfigManager=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){return this._instance=this._instance||new e},enumerable:!0,configurable:!0}),e.prototype.load=function(e){void 0===e&&(e="ninja_default_json"),this._datas=RES.getRes(e)},e.prototype.onComplete=function(e){},Object.defineProperty(e.prototype,"datas",{get:function(){return this._datas},enumerable:!0,configurable:!0}),e}();__reflect(ConfigManager.prototype,"ConfigManager");var GameCacheManager=function(){function e(){if(this._cache=new HashMap,e._instance)throw new Error("DateTimer使用单例")}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype.getCache=function(e,t){void 0===t&&(t=null);var i=this._cache.get(e);return!i&&t&&(i=new t,this._cache.put(e,i)),i
},e.prototype.getMcCache=function(e,t,i){var n=this;return game.MCUtils.getMc(e,function(e){return e?(n._cache.put(t,e),i&&i(e),e):void 0})},e.prototype.setCache=function(e,t){this._cache.has[e]?this._cache[e]=t:this._cache.put(e,t)},e.prototype.removeCache=function(){this._cache.clear(),this._cache=new HashMap},e.prototype.clearCache=function(e){this._cache.remove(e)},e}();__reflect(GameCacheManager.prototype,"GameCacheManager");var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var game;!function(e){var t=function(){function e(){}return e.reclaim1=function(t,i){var n=e.mcMap.get(t);return n||(n=[],e.mcMap.put(t,n)),n.push(i),!0},e.getMc=function(t,i,n){function r(e){var i=RES.getRes(t+"_png"),n=RES.getRes(t+"_json"),r=new egret.MovieClipDataFactory(n,i),o=new egret.MovieClip(r.generateMovieClipData(e));return o.fac=r,o.touchEnabled=!1,o}var o=this;void 0===i&&(i=null),void 0===n&&(n="");var a=RES.getRes(t+"_png");if(a){var s=r(n);return i&&i(s),s}return RES.getResAsync(t+"_png",function(){RES.getResAsync(t+"_json",function(){var o=r(n);o&&e.mcMap.put(t,o),i&&i(o)},o)},this),null},e.changeAction=function(e,t){var i=e.fac;e.movieClipData=i.generateMovieClipData(t)},e.mcMap=new HashMap,e}();e.MCUtils=t,__reflect(t.prototype,"game.MCUtils")}(game||(game={}));var SoundManager=function(){function e(){this.localStorageMusicID="musicSwitch"+CommonConst.GAME_ID,this.localStorageEffectID="effectSwitch"+CommonConst.GAME_ID,this.musicSwitch=!0,this.effectSwitch=!0,this.effectChannelMap={},this.ignoreSameSound={},this.musicPosition=0;var e=egret.localStorage.getItem(this.localStorageMusicID);null==e?this.musicSwitch=!0:this.musicSwitch="1"==e?!0:!1,e=egret.localStorage.getItem(this.localStorageEffectID),null==e?this.effectSwitch=!0:this.effectSwitch="1"==e?!0:!1,egret.MainContext.instance.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.listenMutually,this)}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype.getMusicSwitch=function(){return this.musicSwitch},e.prototype.setMusicSwitch=function(e){this.musicSwitch=e,egret.localStorage.setItem(this.localStorageMusicID,e?"1":"0"),e?this.playMusic(this.musicResName):this.stopMusic()},e.prototype.getEffectSwitch=function(){return this.effectSwitch},e.prototype.setEffectSwitch=function(e){this.effectSwitch=e,egret.localStorage.setItem(this.localStorageEffectID,e?"1":"0")},e.prototype.listenMutually=function(){egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.listenMutually,this),this.musicChannel&&0==this.musicChannel.position&&this.resumeMusic()},e.prototype.playMusic=function(e){if(void 0===e&&(e=null),null==e&&this.musicResName&&(e=this.musicResName),this.musicResName!=e&&(this.musicSound=null),this.musicResName=e,this.musicSwitch){if(this.musicChannel&&this.musicChannel.stop(),!this.musicSound){if(this.musicSound=RES.getRes(e),!this.musicSound)return;this.musicSound.type=egret.Sound.MUSIC}this.musicChannel=this.musicSound.play(0,-1)}},e.prototype.playEffect=function(e){if(this.effectSwitch&&ViewManager.instance.isWinActivate&&e&&0!=e.length){var t=this.ignoreSameSound[e],i=(new Date).getTime();if(!(t&&50>i-t)){this.ignoreSameSound[e]=i;var n=RES.getRes(e);if(n){n.type=egret.Sound.EFFECT;var r=n.play(0,1),o=e;this.effectChannelMap[e]&&(o+=r.hashCode),this.effectChannelMap[o]=r,r.addEventListener(egret.Event.SOUND_COMPLETE,function(){delete this.effectChannelMap[o]},this)}else egret.warn("sound not load! soundName="+e)}}},e.prototype.stopEffect=function(e){if(e&&0!=e.length)for(var t in this.effectChannelMap)t.indexOf(e)>=0&&this.effectChannelMap[t].stop(),delete this.effectChannelMap[t]},e.prototype.stopMusic=function(){this.musicChannel&&(this.musicPosition=this.musicChannel.position,this.musicChannel.stop())},e.prototype.resumeMusic=function(){this.musicSwitch&&this.musicChannel&&this.musicSound&&(0==this.musicPosition&&(this.musicPosition=this.musicChannel.position),this.musicChannel.stop(),this.musicChannel=this.musicSound.play(this.musicPosition))},e.musicVolume=.25,e}();__reflect(SoundManager.prototype,"SoundManager");var SilentLoadResManager=function(){function e(e){this.loadResList=null,this.currentLoadingName=null,this.loadResList=[].concat(e)}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e(CommonConst.RES_GROUP_ORDER)),e._instance},enumerable:!0,configurable:!0}),e.prototype.startSilentLoad=function(){RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.currentLoadingName=this.loadResList.shift(),RES.loadGroup(this.currentLoadingName)},e.prototype.onResourceLoadComplete=function(e){if(e.groupName==this.currentLoadingName)this.currentLoadingName=null,this.loadResList.length>0?this.startSilentLoad():(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this));else{var t=this.loadResList.indexOf(e.groupName);t>=0&&(CommonUtil.log("Silent load Res had been complete by other program, resName : "+e.groupName),this.loadResList.splice(t,1))}},e.prototype.onResourceProgress=function(e){},e.prototype.onItemLoadError=function(e){console.log("SilentLoadResManager 加载单个资源出错, Url:"+e.resItem.url)},e.prototype.onResourceLoadError=function(e){console.log("SilentLoadResManager 加载组资源出错  Group:"+e.groupName),this.startSilentLoad()},e}();__reflect(SilentLoadResManager.prototype,"SilentLoadResManager");var LoadingUI=function(e){function t(){var i=e.call(this)||this;i.bgRect=new eui.Rect,i.logo=null,i.progressBG=null,i.progress=null,i.progressText=new egret.TextField,i.loadCount=3,i.bgRect.fillColor=0,i.bgRect.left=i.bgRect.right=i.bgRect.top=i.bgRect.bottom=0,i.addChild(i.bgRect);var n=new eui.Group,r=function(e){var t=e.target,i=t.data;"logo"==t.tag?this.logo=new egret.Bitmap(i):"progressBG"==t.tag?this.progressBG=new egret.Bitmap(i):"progress"==t.tag&&(this.progress=new egret.Bitmap(i)),this.loadCount--,0==this.loadCount&&(this.logo.x=this.width/2-this.logo.width/2+10,this.logo.y=this.height/2-this.logo.height/2-25,this.progressBG.x=this.width/2-this.progressBG.width/2,this.progressBG.y=this.height/2-this.progressBG.height/2+50,this.progress.fillMode=egret.BitmapFillMode.CLIP,this.progress.x=this.width/2-this.progress.width/2,this.progress.y=this.height/2-this.progress.height/2+50,this.progress.width=0,egret.Tween.get(this.progress,{loop:!0}).to({alpha:.4},400).to({alpha:1},400),this.progressText.size=19,this.progressText.textColor=12692102,this.progressText.x=this.width/2-this.logo.width/2+3,this.progressText.y=this.height/2-this.logo.height/2+125,n.width=egret.MainContext.instance.stage.stageWidth,n.height=egret.MainContext.instance.stage.stageHeight,n.horizontalCenter=0,n.verticalCenter=0,this.addChild(n),n.addChild(this.logo),n.addChild(this.progressBG),n.addChild(this.progress),n.addChild(this.progressText))};return CommonUtil.loadTextureFromUrl(t.logoBase64,r,i,"logo"),CommonUtil.loadTextureFromUrl(t.progressBGBase64,r,i,"progressBG"),CommonUtil.loadTextureFromUrl(t.progressBase64,r,i,"progress"),i}return __extends(t,e),t.prototype.setProgress=function(e,t){this.progress&&(this.progress.width=this.progress.texture.textureWidth*(e/t))},t.logoBase64="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA25pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpjMWUxN2NhNS1hNTVkLTA4NGItOTE1YS1mZDAzMDgzNWJiNzYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QjA5RjkxNDRGOTUzMTFFOTg5NjU5MkZCOUQwQjE1Q0UiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QjA5RjkxNDNGOTUzMTFFOTg5NjU5MkZCOUQwQjE1Q0UiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OEM3Q0VEMzNGOTUzMTFFOTlBMDdCMDRBRDQyRENEMDAiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OEM3Q0VEMzRGOTUzMTFFOTlBMDdCMDRBRDQyRENEMDAiLz4gPC9yZGY6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",t.progressBGBase64="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQsAAAAeCAMAAAAM58v8AAAAjVBMVEUAAAAFBQUFBQUCAgEBAQAAAAACAgEDAwMDAwMCAgEAAAAKCggLCwlDQzoiIh1wcGEGBgUSExJfX19vb28CAgIODgwZGRUHBwYbGxgwMCwoKSU9PTVgYFM4ODEeHhsWFhNWVktERD0fHx8sLCdSUlJGR0dubl9TU0hHRz48PDwkJCE1NTNNTUVoaFpoaGiwi9i6AAAACnRSTlMA7Op8HRhzwcB0DNe1CQAAAZ1JREFUWMPtmQluqzAQhumW99oxKaYe79isSYA09z9e60SQSlVPMHxH+KTZ/sneNhY2F79cCCEKBQCMFgCgCiHETxeiAORRh7CnRQg6coRC3F0IhTFYU7mcGq4yNkRUYnEhFGpbnWr/eTi8U+Jw+PT1qbL6JiNLBYK6y48uAkWiO+adxkLcXDDZNQ0bLx8UKWfWNJ1kVxei4JOrsf+4lDRpWO0mXojkAqQ5uvFS9v0YEEiBYez73rqjkXB1gfvc87Lsh+nh6TkjxfPTwzQMI3q3x+Si4PZ8MknFv4wg/6dh1qez5UVyEU1tmn4wjxlJHs3cfhuIyYWSlZfDuZGvGUl2cm6lr6RKLnTlcRhG9pKR5IUZjb7Sq4txnOm6sHJ1kWpkng3fZSTZ8ZZfa2TpndZ0LdXeGTR2qXcuM1VaayPNmRpbDteZuuxarP2GU9y1eOAAPt/jfQfnWretRAakYCg1B7jt4OttBshpgkrBcpstN3tK/kiiYL3Z71mOBIrIJcvZMr4149uy3zX73X4C609g+xWtv6Lth7j9U//mCwhtMZ80lChGAAAAAElFTkSuQmCC",t.progressBase64="data:image/png;base64,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",t}(eui.Component);__reflect(LoadingUI.prototype,"LoadingUI");var ModuleLoadingUI=function(e){function t(){var t=e.call(this)||this;t.bgRect=new eui.Rect,t.loadingIcon=null,t.progressText=null,t.loadingGroupName=null,t.loadingGroupCallback=null,t.cacheLoadRequest=[],t.loadingStartTime=-1,t.bgRect.fillAlpha=.35,t.bgRect.fillColor=0,t.bgRect.left=t.bgRect.right=t.bgRect.top=t.bgRect.bottom=0,t.addChild(t.bgRect),t.loadingIcon=new eui.Image,t.progressText=new eui.Label("0%"),t.progressText.size=24,t.progressText.textColor=16777215,t.progressText.fontFamily="Microsoft YaHei",t.progressText.textAlign="center",t.progressText.horizontalCenter=0,t.progressText.verticalCenter=0,t.progressText.visible=!1;var i=new eui.Group;return i.width=egret.MainContext.instance.stage.stageWidth,i.height=egret.MainContext.instance.stage.stageHeight,i.addChild(t.loadingIcon),i.addChild(t.progressText),i.horizontalCenter=0,i.verticalCenter=0,t.addChild(i),t}return __extends(t,e),t.prototype.loadModuleGroupRes=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.cacheLoadRequest.push(arguments),this.visible||this.startLoadGroupRes.apply(this,this.cacheLoadRequest[0])},t.prototype.startLoadGroupRes=function(e,t,i){for(var n=[],r=3;r<arguments.length;r++)n[r-3]=arguments[r];return this.loadingGroupName?void egret.warn(this.loadingGroupName+" is not loaded complete! Only one set of resources can be loaded simultaneously! new groupName is:"+e):(this.loadingIcon.source||(this.loadingIcon.source="moduleLoadingIcon_png",egret.callLater(function(){this.loadingIcon.scaleX=this.loadingIcon.scaleY=.4,this.loadingIcon.anchorOffsetX=this.loadingIcon.width/2,this.loadingIcon.anchorOffsetY=this.loadingIcon.height/2,this.loadingIcon.x=this.loadingIcon.parent.width/2,this.loadingIcon.y=this.loadingIcon.parent.height/2},this)),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.progressText.text="0%",this.loadingIcon.rotation=0,egret.Tween.get(this.loadingIcon,{loop:!0}).call(function(){this.loadingIcon.rotation+=30},this).wait(100),this.loadingGroupName=e,this.loadingGroupCallback=t,this.callbackThisObj=i,this.callbackParameters=n,this.loadingGroupName&&(this.loadingStartTime=(new Date).getTime(),this.visible=!0),CommonUtil.log("ModuleLoading start, resName: "+e),void RES.loadGroup(e))},t.prototype.onResourceLoadComplete=function(e){if(e.groupName!=this.loadingGroupName)return void CommonUtil.log("ModuleLoading complete listen!   Complete GroupName is:"+e.groupName+"  current moduleLoading resName is:"+this.loadingGroupName);CommonUtil.log("ModuleLoading complete!        Complete GroupName is:"+e.groupName);var t=(new Date).getTime()-this.loadingStartTime,i=1e3-t;egret.setTimeout(function(){this.loadingGroupCallback.apply(this.callbackThisObj,this.callbackParameters[0]),this.reset(),this.cacheLoadRequest.shift(),this.cacheLoadRequest.length>0&&this.startLoadGroupRes.apply(this,this.cacheLoadRequest[0])},this,i>0?i:0)},t.prototype.onResourceProgress=function(e){this.progressText.text=Math.ceil(e.itemsLoaded/e.itemsTotal*100)+"%"},t.prototype.onItemLoadError=function(e){console.log("加载单个资源出错, Url:"+e.resItem.url)},t.prototype.onResourceLoadError=function(e){console.log("加载组资源出错  Group:"+e.groupName),this.reset();var t=this.cacheLoadRequest.shift(),i=[];i.push(Game.getLanguage("httpRequestError_resend")),i.push(ViewManager.instance.loadModuleGroupRes),i.push(ViewManager.instance),i.push(!1),i.push(!1),i.push(10);for(var n in t)i.push(t[n]);ViewManager.instance.alert.apply(ViewManager.instance,i)},t.prototype.reset=function(){this.callbackThisObj=null,this.callbackParameters=null,this.loadingGroupName=null,this.loadingGroupCallback=null,egret.Tween.removeTweens(this.loadingIcon),this.visible=!1,RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this)},t}(eui.Component);__reflect(ModuleLoadingUI.prototype,"ModuleLoadingUI");var ViewManager=function(){function e(){this.timeoutKeyMapOnMediator={},this.intervalKeyMapOnMediator={},this.armatureDisplayMapOnMediator={},this.dynamicArmatureDisplay={},this.isWinActivate=!0,this._window=[],this.sceneLayer=new egret.DisplayObjectContainer,this.uiLayer=new eui.UILayer,this.guideLayer=new egret.DisplayObjectContainer,this.noticeLayer=new egret.DisplayObjectContainer,this.loadingLayer=new LoadingUI,this.moduleLoadingLayer=new ModuleLoadingUI,this.flowHints=[],this.gameAlert=null,this.topMessageUI=new TopMessageUI}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(e){e.stage.setContentSize(CommonConst.STAGE_WIDTH,CommonConst.STAGE_HEIGHT),this.sceneLayer.width=CommonConst.STAGE_WIDTH,this.sceneLayer.height=CommonConst.STAGE_HEIGHT,e.parent.addChildAt(this.sceneLayer,0),this.sceneLayer.name="sceneLayer",e.parent.addChildAt(this.uiLayer,1),this.uiLayer.name="uiLayer",this.otherLayerContainer=e,this.otherLayerContainer.name="otherLayer",this.otherLayerContainer.addChild(this.guideLayer),this.guideLayer.name="guideLayer",this.otherLayerContainer.addChild(this.noticeLayer),this.noticeLayer.name="noticeLayer",this.otherLayerContainer.addChild(this.moduleLoadingLayer),this.moduleLoadingLayer.name="moduleLoadingLayer",this.moduleLoadingLayer.visible=!1,this.otherLayerContainer.addChild(this.loadingLayer),this.loadingLayer.name="loadingLayer",this.onWindowResize(),egret.MainContext.instance.stage.addEventListener(egret.StageOrientationEvent.ORIENTATION_CHANGE,this.onWindowResize,this),egret.MainContext.instance.stage.addEventListener(egret.Event.RESIZE,this.onWindowResize,this),egret.MainContext.instance.stage.addEventListener(egret.Event.ACTIVATE,this.onActivate,this),egret.MainContext.instance.stage.addEventListener(egret.Event.DEACTIVATE,this.onDeactivate,this)},e.prototype.onWindowResize=function(){egret.MainContext.instance.stage.stageWidth==CommonConst.STAGE_WIDTH&&egret.MainContext.instance.stage.stageHeight<CommonConst.STAGE_HEIGHT?egret.MainContext.instance.stage.scaleMode=egret.StageScaleMode.FIXED_HEIGHT:egret.MainContext.instance.stage.stageWidth<CommonConst.STAGE_WIDTH&&egret.MainContext.instance.stage.stageHeight==CommonConst.STAGE_HEIGHT&&(egret.MainContext.instance.stage.scaleMode=egret.StageScaleMode.FIXED_WIDTH);for(var e=0;e<this.uiLayer.numChildren;e++){var t=this.uiLayer.getChildAt(e);t.width=egret.MainContext.instance.stage.stageWidth,t.height=egret.MainContext.instance.stage.stageHeight}this.sceneLayer.width=egret.MainContext.instance.stage.stageWidth,this.sceneLayer.height=egret.MainContext.instance.stage.stageHeight,this.sceneLayer.x=0,this.sceneLayer.y=0;for(var e=0;e<this.sceneLayer.numChildren;e++){var t=this.sceneLayer.getChildAt(e);t.width=t.parent.width,t.height=t.parent.height,t.x=0,t.y=0}this.otherLayerContainer.width=egret.MainContext.instance.stage.stageWidth,this.otherLayerContainer.height=egret.MainContext.instance.stage.stageHeight,this.otherLayerContainer.x=0,this.otherLayerContainer.y=0;for(var e=0;e<this.otherLayerContainer.numChildren;e++){var i=this.otherLayerContainer.getChildAt(e);i.width=i.parent.width,i.height=i.parent.height,i.x=0,i.y=0}this.topMessageUI.onWindowResize()},e.prototype.onActivate=function(t){e.instance.isWinActivate=!0,SoundManager.instance.playMusic()},e.prototype.onDeactivate=function(t){e.instance.isWinActivate=!1,SoundManager.instance.stopMusic()},e.prototype.OPEN_WINDOW=function(t,i){void 0===i&&(i=!1);for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];e.instance.loadModuleGroupRes(CommonConst.RES_GROUP_MEDIATOR[egret.getQualifiedClassName(t)],function(){i||this.closeAllWindow();var e=ObserverManager.registerMediator(t);-1==this._window.indexOf(e)&&(this._window.push(e),e.open.apply(e,n))},this)},e.prototype.CLOSE_WINDOW=function(e){if(void 0===e&&(e=null),e){var t=ObserverManager.getMediator(e);if(!t)return void egret.error(egret.getQualifiedClassName(e)+"  has not been registered!");var i=this._window.indexOf(t);if(-1==i)return;this.closeMediator(this._window[i]),this._window.splice(i,1)}else this.closeAllWindow()},e.prototype.REPLACE_SCENE=function(e,t){var i=ObserverManager.getMediator(e);if(-1==this._window.indexOf(i)){var n=ObserverManager.getMediator(t),r=this._window.indexOf(n);-1!=r&&(this.closeMediator(this._window[r]),this._window.splice(r,1),this._window.push(i),i.open())}},e.prototype.closeAllWindow=function(){for(var e in this._window)this._window[e]&&this.closeMediator(this._window[e]);this._window.length=0},e.prototype.addElement=function(e,t){void 0===t&&(t=ViewDepth.UI);var i=this.getLayer(t);t==ViewDepth.UI&&(e.width=egret.MainContext.instance.stage.stageWidth,e.height=egret.MainContext.instance.stage.stageHeight),i.addChild(e)},e.prototype.removeElement=function(e,t){void 0===t&&(t=ViewDepth.UI);var i=this.getLayer(t);e&&e.parent==i?i.removeChild(e):egret.warn("viewManager removeElement is error")},e.prototype.getLayer=function(e){var t=null;switch(e){case ViewDepth.SCENE:t=this.sceneLayer;break;case ViewDepth.UI:t=this.uiLayer;break;case ViewDepth.GUIDE:t=this.guideLayer;break;case ViewDepth.ALERT:t=this.alertLayer;break;case ViewDepth.NOTICE:t=this.noticeLayer;break;case ViewDepth.LOADING:t=this.loadingLayer;break;case ViewDepth.LOADING:t=this.loadingLayer;break;case ViewDepth.MODULE_LOADING:t=this.moduleLoadingLayer}return t},e.prototype.showLoading=function(e,t){this.loadingLayer.visible=!0,this.loadingLayer.setProgress(e,t)},e.prototype.hideLoading=function(){this.loadingLayer.visible=!1},e.prototype.loadModuleGroupRes=function(e,t,i){for(var n=[],r=3;r<arguments.length;r++)n[r-3]=arguments[r];RES.isGroupLoaded(e)?t.apply(i,n):this.moduleLoadingLayer.loadModuleGroupRes(e,t,i,n)},e.prototype.showFlowHint=function(e){var t=new FlowHintUI;this.addElement(t,ViewDepth.NOTICE),t.showText(e,this.removeFlowHint,this),this.flowHints.unshift(t);var i,n=this.flowHints.length;n>5&&(i=this.flowHints[n-1],this.removeFlowHint(i),n--),i=this.flowHints[0];for(var r=i.y-i.height/2,o=1;n>o;o++)i=this.flowHints[o],r-=i.height/2,egret.Tween.get(i).to({y:r>>0},100),r-=i.height/2},e.prototype.removeFlowHint=function(e){var t=this.flowHints.indexOf(e);-1!=t&&(this.flowHints.splice(t,1),this.removeElement(e,ViewDepth.NOTICE),egret.Tween.removeTweens(e))},e.prototype.alert=function(t,i,n,r,o,a){void 0===i&&(i=null),void 0===n&&(n=null),void 0===r&&(r=!1),void 0===o&&(o=!0),void 0===a&&(a=-1);for(var s=[],l=6;l<arguments.length;l++)s[l-6]=arguments[l];this.gameAlert||(this.gameAlert=new GameAlertUI,this.otherLayerContainer.addChild(this.gameAlert),this.gameAlert.name="alertLayer",this.gameAlert.width=this.gameAlert.parent.width,this.gameAlert.height=this.gameAlert.parent.height,this.gameAlert.x=0,this.gameAlert.y=0,this.gameAlert.visible=!1),e.instance.gameAlert.alert(t,i,n,r,o,a,s)
},e.prototype.showTopMessage=function(e){!e||e.length<=0||(this.topMessageUI.pushMessage(e),this.topMessageUI.parent||(this.addElement(this.topMessageUI,ViewDepth.NOTICE),this.topMessageUI.showMessage()))},e.prototype.removeTopMessage=function(){this.topMessageUI.removeMessage()},e.prototype.isMediatorExist=function(e){var t=ObserverManager.getMediator(e);return t&&-1!=this._window.indexOf(t)?!0:!1},e.prototype.setTimeout=function(e,t,i,n){for(var r=[],o=4;o<arguments.length;o++)r[o-4]=arguments[o];var a=egret.getQualifiedClassName(e),s=egret.setTimeout.apply(egret,[t,i,n].concat(r)),l=this.timeoutKeyMapOnMediator[a];return l||(l=[],this.timeoutKeyMapOnMediator[a]=l),l.push(s),s},e.prototype.setInterval=function(e,t,i,n){for(var r=[],o=4;o<arguments.length;o++)r[o-4]=arguments[o];var a=egret.getQualifiedClassName(e),s=egret.setInterval(t,i,n,r),l=this.intervalKeyMapOnMediator[a];return l||(l=[],this.intervalKeyMapOnMediator[a]=l),l.push(s),s},e.prototype.closeMediator=function(e){e.close();var t=egret.getQualifiedClassName(e);this.clearMediator(t)},e.prototype.clearMediator=function(e){var t=this.timeoutKeyMapOnMediator[e];if(t){for(var i in t)egret.clearTimeout(t[i]);this.timeoutKeyMapOnMediator[e].length=0}var n=this.intervalKeyMapOnMediator[e];if(n){for(var i in n)egret.clearInterval(n[i]);this.intervalKeyMapOnMediator[e].length=0}var r=this.armatureDisplayMapOnMediator[e];if(r){for(var i in r)r[i].animation.stop();this.armatureDisplayMapOnMediator[e].length=0}},e}();__reflect(ViewManager.prototype,"ViewManager");var ViewDepth;!function(e){e[e.SCENE=0]="SCENE",e[e.UI=1]="UI",e[e.GUIDE=2]="GUIDE",e[e.ALERT=3]="ALERT",e[e.NOTICE=4]="NOTICE",e[e.LOADING=5]="LOADING",e[e.MODULE_LOADING=6]="MODULE_LOADING"}(ViewDepth||(ViewDepth={}));var FlowHintUI=function(e){function t(){var i=e.call(this)||this;return i.bg=new eui.Image,i.bg.source="FlowHintBG_png",i.bg.height=39,i.bg.width=360,i.addChild(i.bg),i.tf=new egret.TextField,i.tf.size=28,i.tf.fontFamily="Microsoft YaHei",i.tf.lineSpacing=8,i.tf.stroke=2,i.tf.textAlign=egret.HorizontalAlign.CENTER,i.tf.y=t.sideY,i.tf.x=t.side,i.addChild(i.tf),i.touchEnabled=i.touchChildren=!1,i}return __extends(t,e),t.prototype.showText=function(e,i,n){this.tf.textFlow=TextUtil.parse(e);var r=this.tf.width+2*t.side;r<t.minWidth&&(r=t.minWidth),this.bg.width=r,this.tf.x=(r-this.tf.width)/2>>0,this.bg.height=this.tf.height+2*t.sideY,this.anchorOffsetX=r/2,this.scaleX=this.scaleY=1.5,this.x=this.parent.width/2,this.y=this.parent.height/2-200,egret.Tween.get(this,null,null,!0).to({scaleX:1,scaleY:1},300).wait(2e3).to({alpha:0},300);var o=egret.setTimeout(function(){i.call(n,this),egret.clearTimeout(o)},this,2600)},t.side=50,t.sideY=10,t.minWidth=360,t}(eui.Component);__reflect(FlowHintUI.prototype,"FlowHintUI");var GameAlertUI=function(e){function t(){var t=e.call(this)||this;return t.affirmHandler=null,t.messages=[],t.skinName=CommonAlertSkin,t.btn_affirm.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onAffirm,t),t.btn_affirmCountDown.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onAffirm,t),t.btn_cancel.addEventListener(egret.TouchEvent.TOUCH_TAP,t.close,t),t}return __extends(t,e),t.prototype.alert=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.messages.push(arguments),this.visible||this.alertMessage.apply(this,this.messages.shift())},t.prototype.alertMessage=function(e,t,i,n,r,o){void 0===t&&(t=null),void 0===i&&(i=null),void 0===n&&(n=!1),void 0===r&&(r=!0),void 0===o&&(o=-1);for(var a=[],s=6;s<arguments.length;s++)a[s-6]=arguments[s];this.visible=!0,this.ui_text.textFlow=TextUtil.parse(e),this.affirmHandler=t,this.thisObject=i,this.parameters=a,n?(this.btn_cancel.visible=!0,this.btn_affirm.x=this.btn_affirm.parent.width/2-30-this.btn_affirm.width,this.btn_cancel.x=this.btn_cancel.parent.width/2+30):(this.btn_cancel.visible=!1,this.btn_affirm.x=this.btn_affirm.parent.width/2-this.btn_affirm.width/2),this.btn_affirm.visible=r,this.ui_text.width=414,this.ui_text.y=61,-1!=o?(this.countDownLab.visible=!0,this.countDownIcon.visible=!0,this.btn_affirmCountDown.visible=!0,this.countDownSecond=o,this.countDown(),this.interKey=egret.setInterval(this.countDown,this,1e3),this.btn_affirm.visible=!1):(this.countDownLab.visible=!1,this.countDownIcon.visible=!1,this.btn_affirmCountDown.visible=!1);var l=this.btn_affirm.visible?this.btn_affirm:this.btn_affirmCountDown;l.visible?this.ui_text.y+this.ui_text.height>=l.y&&(this.ui_text.y=l.y-this.ui_text.height-10,this.ui_text.y<=0&&(this.ui_text.width=this.ui_text.parent.width,this.ui_text.y=l.y-this.ui_text.height-10)):this.ui_text.y=this.ui_text.parent.height/2-this.ui_text.height/2},t.prototype.close=function(){this.visible=!1,this.messages.length>0&&this.alertMessage.apply(this,this.messages.shift())},t.prototype.onAffirm=function(){if(egret.clearInterval(this.interKey),null!=this.affirmHandler){var e=this.thisObject||this;this.affirmHandler.apply(e,this.parameters[0])}this.close()},t.prototype.countDown=function(){return this.countDownSecond--,this.countDownSecond<0?void this.onAffirm():void(this.countDownLab.text=this.countDownSecond+"")},t}(eui.Component);__reflect(GameAlertUI.prototype,"GameAlertUI");var TopMessageUI=function(e){function t(){var t=e.call(this)||this;return t.bg=new eui.Image("marqueeBG_png"),t.marqueeIcon=new eui.Image("marqueeIcon_png"),t.messageList=[],t.addChild(t.bg),t.textLab=new egret.TextField,t.textLab.size=26,t.textLab.fontFamily="Microsoft YaHei",t.addChild(t.textLab),t.addChild(t.marqueeIcon),t.touchEnabled=t.touchChildren=!1,t.addEventListener(egret.StageOrientationEvent.ORIENTATION_CHANGE,t.onWindowResize,t),t.addEventListener(egret.Event.RESIZE,t.onWindowResize,t),t}return __extends(t,e),t.prototype.pushMessage=function(e){!e||e.length<=0||this.messageList.push(e)},t.prototype.removeMessage=function(){this.messageList.length=0,this.hasEventListener(egret.Event.ENTER_FRAME)&&this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this),this.parent&&this.parent.removeChild(this)},t.prototype.showMessage=function(){return 0==this.messageList.length?(this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this),void this.parent.removeChild(this)):(this.hasEventListener(egret.Event.ENTER_FRAME)||this.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this),this.width=t.WIDTH,this.height=this.bg.texture.textureHeight,this.x=egret.MainContext.instance.stage.stageWidth/2-CommonConst.STAGE_WIDTH/2+255,this.y=egret.MainContext.instance.stage.stageHeight/2-CommonConst.STAGE_HEIGHT/2+105,this.originalHeight=this.y,this.mask=new egret.Rectangle(0,0,this.width,this.height),this.bg.width=this.width,this.marqueeIcon.x=this.width,this.marqueeIcon.y=(this.bg.height-this.marqueeIcon.height)/2,this.textLab.x=this.marqueeIcon.x+this.marqueeIcon.width+5,this.textLab.textFlow=TextUtil.parse(this.messageList.shift()),void egret.callLater(function(){this.textLab.y=(this.bg.height-this.textLab.height)/2+2},this))},t.prototype.onEnterFrame=function(){this.y=this.originalHeight+t.HEIGHT_OFFSET,this.textLab.x-=t.SPEED,this.marqueeIcon.x-=t.SPEED,this.textLab.x+this.textLab.width<0&&this.showMessage()},t.prototype.onWindowResize=function(){this.x=egret.MainContext.instance.stage.stageWidth/2-CommonConst.STAGE_WIDTH/2+255,this.y=egret.MainContext.instance.stage.stageHeight/2-CommonConst.STAGE_HEIGHT/2+105,this.originalHeight=this.y},t.WIDTH=800,t.SPEED=5,t.HEIGHT_OFFSET=0,t}(eui.Component);__reflect(TopMessageUI.prototype,"TopMessageUI");var GlobalProxy=function(){function e(){}return e}();__reflect(GlobalProxy.prototype,"GlobalProxy");var ArrayUtil=function(){function e(){}return e.getRandom=function(e,t){return e+Math.random()*(t-e)},e.shuffleArray=function(e){for(var t=0,i=e.length;i>t;t++){var n=Math.random()*t>>0;if(n!=t){var r=e[t];e[t]=e[n],e[n]=r}}},e.sortOn=function(e,t,i){void 0===i&&(i=!1),i?e.sort(function(e,i){return i[t]-e[t]}):e.sort(function(e,i){return e[t]-i[t]})},e.sortOnDescending=function(e,t){e.sort(function(e,i){return i[t]-e[t]})},e.sortOnPositive=function(e,t){e.sort(function(e,i){return+i[t]<0?-1:+e[t]<0?1:e[t]-i[t]})},e}();__reflect(ArrayUtil.prototype,"ArrayUtil");var DisplayerToCanvas=function(){function e(){}return e.add=function(e,t){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];for(var r=0,o=i;r<o.length;r++){var a=o[r];null==t?e.addChild(a):e.addChildAt(a,t)}},e}();__reflect(DisplayerToCanvas.prototype,"DisplayerToCanvas");var IFrameContainer=function(e){function t(i){var n=e.call(this)||this;n._x=0,n._y=0,n._width=0,n._height=0,n._src="",n._scaleMode=egret.MainContext.instance.stage.scaleMode,n._iframeWrapper=null,n._iframe=null,n.iFrameName=i;var r=document.getElementById("StageDelegateDiv");n._iframeWrapper=document.getElementById("iframe-wrapper"+n.iFrameName),n._iframeWrapper||(n._iframeWrapper=document.createElement("div"),n._iframeWrapper.style.display="none",n._iframeWrapper.attributes.style.value+="position:absolute;-webkit-overflow-scrolling: touch;overflow-y: scroll;",n._iframeWrapper.id="iframe-wrapper"+n.iFrameName,r.appendChild(n._iframeWrapper)),n._iframeWrapper.style.opacity="0";var o=document.createElement("iframe");o.id="webview-iframe-"+n.iFrameName,o.name="webview-iframe-"+n.iFrameName,o.style.position="absolute",o.style.top="0",o.style.left="0",o.style.opacity="0",o.style.display="none",o.frameBorder="0",o.border="0",n._iframe=o;var a=n;n._iframe.onload=function(){a._iframeWrapper.style.opacity="1",a._iframe.style.opacity="1",ObserverManager.sendNotification(t.IFRAME_ONLOAD,a._iframe)},n._stageW=egret.MainContext.instance.stage.stageWidth,n._stageH=egret.MainContext.instance.stage.stageHeight,n._windowW=window.innerWidth,n._windowH=window.innerHeight,n._designH=parseInt(r.parentElement.attributes["data-content-height"].value),n._designW=parseInt(r.parentElement.attributes["data-content-width"].value);var s=egret.sys.screenAdapter.calculateStageSize(egret.MainContext.instance.stage.scaleMode,n._windowW,n._windowH,n._designW,n._designH);return n._displayH=s.displayHeight,n._displayW=s.displayWidth,n}return __extends(t,e),t.prototype.show=function(e){return e+=e.indexOf("?")>0?"&versionTime="+window.mainMinJSVer:"?versionTime="+window.mainMinJSVer,this._iframe.style.display="block",this._iframeWrapper.style.display="block",this._iframe.src=e,this._iframeWrapper.appendChild(this._iframe),this._iframe.contentWindow},t.prototype.destroy=function(){this._iframe&&(ObserverManager.sendNotification(t.IFRAME_DESTROY,this._iframe),this._iframeWrapper.style.display="none",this._iframeWrapper.removeChild(this._iframe))},t.prototype.getShowingIFrame=function(){return"none"==this._iframeWrapper.style.display?null:this._iframe},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e,(this._scaleMode==egret.StageScaleMode.FIXED_WIDTH||this._scaleMode==egret.StageScaleMode.FIXED_HEIGHT)&&(this._iframe.width=this._width/this._stageW*this._windowW+"px",this._iframeWrapper.style.width=this._width/this._stageW*this._windowW+"px"),(this._scaleMode==egret.StageScaleMode.SHOW_ALL||this._scaleMode==egret.StageScaleMode.NO_BORDER)&&(this._windowW==this._displayW?(this._iframe.style.width=this._width/this._stageW*this._windowW+"px",this._iframeWrapper.style.width=this._width/this._stageW*this._windowW+"px"):(this._iframe.style.width=this._width/this._stageW*this._displayW+"px",this._iframeWrapper.style.width=this._width/this._stageW*this._displayW+"px"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e,(this._scaleMode==egret.StageScaleMode.FIXED_WIDTH||this._scaleMode==egret.StageScaleMode.FIXED_HEIGHT)&&(this._iframe.height=this._height/this._stageH*this._windowH+"px",this._iframeWrapper.style.height=this._height/this._stageH*this._windowH+"px"),(this._scaleMode==egret.StageScaleMode.SHOW_ALL||this._scaleMode==egret.StageScaleMode.NO_BORDER)&&(this._windowH==this._displayH?(this._iframe.style.height=this._height/this._stageH*this._windowH+"px",this._iframeWrapper.style.height=this._height/this._stageH*this._windowH+"px"):(this._iframe.style.height=this._height/this._stageH*this._displayH+"px",this._iframeWrapper.style.height=this._height/this._stageH*this._displayH+"px"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e,(this._scaleMode==egret.StageScaleMode.FIXED_WIDTH||this._scaleMode==egret.StageScaleMode.FIXED_HEIGHT)&&(this._iframeWrapper.style.left=this._x/this._stageW*this._windowW+"px"),(this._scaleMode==egret.StageScaleMode.SHOW_ALL||this._scaleMode==egret.StageScaleMode.NO_BORDER)&&(this._windowW==this._displayW?this._iframeWrapper.style.left=this._x/this._stageW*this._windowW+"px":this._iframeWrapper.style.left=this._x/this._stageW*this._displayW+"px")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e,(this._scaleMode==egret.StageScaleMode.FIXED_WIDTH||this._scaleMode==egret.StageScaleMode.FIXED_HEIGHT)&&(this._iframeWrapper.style.top=this._y/this._stageH*this._windowH+"px"),(this._scaleMode==egret.StageScaleMode.SHOW_ALL||this._scaleMode==egret.StageScaleMode.NO_BORDER)&&(this._windowH==this._displayH?this._iframeWrapper.style.top=this._y/this._stageH*this._windowH+"px":this._iframeWrapper.style.top=this._y/this._stageH*this._displayH+"px")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"src",{get:function(){return this._src},set:function(e){this._src=e},enumerable:!0,configurable:!0}),t.IFRAME_ONLOAD="onIFrameOnload",t.IFRAME_DESTROY="onIFrameDestroy",t}(egret.DisplayObjectContainer);__reflect(IFrameContainer.prototype,"IFrameContainer");var MD5=function(){function e(){}return e.encrypt=function(t){return e.hex_md5(t)},e.hex_md5=function(t){return e.rstr2hex(e.rstr_md5(e.str2rstr_utf8(t)))},e.b64_md5=function(t){return e.rstr2b64(e.rstr_md5(e.str2rstr_utf8(t)))},e.any_md5=function(t,i){return e.rstr2any(e.rstr_md5(e.str2rstr_utf8(t)),i)},e.hex_hmac_md5=function(t,i){return e.rstr2hex(e.rstr_hmac_md5(e.str2rstr_utf8(t),e.str2rstr_utf8(i)))},e.b64_hmac_md5=function(t,i){return e.rstr2b64(e.rstr_hmac_md5(e.str2rstr_utf8(t),e.str2rstr_utf8(i)))},e.any_hmac_md5=function(t,i,n){return e.rstr2any(e.rstr_hmac_md5(e.str2rstr_utf8(t),e.str2rstr_utf8(i)),n)},e.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==e.hex_md5("abc")},e.rstr_md5=function(t){return e.binl2rstr(e.binl_md5(e.rstr2binl(t),8*t.length))},e.rstr_hmac_md5=function(t,i){var n=e.rstr2binl(t);n.length>16&&(n=e.binl_md5(n,8*t.length));for(var r=new Array(16),o=new Array(16),a=0;16>a;a++)r[a]=909522486^n[a],o[a]=1549556828^n[a];var s=e.binl_md5(r.concat(e.rstr2binl(i)),512+8*i.length);return e.binl2rstr(e.binl_md5(o.concat(s),640))},e.rstr2hex=function(t){for(var i,n=e.hexcase?"0123456789ABCDEF":"0123456789abcdef",r="",o=0;o<t.length;o++)i=t.charCodeAt(o),r+=n.charAt(i>>>4&15)+n.charAt(15&i);return r},e.rstr2b64=function(t){for(var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",r=t.length,o=0;r>o;o+=3)for(var a=t.charCodeAt(o)<<16|(r>o+1?t.charCodeAt(o+1)<<8:0)|(r>o+2?t.charCodeAt(o+2):0),s=0;4>s;s++)n+=8*o+6*s>8*t.length?e.b64pad:i.charAt(a>>>6*(3-s)&63);return n},e.rstr2any=function(e,t){var i,n,r,o,a=t.length,s=[],l=new Array(e.length/2);for(i=0;i<l.length;i++)l[i]=e.charCodeAt(2*i)<<8|e.charCodeAt(2*i+1);for(;l.length>0;){for(o=[],r=0,i=0;i<l.length;i++)r=(r<<16)+l[i],n=Math.floor(r/a),r-=n*a,(o.length>0||n>0)&&(o[o.length]=n);s[s.length]=r,l=o}var c="";for(i=s.length-1;i>=0;i--)c+=t.charAt(s[i]);return c},e.str2rstr_utf8=function(e){for(var t,i,n="",r=-1;++r<e.length;)t=e.charCodeAt(r),i=r+1<e.length?e.charCodeAt(r+1):0,t>=55296&&56319>=t&&i>=56320&&57343>=i&&(t=65536+((1023&t)<<10)+(1023&i),r++),127>=t?n+=String.fromCharCode(t):2047>=t?n+=String.fromCharCode(192|t>>>6&31,128|63&t):65535>=t?n+=String.fromCharCode(224|t>>>12&15,128|t>>>6&63,128|63&t):2097151>=t&&(n+=String.fromCharCode(240|t>>>18&7,128|t>>>12&63,128|t>>>6&63,128|63&t));return n},e.str2rstr_utf16le=function(e){for(var t="",i=0;i<e.length;i++)t+=String.fromCharCode(255&e.charCodeAt(i),e.charCodeAt(i)>>>8&255);return t},e.str2rstr_utf16be=function(e){for(var t="",i=0;i<e.length;i++)t+=String.fromCharCode(e.charCodeAt(i)>>>8&255,255&e.charCodeAt(i));return t},e.rstr2binl=function(e){for(var t=new Array(e.length>>2),i=0;i<t.length;i++)t[i]=0;for(i=0;i<8*e.length;i+=8)t[i>>5]|=(255&e.charCodeAt(i/8))<<i%32;return t},e.binl2rstr=function(e){for(var t="",i=0;i<32*e.length;i+=8)t+=String.fromCharCode(e[i>>5]>>>i%32&255);return t},e.binl_md5=function(t,i){t[i>>5]|=128<<i%32,t[(i+64>>>9<<4)+14]=i;for(var n=1732584193,r=-271733879,o=-1732584194,a=271733878,s=0;s<t.length;s+=16){var l=n,c=r,h=o,p=a;n=e.md5_ff(n,r,o,a,t[s+0],7,-680876936),a=e.md5_ff(a,n,r,o,t[s+1],12,-389564586),o=e.md5_ff(o,a,n,r,t[s+2],17,606105819),r=e.md5_ff(r,o,a,n,t[s+3],22,-1044525330),n=e.md5_ff(n,r,o,a,t[s+4],7,-176418897),a=e.md5_ff(a,n,r,o,t[s+5],12,1200080426),o=e.md5_ff(o,a,n,r,t[s+6],17,-1473231341),r=e.md5_ff(r,o,a,n,t[s+7],22,-45705983),n=e.md5_ff(n,r,o,a,t[s+8],7,1770035416),a=e.md5_ff(a,n,r,o,t[s+9],12,-1958414417),o=e.md5_ff(o,a,n,r,t[s+10],17,-42063),r=e.md5_ff(r,o,a,n,t[s+11],22,-1990404162),n=e.md5_ff(n,r,o,a,t[s+12],7,1804603682),a=e.md5_ff(a,n,r,o,t[s+13],12,-40341101),o=e.md5_ff(o,a,n,r,t[s+14],17,-1502002290),r=e.md5_ff(r,o,a,n,t[s+15],22,1236535329),n=e.md5_gg(n,r,o,a,t[s+1],5,-165796510),a=e.md5_gg(a,n,r,o,t[s+6],9,-1069501632),o=e.md5_gg(o,a,n,r,t[s+11],14,643717713),r=e.md5_gg(r,o,a,n,t[s+0],20,-373897302),n=e.md5_gg(n,r,o,a,t[s+5],5,-701558691),a=e.md5_gg(a,n,r,o,t[s+10],9,38016083),o=e.md5_gg(o,a,n,r,t[s+15],14,-660478335),r=e.md5_gg(r,o,a,n,t[s+4],20,-405537848),n=e.md5_gg(n,r,o,a,t[s+9],5,568446438),a=e.md5_gg(a,n,r,o,t[s+14],9,-1019803690),o=e.md5_gg(o,a,n,r,t[s+3],14,-187363961),r=e.md5_gg(r,o,a,n,t[s+8],20,1163531501),n=e.md5_gg(n,r,o,a,t[s+13],5,-1444681467),a=e.md5_gg(a,n,r,o,t[s+2],9,-51403784),o=e.md5_gg(o,a,n,r,t[s+7],14,1735328473),r=e.md5_gg(r,o,a,n,t[s+12],20,-1926607734),n=e.md5_hh(n,r,o,a,t[s+5],4,-378558),a=e.md5_hh(a,n,r,o,t[s+8],11,-2022574463),o=e.md5_hh(o,a,n,r,t[s+11],16,1839030562),r=e.md5_hh(r,o,a,n,t[s+14],23,-35309556),n=e.md5_hh(n,r,o,a,t[s+1],4,-1530992060),a=e.md5_hh(a,n,r,o,t[s+4],11,1272893353),o=e.md5_hh(o,a,n,r,t[s+7],16,-155497632),r=e.md5_hh(r,o,a,n,t[s+10],23,-1094730640),n=e.md5_hh(n,r,o,a,t[s+13],4,681279174),a=e.md5_hh(a,n,r,o,t[s+0],11,-358537222),o=e.md5_hh(o,a,n,r,t[s+3],16,-722521979),r=e.md5_hh(r,o,a,n,t[s+6],23,76029189),n=e.md5_hh(n,r,o,a,t[s+9],4,-640364487),a=e.md5_hh(a,n,r,o,t[s+12],11,-421815835),o=e.md5_hh(o,a,n,r,t[s+15],16,530742520),r=e.md5_hh(r,o,a,n,t[s+2],23,-995338651),n=e.md5_ii(n,r,o,a,t[s+0],6,-198630844),a=e.md5_ii(a,n,r,o,t[s+7],10,1126891415),o=e.md5_ii(o,a,n,r,t[s+14],15,-1416354905),r=e.md5_ii(r,o,a,n,t[s+5],21,-57434055),n=e.md5_ii(n,r,o,a,t[s+12],6,1700485571),a=e.md5_ii(a,n,r,o,t[s+3],10,-1894986606),o=e.md5_ii(o,a,n,r,t[s+10],15,-1051523),r=e.md5_ii(r,o,a,n,t[s+1],21,-2054922799),n=e.md5_ii(n,r,o,a,t[s+8],6,1873313359),a=e.md5_ii(a,n,r,o,t[s+15],10,-30611744),o=e.md5_ii(o,a,n,r,t[s+6],15,-1560198380),r=e.md5_ii(r,o,a,n,t[s+13],21,1309151649),n=e.md5_ii(n,r,o,a,t[s+4],6,-145523070),a=e.md5_ii(a,n,r,o,t[s+11],10,-1120210379),o=e.md5_ii(o,a,n,r,t[s+2],15,718787259),r=e.md5_ii(r,o,a,n,t[s+9],21,-343485551),n=e.safe_add(n,l),r=e.safe_add(r,c),o=e.safe_add(o,h),a=e.safe_add(a,p)}return[n,r,o,a]},e.md5_cmn=function(t,i,n,r,o,a){return e.safe_add(e.bit_rol(e.safe_add(e.safe_add(i,t),e.safe_add(r,a)),o),n)},e.md5_ff=function(t,i,n,r,o,a,s){return e.md5_cmn(i&n|~i&r,t,i,o,a,s)},e.md5_gg=function(t,i,n,r,o,a,s){return e.md5_cmn(i&r|n&~r,t,i,o,a,s)},e.md5_hh=function(t,i,n,r,o,a,s){return e.md5_cmn(i^n^r,t,i,o,a,s)},e.md5_ii=function(t,i,n,r,o,a,s){return e.md5_cmn(n^(i|~r),t,i,o,a,s)},e.safe_add=function(e,t){var i=(65535&e)+(65535&t),n=(e>>16)+(t>>16)+(i>>16);return n<<16|65535&i},e.bit_rol=function(e,t){return e<<t|e>>>32-t},e.HEX_FORMAT_LOWERCASE=0,e.HEX_FORMAT_UPPERCASE=1,e.BASE64_PAD_CHARACTER_DEFAULT_COMPLIANCE="",e.BASE64_PAD_CHARACTER_RFC_COMPLIANCE="=",e.hexcase=0,e.b64pad="",e}();__reflect(MD5.prototype,"MD5");var ObjectUtil=function(){function e(){}return e.getLength=function(e){if(null==e)return 0;var t=0;for(var i in e)t++;return t},e.shallowCopy=function(e,t,i,n){void 0===i&&(i=null),void 0===n&&(n=null);var r;if(i)for(r in e)-1==i.indexOf(r)&&"hashCode"!=r&&"$hashCode"!=r&&(t[r]=e[r]);else if(n)for(var o in n)"hashCode"!=o&&"$hashCode"!=o&&(r=n[o],t[r]=e[r]);else for(r in e)"hashCode"!=r&&"$hashCode"!=r&&(t[r]=e[r]);return t},e.deepCopy=function(e,t){for(var i in e)if(null!=e[i]&&"object"==typeof e[i]&&null!=t[i])arguments.callee(e[i],t[i]);else{if("hashCode"==i||"$hashCode"==i)continue;t[i]=e[i]}return t},e}();__reflect(ObjectUtil.prototype,"ObjectUtil");var sdk={RewardVideoAd:"RewardVideoAd",SplashAd:"SplashAd",FullScreenVideoAd:"FullScreenVideoAd",BannerExpressAd:"BannerExpressAd",InteractionAd:"InteractionAd"},openadsdk=function(){function e(){}return e.RewardVideoAd=function(t,i,n){e.addCallBack(sdk.RewardVideoAd,t,i,n)},e.SplashAd=function(t,i,n){e.addCallBack(sdk.SplashAd,t,i,n)},e.FullScreenVideoAd=function(t,i,n){e.addCallBack(sdk.FullScreenVideoAd,t,i,n)},e.BannerExpressAd=function(t,i,n){e.addCallBack(sdk.BannerExpressAd,t,i,n)},e.InteractionAd=function(t,i,n){e.addCallBack(sdk.InteractionAd,t,i,n)},e.addCallBack=function(e,t,i,n){egret.ExternalInterface.addCallback("TT"+e+"-js",function(e){t&&i&&t.apply(i,[e])}),egret.ExternalInterface.call("TT"+e,n)},e}();__reflect(openadsdk.prototype,"openadsdk");var ResUtil=function(){function e(){}return e.rewriteGetResByUrl=function(){e.egretGetResByUrlFn=RES.getResByUrl,RES.getResByUrl=e.newGetResByUrl},e.newGetResByUrl=function(t,i,n,r){return void 0===r&&(r=""),egret.Capabilities.runtimeType==egret.RuntimeType.WEB&&-1==t.indexOf("?")?void console.error("RES.getResByUrl param is invalid, url ="+t):void e.egretGetResByUrlFn(t,i,n,r)},e.getImageURL=function(t,i){t&&0!=t.length||(t="");var n=i+t,r=e.URL_ROOT_FOLDER.length,o=i.indexOf(e.URL_ROOT_FOLDER_END,r),a=i.substring(r,o),s="";return egret.Capabilities.runtimeType==egret.RuntimeType.WEB?(s=i==e.LOADINGSHEET?window.loading_json:i==e.DEFAULT_RES?window.default_res:i==e.ICON?window.item:window[a])?(-1==n.indexOf("?")&&(n+="?v="+s),n):(console.error("get Res by url fail, version is invalid:"+i),null):n},e.filterLoadedGroup=function(t){var i=null,n=e.loadedGroupNames;if("string"==typeof t)n.indexOf(t)<0&&(i=t);else if(t.length>0){i=[];for(var r in t)n.indexOf(t[r])<0&&i.push(t[r]);0==i.length&&(i=null)}return i},e.destroyRes=function(t){var i,n=e.loadedGroupNames;if("string"==typeof t)i=n.indexOf(t),i>-1&&n.splice(i,1);else if(t.length>0)for(var r=t.length-1;r>=0;r--)i=n.indexOf(t[r]),i>-1&&n.splice(i,1)},e.analyzeEXML=function(e){var t,i,n,r,o=[];if("string"==typeof e)for(t=RES.getGroupByName(e),i=t.length,n=0;i>n;n++)r=t[n].name,r.indexOf("_exml")>-1&&o.push(r);else if(e.length>0)for(var a,s=e.length,l=0;s>l;l++)if(a=e[l],a.indexOf("_exml")>-1)o.push(a);else for(t=RES.getGroupByName(a),i=t.length,n=0;i>n;n++)r=t[n].name,r.indexOf("_exml")>-1&&o.push(r);i=o.length;var c;for(n=0;i>n;n++)c=RES.getRes(o[n]),c&&EXML.parse(c),RES.destroyRes(o[n])},e.addLoadedGroupName=function(t){var i=e.loadedGroupNames;if("string"==typeof t)i.indexOf(t)<0&&i.push(t);else if(t.length>0)for(var n in t)i.indexOf(t[n])<0&&i.push(t[n])},e.URL_ROOT_FOLDER="resource/assets/icon/",e.URL_ROOT_FOLDER_END="/",e.LOADINGSHEET=e.URL_ROOT_FOLDER+"loading.json",e.DEFAULT_RES="resource/",e.ICON=e.URL_ROOT_FOLDER,e.LOGINUI=e.URL_ROOT_FOLDER+"login"+e.URL_ROOT_FOLDER_END,e.egretGetResByUrlFn=null,e.loadedGroupNames=[],e}();__reflect(ResUtil.prototype,"ResUtil");var StringFilter=function(){function e(){}return e.filterAndReplace=function(t,i){void 0===i&&(i="*"),null==e.dirtyStrings&&e.initFiltersLib();for(var n=e.dirtyStrings.length,r=0;n>r;){var o=new RegExp(e.dirtyStrings[r],"gi");t=t.replace(o,i),r++}return t},e.initFiltersLib=function(){if(null==e.dirtyStrings){var t=RES.getRes("filterConfig_json"),i=t.filter_name;if(!i||i&&""==i)return void(e.dirtyStrings=[]);var n=/\n/g;i=i.replace(n,""),n=/\r/g,i=i.replace(n,""),n=/\t/g,i=i.replace(n,""),e.dirtyStrings=i.split(",");for(var r=e.dirtyStrings.length,o=0;r>o;)e.dirtyStrings[o]=e.dirtyStrings[o].toString().toLowerCase(),o++;e.dirtyStrings.length>0&&""==e.dirtyStrings[e.dirtyStrings.length-1]&&e.dirtyStrings.pop()}},e.hasFilter=function(t){null==e.dirtyStrings&&e.initFiltersLib();for(var i=e.dirtyStrings.length,n=0;i>n;){var r=t.toLowerCase().indexOf(e.dirtyStrings[n]);if(r>-1)return!0;n++}return!1},e}();__reflect(StringFilter.prototype,"StringFilter");var StringHelper=function(){function e(){}return e.substitute=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(null==e)return"";var n,r=t.length;1==r&&t[0]instanceof Array?(n=t[0],r=n.length):n=t;var o={},a=0;for(a=0;r>a;a++)o["$"+(a+1)]=n[a];for(var s,l=/\$[0-9]+/;s=l.exec(e);)(null==o[s[0]]||void 0==o[s[0]])&&(o[s[0]]=""),e=e.replace(s[0],o[s[0]]);return e},e.checkCharUnicode=function(e,t){var i=t[0],n=t[1];return e>=i&&n>=e?!0:!1},e.CHINESE_UNICODE=[19968,40869],e.ENGLISH_UNICODE=[33,126],e.THAILAND_UNICODE=[3584,3711],e.VIETNAM_UNICODE=[43776,43871],e}();__reflect(StringHelper.prototype,"StringHelper");var TextUtil=function(){function e(){}return e.parse=function(e){return typeof e+""!="string"&&(e+=""),(!e||e.length<=0)&&(e+=""),this.parser||(this.parser=new egret.HtmlTextParser),this.parser.parser(e)},e.font=function(e,t){return"<font color="+t+">"+e+"</font>"},e.underline=function(e){return"<u>"+e+"</u>"},e.fontWithoutSizeForChat=function(e,t){var i=t+e+"#END";return i},e.fontWithoutSize=function(e,t,i){void 0===i&&(i=!1);var n="<font color='"+t+"'>"+e+"</font>";return n},e.buildHtmlText=function(e,t,i,n,r,o){if(void 0===t&&(t=!1),void 0===i&&(i=""),void 0===n&&(n=!1),void 0===r&&(r=""),void 0===o&&(o=-1),o>0){var a="<font size='"+o+"'>";""!=r&&(a="<font color='"+r+"' size='"+o+"'>")}else a=""!=r?"<font color='"+r+"' size='12'>":"<font>";return t&&(e="<a href='event:"+i+"'>"+e+"</a>"),n&&(e="<u>"+e+"</u>"),a+e+"</font>"},e}();__reflect(TextUtil.prototype,"TextUtil");var WebUtil=function(e){function t(){var t=e.call(this)||this;return t.isRunning=!1,t.isDisposed=!1,t.addEventListener(egret.Event.COMPLETE,t.onClomplet,t),t.addEventListener(egret.IOErrorEvent.IO_ERROR,t.onIoErr,t),t}return __extends(t,e),t.prototype.call=function(e,t,i,n,r){void 0===n&&(n=null),void 0===r&&(r=egret.HttpMethod.POST),this.isRunning=!0,this._callBack=i,this._thisObj=n,this.open(e,r),this.send(t)},t.prototype.dispose=function(){this.isRunning=!1,this.abort(),this.isDisposed=!0,this._callBack=null,this.addEventListener(egret.Event.COMPLETE,this.onClomplet,this),this.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onIoErr,this)},t.prototype.onIoErr=function(e){this.isRunning=!1,null!=this._callBack&&this._callBack.apply(this._thisObj,[null]),this.response=null,this._callBack=null,this._thisObj=null,console.log(e.toString())},t.prototype.onClomplet=function(e){this.isRunning=!1,null!=this._callBack&&this._callBack.apply(this._thisObj,[this.response]),this._callBack=null,this._thisObj=null},t.load=function(e,i,n,r,o,a){void 0===i&&(i=""),void 0===n&&(n=null),void 0===r&&(r=null),void 0===o&&(o=egret.HttpMethod.POST),void 0===a&&(a=egret.HttpResponseType.TEXT);for(var s,l,c=t._netWorkers.length-1;c>=0;c--)if(s=t._netWorkers[c],0==s.isRunning){l=s;break}null==l&&(l=new t,t._netWorkers.push(l)),l.responseType=a,l.call(e,i,n,r,o)},t.httpRequest=function(e,i,n,r,o,a){void 0===n&&(n=null),void 0===r&&(r=null),void 0===o&&(o=egret.HttpMethod.POST),void 0===a&&(a=null);var s=new egret.HttpRequest;if(s.addEventListener(egret.Event.COMPLETE,n,r),!a){var l=10;a=function(){ViewManager.instance.showFlowHint(Game.getLanguage("httpRequestError")),egret.setTimeout(function(){ViewManager.instance.alert(Game.getLanguage("httpRequestError_resend"),t.httpRequest,r,!1,!1,l,e,i,n,r,o,a)},null,3e3)}}s.addEventListener(egret.IOErrorEvent.IO_ERROR,a,r),s.responseType=egret.HttpResponseType.TEXT,s.open(e,o),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send(i)},t._netWorkers=[],t}(egret.HttpRequest);__reflect(WebUtil.prototype,"WebUtil");